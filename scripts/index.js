(()=>{var Me=Object.defineProperty;var jo=Object.getOwnPropertyDescriptor;var Yo=Object.getOwnPropertyNames;var Xo=Object.prototype.hasOwnProperty;var mn=(ot,K)=>()=>(ot&&(K=ot(ot=0)),K);var hr=(ot,K)=>()=>(K||ot((K={exports:{}}).exports,K),K.exports),bn=(ot,K)=>{for(var ut in K)Me(ot,ut,{get:K[ut],enumerable:!0})},zo=(ot,K,ut,dt)=>{if(K&&typeof K=="object"||typeof K=="function")for(let mt of Yo(K))!Xo.call(ot,mt)&&mt!==ut&&Me(ot,mt,{get:()=>K[mt],enumerable:!(dt=jo(K,mt))||dt.enumerable});return ot};var gr=ot=>zo(Me({},"__esModule",{value:!0}),ot);var Ar={};bn(Ar,{APITransport:()=>yn,ConsoleTransport:()=>Te,FileTransport:()=>gn,default:()=>xr,interpolate:()=>vn});function xr(ot){if(ot===void 0)throw new Error("Logger requires the file name of where it's being used.");if(!new.target)return new xr(...arguments);Object.defineProperties(this,{log:{value:function(K,ut,dt){te.indexOf(K)<=te.indexOf(xr.state.currentLevel)&&Object.values(xr.state.transports).forEach(mt=>{queueMicrotask(()=>mt.log({level:K,msg:ut,category:ot,...dt}))})}}}),te.forEach(K=>{let ut;K==="noop"?ut=()=>{}:ut=this.log.bind(this,K),Object.defineProperty(this,K,{value:ut})})}function Te(ot){if(!new.target)return new Te(...arguments);Object.defineProperty(this,"log",{value:function(K){let ut=Object.assign({},ot,K);if(ut.isTable)console.table(ut.msg,ut.args);else if(ut.group)console[ut.group](ut.msg);else{let[dt,mt]=ut.style?.length===2?ut.style:["font-weight: bold; color: green;","font-style: italic;"];console[ut.level](`%c${ut.timestamp||new Date().toLocaleTimeString("en-US",ut.dateFmt)}%c %c[${ut.category}]%c ${ut.msg}`,dt,"",mt,"",...ut.args||[])}}})}function gn(ot){if(window.showSaveFilePicker===void 0){let K="FileTransport requires the File System Access API";throw console.warn(K),new Error(K)}if(!new.target)return new gn(...arguments);Object.defineProperty(this,"initialize",{value:async function(){try{let K=await window.showSaveFilePicker({types:[{description:"Log Files",accept:{"text/plain":[".log"]}}]});Object.defineProperty(this,"log",{value:async function(ut){let dt=Object.assign({},ot,ut),mt;try{mt=await K.createWritable({keepExistingData:!0}),await mt.write(`${dt.timestamp||new Date().toLocaleTimeString("en-US",dt.dateFmt)} [${dt.category}] ${dt.level}: ${dt.msg}
`)}catch(Et){console.error(Et)}finally{await mt.close()}}})}catch(K){console.error(K)}}})}function yn(ot){if(!new.target)return new yn(...arguments);Object.defineProperty(this,"log",{value:async function(K){let ut=vn(ot,K);try{let dt=await fetch(ut.url,{method:ut.method,headers:Object.entries(ut.headers||{}).reduce((mt,[Et,Rt])=>(mt[Et]=Rt,mt),{}),body:ut.body});console.debug(dt)}catch(dt){console.error(dt)}}})}var te,vn,Or=mn(()=>{te=["noop","error","warn","info","debug","trace"];Object.defineProperties(xr,{addTransport:{value:(ot,K)=>{xr.state.transports[ot]=K}},state:{value:{currentLevel:"noop",transports:{}}},level:{get:()=>xr.state.currentLevel},removeTransport:{value:ot=>{delete xr.state.transports[ot]}},setLogLevel:{value:ot=>{if(te.some(K=>K===ot))xr.state.currentLevel=ot;else throw new Error(`${ot} is not a valid logger level`)}}});xr.addTransport("default",Te({}));te.reduce((ot,K)=>(Object.defineProperty(ot,K.toUpperCase(),{enumerable:!0,get:()=>K}),ot),xr);vn=function ot(K,ut){if(K instanceof Object){let dt=Array.isArray(K)?[]:{};for(let mt in K){let Et=ot(K[mt],ut);try{dt[mt]=JSON.parse(Et)}catch{Et!==void 0&&Et!==""&&(dt[mt]=Et)}}return dt}return typeof K!="string"?K:K.replace(/\{\{(.+?)}}/g,(dt,mt)=>{let Et=ut[mt]||"";return Et instanceof Object?JSON.stringify(Et):Et})}});var xn=hr((mi,hn)=>{var Zo=Object.freeze({anagram:{url:"https://stupid-genius.com/anagrams.cgi?{{word}}",method:"get"},ipinfo:{url:"https://ipinfo.io/{{ip}}",method:"get",headers:{accept:"application/json"}},jsonrpc:{url:"/terminal",method:"post",headers:{"content-type":"application/json"},body:{id:"{{id}}",method:"{{method}}",params:"{{params}}"}},nistprng:{url:"https://beacon.nist.gov/beacon/2.0/pulse/last",method:"get"},passgen:{url:"https://stupid-genius.com/passgen.cgi",method:"get"},qotd:{url:"https://stupid-genius.com/qotd.cgi",method:"get"},weather:{url:"https://wttr.in/{{location}}",method:"get"}});hn.exports=Zo});var _n=hr(()=>{(()=>{var ot=Object.create,K=Object.defineProperty,ut=Object.getOwnPropertyDescriptor,dt=Object.getOwnPropertyNames,mt=Object.getPrototypeOf,Et=Object.prototype.hasOwnProperty,Rt=r=>K(r,"__esModule",{value:!0}),it=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Wt=(r,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of dt(t))!Et.call(r,e)&&e!=="default"&&K(r,e,{get:()=>t[e],enumerable:!(n=ut(t,e))||n.enumerable});return r},cr=r=>Wt(Rt(K(r!=null?ot(mt(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),dr=it((r,t)=>{var n=function(e){"use strict";var E=1e7,g=7,T=9007199254740992,y=u(T),o="0123456789abcdefghijklmnopqrstuvwxyz",l=typeof BigInt=="function";function d(f,L,V,G){return typeof f>"u"?d[0]:typeof L<"u"?+L==10&&!V?rt(f):kt(f,L,V,G):rt(f)}function s(f,L){this.value=f,this.sign=L,this.isSmall=!1}s.prototype=Object.create(d.prototype);function i(f){this.value=f,this.sign=f<0,this.isSmall=!0}i.prototype=Object.create(d.prototype);function a(f){this.value=f}a.prototype=Object.create(d.prototype);function p(f){return-T<f&&f<T}function u(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function _(f){b(f);var L=f.length;if(L<4&&N(f,y)<0)switch(L){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*E;default:return f[0]+(f[1]+f[2]*E)*E}return f}function b(f){for(var L=f.length;f[--L]===0;);f.length=L+1}function A(f){for(var L=new Array(f),V=-1;++V<f;)L[V]=0;return L}function x(f){return f>0?Math.floor(f):Math.ceil(f)}function M(f,L){var V=f.length,G=L.length,st=new Array(V),tt=0,Y=E,ct,yt;for(yt=0;yt<G;yt++)ct=f[yt]+L[yt]+tt,tt=ct>=Y?1:0,st[yt]=ct-tt*Y;for(;yt<V;)ct=f[yt]+tt,tt=ct===Y?1:0,st[yt++]=ct-tt*Y;return tt>0&&st.push(tt),st}function j(f,L){return f.length>=L.length?M(f,L):M(L,f)}function q(f,L){var V=f.length,G=new Array(V),st=E,tt,Y;for(Y=0;Y<V;Y++)tt=f[Y]-st+L,L=Math.floor(tt/st),G[Y]=tt-L*st,L+=1;for(;L>0;)G[Y++]=L%st,L=Math.floor(L/st);return G}s.prototype.add=function(f){var L=rt(f);if(this.sign!==L.sign)return this.subtract(L.negate());var V=this.value,G=L.value;return L.isSmall?new s(q(V,Math.abs(G)),this.sign):new s(j(V,G),this.sign)},s.prototype.plus=s.prototype.add,i.prototype.add=function(f){var L=rt(f),V=this.value;if(V<0!==L.sign)return this.subtract(L.negate());var G=L.value;if(L.isSmall){if(p(V+G))return new i(V+G);G=u(Math.abs(G))}return new s(q(G,Math.abs(V)),V<0)},i.prototype.plus=i.prototype.add,a.prototype.add=function(f){return new a(this.value+rt(f).value)},a.prototype.plus=a.prototype.add;function O(f,L){var V=f.length,G=L.length,st=new Array(V),tt=0,Y=E,ct,yt;for(ct=0;ct<G;ct++)yt=f[ct]-tt-L[ct],yt<0?(yt+=Y,tt=1):tt=0,st[ct]=yt;for(ct=G;ct<V;ct++){if(yt=f[ct]-tt,yt<0)yt+=Y;else{st[ct++]=yt;break}st[ct]=yt}for(;ct<V;ct++)st[ct]=f[ct];return b(st),st}function C(f,L,V){var G;return N(f,L)>=0?G=O(f,L):(G=O(L,f),V=!V),G=_(G),typeof G=="number"?(V&&(G=-G),new i(G)):new s(G,V)}function et(f,L,V){var G=f.length,st=new Array(G),tt=-L,Y=E,ct,yt;for(ct=0;ct<G;ct++)yt=f[ct]+tt,tt=Math.floor(yt/Y),yt%=Y,st[ct]=yt<0?yt+Y:yt;return st=_(st),typeof st=="number"?(V&&(st=-st),new i(st)):new s(st,V)}s.prototype.subtract=function(f){var L=rt(f);if(this.sign!==L.sign)return this.add(L.negate());var V=this.value,G=L.value;return L.isSmall?et(V,Math.abs(G),this.sign):C(V,G,this.sign)},s.prototype.minus=s.prototype.subtract,i.prototype.subtract=function(f){var L=rt(f),V=this.value;if(V<0!==L.sign)return this.add(L.negate());var G=L.value;return L.isSmall?new i(V-G):et(G,Math.abs(V),V>=0)},i.prototype.minus=i.prototype.subtract,a.prototype.subtract=function(f){return new a(this.value-rt(f).value)},a.prototype.minus=a.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},i.prototype.negate=function(){var f=this.sign,L=new i(-this.value);return L.sign=!f,L},a.prototype.negate=function(){return new a(-this.value)},s.prototype.abs=function(){return new s(this.value,!1)},i.prototype.abs=function(){return new i(Math.abs(this.value))},a.prototype.abs=function(){return new a(this.value>=0?this.value:-this.value)};function lt(f,L){var V=f.length,G=L.length,st=V+G,tt=A(st),Y=E,ct,yt,Ct,Xt,Ut;for(Ct=0;Ct<V;++Ct){Xt=f[Ct];for(var Gt=0;Gt<G;++Gt)Ut=L[Gt],ct=Xt*Ut+tt[Ct+Gt],yt=Math.floor(ct/Y),tt[Ct+Gt]=ct-yt*Y,tt[Ct+Gt+1]+=yt}return b(tt),tt}function H(f,L){var V=f.length,G=new Array(V),st=E,tt=0,Y,ct;for(ct=0;ct<V;ct++)Y=f[ct]*L+tt,tt=Math.floor(Y/st),G[ct]=Y-tt*st;for(;tt>0;)G[ct++]=tt%st,tt=Math.floor(tt/st);return G}function U(f,L){for(var V=[];L-- >0;)V.push(0);return V.concat(f)}function v(f,L){var V=Math.max(f.length,L.length);if(V<=30)return lt(f,L);V=Math.ceil(V/2);var G=f.slice(V),st=f.slice(0,V),tt=L.slice(V),Y=L.slice(0,V),ct=v(st,Y),yt=v(G,tt),Ct=v(j(st,G),j(Y,tt)),Xt=j(j(ct,U(O(O(Ct,ct),yt),V)),U(yt,2*V));return b(Xt),Xt}function S(f,L){return-.012*f-.012*L+15e-6*f*L>0}s.prototype.multiply=function(f){var L=rt(f),V=this.value,G=L.value,st=this.sign!==L.sign,tt;if(L.isSmall){if(G===0)return d[0];if(G===1)return this;if(G===-1)return this.negate();if(tt=Math.abs(G),tt<E)return new s(H(V,tt),st);G=u(tt)}return S(V.length,G.length)?new s(v(V,G),st):new s(lt(V,G),st)},s.prototype.times=s.prototype.multiply;function D(f,L,V){return f<E?new s(H(L,f),V):new s(lt(L,u(f)),V)}i.prototype._multiplyBySmall=function(f){return p(f.value*this.value)?new i(f.value*this.value):D(Math.abs(f.value),u(Math.abs(this.value)),this.sign!==f.sign)},s.prototype._multiplyBySmall=function(f){return f.value===0?d[0]:f.value===1?this:f.value===-1?this.negate():D(Math.abs(f.value),this.value,this.sign!==f.sign)},i.prototype.multiply=function(f){return rt(f)._multiplyBySmall(this)},i.prototype.times=i.prototype.multiply,a.prototype.multiply=function(f){return new a(this.value*rt(f).value)},a.prototype.times=a.prototype.multiply;function Z(f){var L=f.length,V=A(L+L),G=E,st,tt,Y,ct,yt;for(Y=0;Y<L;Y++){ct=f[Y],tt=0-ct*ct;for(var Ct=Y;Ct<L;Ct++)yt=f[Ct],st=2*(ct*yt)+V[Y+Ct]+tt,tt=Math.floor(st/G),V[Y+Ct]=st-tt*G;V[Y+L]=tt}return b(V),V}s.prototype.square=function(){return new s(Z(this.value),!1)},i.prototype.square=function(){var f=this.value*this.value;return p(f)?new i(f):new s(Z(u(Math.abs(this.value))),!1)},a.prototype.square=function(f){return new a(this.value*this.value)};function F(f,L){var V=f.length,G=L.length,st=E,tt=A(L.length),Y=L[G-1],ct=Math.ceil(st/(2*Y)),yt=H(f,ct),Ct=H(L,ct),Xt,Ut,Gt,Qt,er,I,k;for(yt.length<=V&&yt.push(0),Ct.push(0),Y=Ct[G-1],Ut=V-G;Ut>=0;Ut--){for(Xt=st-1,yt[Ut+G]!==Y&&(Xt=Math.floor((yt[Ut+G]*st+yt[Ut+G-1])/Y)),Gt=0,Qt=0,I=Ct.length,er=0;er<I;er++)Gt+=Xt*Ct[er],k=Math.floor(Gt/st),Qt+=yt[Ut+er]-(Gt-k*st),Gt=k,Qt<0?(yt[Ut+er]=Qt+st,Qt=-1):(yt[Ut+er]=Qt,Qt=0);for(;Qt!==0;){for(Xt-=1,Gt=0,er=0;er<I;er++)Gt+=yt[Ut+er]-st+Ct[er],Gt<0?(yt[Ut+er]=Gt+st,Gt=0):(yt[Ut+er]=Gt,Gt=1);Qt+=Gt}tt[Ut]=Xt}return yt=R(yt,ct)[0],[_(tt),_(yt)]}function Q(f,L){for(var V=f.length,G=L.length,st=[],tt=[],Y=E,ct,yt,Ct,Xt,Ut;V;){if(tt.unshift(f[--V]),b(tt),N(tt,L)<0){st.push(0);continue}yt=tt.length,Ct=tt[yt-1]*Y+tt[yt-2],Xt=L[G-1]*Y+L[G-2],yt>G&&(Ct=(Ct+1)*Y),ct=Math.ceil(Ct/Xt);do{if(Ut=H(L,ct),N(Ut,tt)<=0)break;ct--}while(ct);st.push(ct),tt=O(tt,Ut)}return st.reverse(),[_(st),_(tt)]}function R(f,L){var V=f.length,G=A(V),st=E,tt,Y,ct,yt;for(ct=0,tt=V-1;tt>=0;--tt)yt=ct*st+f[tt],Y=x(yt/L),ct=yt-Y*L,G[tt]=Y|0;return[G,ct|0]}function h(f,L){var V,G=rt(L);if(l)return[new a(f.value/G.value),new a(f.value%G.value)];var st=f.value,tt=G.value,Y;if(tt===0)throw new Error("Cannot divide by zero");if(f.isSmall)return G.isSmall?[new i(x(st/tt)),new i(st%tt)]:[d[0],f];if(G.isSmall){if(tt===1)return[f,d[0]];if(tt==-1)return[f.negate(),d[0]];var ct=Math.abs(tt);if(ct<E){V=R(st,ct),Y=_(V[0]);var yt=V[1];return f.sign&&(yt=-yt),typeof Y=="number"?(f.sign!==G.sign&&(Y=-Y),[new i(Y),new i(yt)]):[new s(Y,f.sign!==G.sign),new i(yt)]}tt=u(ct)}var Ct=N(st,tt);if(Ct===-1)return[d[0],f];if(Ct===0)return[d[f.sign===G.sign?1:-1],d[0]];st.length+tt.length<=200?V=F(st,tt):V=Q(st,tt),Y=V[0];var Xt=f.sign!==G.sign,Ut=V[1],Gt=f.sign;return typeof Y=="number"?(Xt&&(Y=-Y),Y=new i(Y)):Y=new s(Y,Xt),typeof Ut=="number"?(Gt&&(Ut=-Ut),Ut=new i(Ut)):Ut=new s(Ut,Gt),[Y,Ut]}s.prototype.divmod=function(f){var L=h(this,f);return{quotient:L[0],remainder:L[1]}},a.prototype.divmod=i.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(f){return h(this,f)[0]},a.prototype.over=a.prototype.divide=function(f){return new a(this.value/rt(f).value)},i.prototype.over=i.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(f){return h(this,f)[1]},a.prototype.mod=a.prototype.remainder=function(f){return new a(this.value%rt(f).value)},i.prototype.remainder=i.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(f){var L=rt(f),V=this.value,G=L.value,st,tt,Y;if(G===0)return d[1];if(V===0)return d[0];if(V===1)return d[1];if(V===-1)return L.isEven()?d[1]:d[-1];if(L.sign)return d[0];if(!L.isSmall)throw new Error("The exponent "+L.toString()+" is too large.");if(this.isSmall&&p(st=Math.pow(V,G)))return new i(x(st));for(tt=this,Y=d[1];G&!0&&(Y=Y.times(tt),--G),G!==0;)G/=2,tt=tt.square();return Y},i.prototype.pow=s.prototype.pow,a.prototype.pow=function(f){var L=rt(f),V=this.value,G=L.value,st=BigInt(0),tt=BigInt(1),Y=BigInt(2);if(G===st)return d[1];if(V===st)return d[0];if(V===tt)return d[1];if(V===BigInt(-1))return L.isEven()?d[1]:d[-1];if(L.isNegative())return new a(st);for(var ct=this,yt=d[1];(G&tt)===tt&&(yt=yt.times(ct),--G),G!==st;)G/=Y,ct=ct.square();return yt},s.prototype.modPow=function(f,L){if(f=rt(f),L=rt(L),L.isZero())throw new Error("Cannot take modPow with modulus 0");var V=d[1],G=this.mod(L);for(f.isNegative()&&(f=f.multiply(d[-1]),G=G.modInv(L));f.isPositive();){if(G.isZero())return d[0];f.isOdd()&&(V=V.multiply(G).mod(L)),f=f.divide(2),G=G.square().mod(L)}return V},a.prototype.modPow=i.prototype.modPow=s.prototype.modPow;function N(f,L){if(f.length!==L.length)return f.length>L.length?1:-1;for(var V=f.length-1;V>=0;V--)if(f[V]!==L[V])return f[V]>L[V]?1:-1;return 0}s.prototype.compareAbs=function(f){var L=rt(f),V=this.value,G=L.value;return L.isSmall?1:N(V,G)},i.prototype.compareAbs=function(f){var L=rt(f),V=Math.abs(this.value),G=L.value;return L.isSmall?(G=Math.abs(G),V===G?0:V>G?1:-1):-1},a.prototype.compareAbs=function(f){var L=this.value,V=rt(f).value;return L=L>=0?L:-L,V=V>=0?V:-V,L===V?0:L>V?1:-1},s.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var L=rt(f),V=this.value,G=L.value;return this.sign!==L.sign?L.sign?1:-1:L.isSmall?this.sign?-1:1:N(V,G)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,i.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var L=rt(f),V=this.value,G=L.value;return L.isSmall?V==G?0:V>G?1:-1:V<0!==L.sign?V<0?-1:1:V<0?1:-1},i.prototype.compareTo=i.prototype.compare,a.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var L=this.value,V=rt(f).value;return L===V?0:L>V?1:-1},a.prototype.compareTo=a.prototype.compare,s.prototype.equals=function(f){return this.compare(f)===0},a.prototype.eq=a.prototype.equals=i.prototype.eq=i.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(f){return this.compare(f)!==0},a.prototype.neq=a.prototype.notEquals=i.prototype.neq=i.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(f){return this.compare(f)>0},a.prototype.gt=a.prototype.greater=i.prototype.gt=i.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(f){return this.compare(f)<0},a.prototype.lt=a.prototype.lesser=i.prototype.lt=i.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},a.prototype.geq=a.prototype.greaterOrEquals=i.prototype.geq=i.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},a.prototype.leq=a.prototype.lesserOrEquals=i.prototype.leq=i.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return(this.value[0]&1)==0},i.prototype.isEven=function(){return(this.value&1)==0},a.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},s.prototype.isOdd=function(){return(this.value[0]&1)==1},i.prototype.isOdd=function(){return(this.value&1)==1},a.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},s.prototype.isPositive=function(){return!this.sign},i.prototype.isPositive=function(){return this.value>0},a.prototype.isPositive=i.prototype.isPositive,s.prototype.isNegative=function(){return this.sign},i.prototype.isNegative=function(){return this.value<0},a.prototype.isNegative=i.prototype.isNegative,s.prototype.isUnit=function(){return!1},i.prototype.isUnit=function(){return Math.abs(this.value)===1},a.prototype.isUnit=function(){return this.abs().value===BigInt(1)},s.prototype.isZero=function(){return!1},i.prototype.isZero=function(){return this.value===0},a.prototype.isZero=function(){return this.value===BigInt(0)},s.prototype.isDivisibleBy=function(f){var L=rt(f);return L.isZero()?!1:L.isUnit()?!0:L.compareAbs(2)===0?this.isEven():this.mod(L).isZero()},a.prototype.isDivisibleBy=i.prototype.isDivisibleBy=s.prototype.isDivisibleBy;function $(f){var L=f.abs();if(L.isUnit())return!1;if(L.equals(2)||L.equals(3)||L.equals(5))return!0;if(L.isEven()||L.isDivisibleBy(3)||L.isDivisibleBy(5))return!1;if(L.lesser(49))return!0}function B(f,L){for(var V=f.prev(),G=V,st=0,tt,Y,ct,yt;G.isEven();)G=G.divide(2),st++;t:for(ct=0;ct<L.length;ct++)if(!f.lesser(L[ct])&&(yt=n(L[ct]).modPow(G,f),!(yt.isUnit()||yt.equals(V)))){for(tt=st-1;tt!=0;tt--){if(yt=yt.square().mod(f),yt.isUnit())return!1;if(yt.equals(V))continue t}return!1}return!0}s.prototype.isPrime=function(f){var L=$(this);if(L!==e)return L;var V=this.abs(),G=V.bitLength();if(G<=64)return B(V,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var st=Math.log(2)*G.toJSNumber(),tt=Math.ceil(f===!0?2*Math.pow(st,2):st),Y=[],ct=0;ct<tt;ct++)Y.push(n(ct+2));return B(V,Y)},a.prototype.isPrime=i.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(f,L){var V=$(this);if(V!==e)return V;for(var G=this.abs(),st=f===e?5:f,tt=[],Y=0;Y<st;Y++)tt.push(n.randBetween(2,G.minus(2),L));return B(G,tt)},a.prototype.isProbablePrime=i.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(f){for(var L=n.zero,V=n.one,G=rt(f),st=this.abs(),tt,Y,ct;!st.isZero();)tt=G.divide(st),Y=L,ct=G,L=V,G=st,V=Y.subtract(tt.multiply(V)),st=ct.subtract(tt.multiply(st));if(!G.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return L.compare(0)===-1&&(L=L.add(f)),this.isNegative()?L.negate():L},a.prototype.modInv=i.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var f=this.value;return this.sign?et(f,1,this.sign):new s(q(f,1),this.sign)},i.prototype.next=function(){var f=this.value;return f+1<T?new i(f+1):new s(y,!1)},a.prototype.next=function(){return new a(this.value+BigInt(1))},s.prototype.prev=function(){var f=this.value;return this.sign?new s(q(f,1),!0):et(f,1,this.sign)},i.prototype.prev=function(){var f=this.value;return f-1>-T?new i(f-1):new s(y,!0)},a.prototype.prev=function(){return new a(this.value-BigInt(1))};for(var X=[1];2*X[X.length-1]<=E;)X.push(2*X[X.length-1]);var J=X.length,pt=X[J-1];function _t(f){return Math.abs(f)<=E}s.prototype.shiftLeft=function(f){var L=rt(f).toJSNumber();if(!_t(L))throw new Error(String(L)+" is too large for shifting.");if(L<0)return this.shiftRight(-L);var V=this;if(V.isZero())return V;for(;L>=J;)V=V.multiply(pt),L-=J-1;return V.multiply(X[L])},a.prototype.shiftLeft=i.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(f){var L,V=rt(f).toJSNumber();if(!_t(V))throw new Error(String(V)+" is too large for shifting.");if(V<0)return this.shiftLeft(-V);for(var G=this;V>=J;){if(G.isZero()||G.isNegative()&&G.isUnit())return G;L=h(G,pt),G=L[1].isNegative()?L[0].prev():L[0],V-=J-1}return L=h(G,X[V]),L[1].isNegative()?L[0].prev():L[0]},a.prototype.shiftRight=i.prototype.shiftRight=s.prototype.shiftRight;function At(f,L,V){L=rt(L);for(var G=f.isNegative(),st=L.isNegative(),tt=G?f.not():f,Y=st?L.not():L,ct=0,yt=0,Ct=null,Xt=null,Ut=[];!tt.isZero()||!Y.isZero();)Ct=h(tt,pt),ct=Ct[1].toJSNumber(),G&&(ct=pt-1-ct),Xt=h(Y,pt),yt=Xt[1].toJSNumber(),st&&(yt=pt-1-yt),tt=Ct[0],Y=Xt[0],Ut.push(V(ct,yt));for(var Gt=V(G?1:0,st?1:0)!==0?n(-1):n(0),Qt=Ut.length-1;Qt>=0;Qt-=1)Gt=Gt.multiply(pt).add(n(Ut[Qt]));return Gt}s.prototype.not=function(){return this.negate().prev()},a.prototype.not=i.prototype.not=s.prototype.not,s.prototype.and=function(f){return At(this,f,function(L,V){return L&V})},a.prototype.and=i.prototype.and=s.prototype.and,s.prototype.or=function(f){return At(this,f,function(L,V){return L|V})},a.prototype.or=i.prototype.or=s.prototype.or,s.prototype.xor=function(f){return At(this,f,function(L,V){return L^V})},a.prototype.xor=i.prototype.xor=s.prototype.xor;var ht=1<<30,It=(E&-E)*(E&-E)|ht;function Lt(f){var L=f.value,V=typeof L=="number"?L|ht:typeof L=="bigint"?L|BigInt(ht):L[0]+L[1]*E|It;return V&-V}function Yt(f,L){if(L.compareTo(f)<=0){var V=Yt(f,L.square(L)),G=V.p,st=V.e,tt=G.multiply(L);return tt.compareTo(f)<=0?{p:tt,e:st*2+1}:{p:G,e:st*2}}return{p:n(1),e:0}}s.prototype.bitLength=function(){var f=this;return f.compareTo(n(0))<0&&(f=f.negate().subtract(n(1))),f.compareTo(n(0))===0?n(0):n(Yt(f,n(2)).e).add(n(1))},a.prototype.bitLength=i.prototype.bitLength=s.prototype.bitLength;function Bt(f,L){return f=rt(f),L=rt(L),f.greater(L)?f:L}function Zt(f,L){return f=rt(f),L=rt(L),f.lesser(L)?f:L}function ft(f,L){if(f=rt(f).abs(),L=rt(L).abs(),f.equals(L))return f;if(f.isZero())return L;if(L.isZero())return f;for(var V=d[1],G,st;f.isEven()&&L.isEven();)G=Zt(Lt(f),Lt(L)),f=f.divide(G),L=L.divide(G),V=V.multiply(G);for(;f.isEven();)f=f.divide(Lt(f));do{for(;L.isEven();)L=L.divide(Lt(L));f.greater(L)&&(st=L,L=f,f=st),L=L.subtract(f)}while(!L.isZero());return V.isUnit()?f:f.multiply(V)}function gt(f,L){return f=rt(f).abs(),L=rt(L).abs(),f.divide(ft(f,L)).multiply(L)}function Pt(f,L,V){f=rt(f),L=rt(L);var G=V||Math.random,st=Zt(f,L),tt=Bt(f,L),Y=tt.subtract(st).add(1);if(Y.isSmall)return st.add(Math.floor(G()*Y));for(var ct=Ot(Y,E).value,yt=[],Ct=!0,Xt=0;Xt<ct.length;Xt++){var Ut=Ct?ct[Xt]+(Xt+1<ct.length?ct[Xt+1]/E:0):E,Gt=x(G()*Ut);yt.push(Gt),Gt<ct[Xt]&&(Ct=!1)}return st.add(d.fromArray(yt,E,!1))}var kt=function(f,L,V,G){V=V||o,f=String(f),G||(f=f.toLowerCase(),V=V.toLowerCase());var st=f.length,tt,Y=Math.abs(L),ct={};for(tt=0;tt<V.length;tt++)ct[V[tt]]=tt;for(tt=0;tt<st;tt++){var yt=f[tt];if(yt!=="-"&&yt in ct&&ct[yt]>=Y){if(yt==="1"&&Y===1)continue;throw new Error(yt+" is not a valid digit in base "+L+".")}}L=rt(L);var Ct=[],Xt=f[0]==="-";for(tt=Xt?1:0;tt<f.length;tt++){var yt=f[tt];if(yt in ct)Ct.push(rt(ct[yt]));else if(yt==="<"){var Ut=tt;do tt++;while(f[tt]!==">"&&tt<f.length);Ct.push(rt(f.slice(Ut+1,tt)))}else throw new Error(yt+" is not a valid character")}return rr(Ct,L,Xt)};function rr(f,L,V){var G=d[0],st=d[1],tt;for(tt=f.length-1;tt>=0;tt--)G=G.add(f[tt].times(st)),st=st.times(L);return V?G.negate():G}function nt(f,L){return L=L||o,f<L.length?L[f]:"<"+f+">"}function Ot(f,L){if(L=n(L),L.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(L.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var V=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return V.unshift([1]),{value:[].concat.apply([],V),isNegative:!1}}var G=!1;if(f.isNegative()&&L.isPositive()&&(G=!0,f=f.abs()),L.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:G};for(var st=[],tt=f,Y;tt.isNegative()||tt.compareAbs(L)>=0;){Y=tt.divmod(L),tt=Y.quotient;var ct=Y.remainder;ct.isNegative()&&(ct=L.minus(ct).abs(),tt=tt.next()),st.push(ct.toJSNumber())}return st.push(tt.toJSNumber()),{value:st.reverse(),isNegative:G}}function w(f,L,V){var G=Ot(f,L);return(G.isNegative?"-":"")+G.value.map(function(st){return nt(st,V)}).join("")}s.prototype.toArray=function(f){return Ot(this,f)},i.prototype.toArray=function(f){return Ot(this,f)},a.prototype.toArray=function(f){return Ot(this,f)},s.prototype.toString=function(f,L){if(f===e&&(f=10),f!==10)return w(this,f,L);for(var V=this.value,G=V.length,st=String(V[--G]),tt="0000000",Y;--G>=0;)Y=String(V[G]),st+=tt.slice(Y.length)+Y;var ct=this.sign?"-":"";return ct+st},i.prototype.toString=function(f,L){return f===e&&(f=10),f!=10?w(this,f,L):String(this.value)},a.prototype.toString=i.prototype.toString,a.prototype.toJSON=s.prototype.toJSON=i.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return parseInt(this.toString(),10)},s.prototype.toJSNumber=s.prototype.valueOf,i.prototype.valueOf=function(){return this.value},i.prototype.toJSNumber=i.prototype.valueOf,a.prototype.valueOf=a.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function vt(f){if(p(+f)){var L=+f;if(L===x(L))return l?new a(BigInt(L)):new i(L);throw new Error("Invalid integer: "+f)}var V=f[0]==="-";V&&(f=f.slice(1));var G=f.split(/e/i);if(G.length>2)throw new Error("Invalid integer: "+G.join("e"));if(G.length===2){var st=G[1];if(st[0]==="+"&&(st=st.slice(1)),st=+st,st!==x(st)||!p(st))throw new Error("Invalid integer: "+st+" is not a valid exponent.");var tt=G[0],Y=tt.indexOf(".");if(Y>=0&&(st-=tt.length-Y-1,tt=tt.slice(0,Y)+tt.slice(Y+1)),st<0)throw new Error("Cannot include negative exponent part for integers");tt+=new Array(st+1).join("0"),f=tt}var ct=/^([0-9][0-9]*)$/.test(f);if(!ct)throw new Error("Invalid integer: "+f);if(l)return new a(BigInt(V?"-"+f:f));for(var yt=[],Ct=f.length,Xt=g,Ut=Ct-Xt;Ct>0;)yt.push(+f.slice(Ut,Ct)),Ut-=Xt,Ut<0&&(Ut=0),Ct-=Xt;return b(yt),new s(yt,V)}function P(f){if(l)return new a(BigInt(f));if(p(f)){if(f!==x(f))throw new Error(f+" is not an integer.");return new i(f)}return vt(f.toString())}function rt(f){return typeof f=="number"?P(f):typeof f=="string"?vt(f):typeof f=="bigint"?new a(f):f}for(var W=0;W<1e3;W++)d[W]=rt(W),W>0&&(d[-W]=rt(-W));return d.one=d[1],d.zero=d[0],d.minusOne=d[-1],d.max=Bt,d.min=Zt,d.gcd=ft,d.lcm=gt,d.isInstance=function(f){return f instanceof s||f instanceof i||f instanceof a},d.randBetween=Pt,d.fromArray=function(f,L,V){return rr(f.map(rt),rt(L||10),V)},d}();typeof t<"u"&&t.hasOwnProperty("exports")&&(t.exports=n),typeof define=="function"&&define.amd&&define(function(){return n})}),Cr=it(r=>{"use strict";var t=r&&r.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(r,"__esModule",{value:!0}),r.mcmp=void 0;var n=t(dr());function e(E,g){return E.compare(g)}r.mcmp=e}),Vr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.set_component=r.index_function=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Nt(),T=or();function y(l){let d=0,s=l[d],{ndim:i}=s.tensor,a=l.length-1;a>i&&e.stop("too many indices for tensor");let p=0;for(let b=0;b<a;b++){let A=g.nativeInt(l[d+b+1]);(A<1||A>s.tensor.dim[b])&&e.stop("index out of range"),p=p*s.tensor.dim[b]+A-1}if(i===a)return s.tensor.elem[p];p=s.tensor.dim.slice(a).reduce((b,A)=>b*A,p);let u=s.tensor.dim.slice(a).reduce((b,A)=>b*A,1),_=t.alloc_tensor(u);_.tensor.ndim=i-a,_.tensor.dim=s.tensor.dim.slice(a);for(let b=0;b<u;b++)_.tensor.elem[b]=s.tensor.elem[p+b];return T.check_tensor_dimensions(s),T.check_tensor_dimensions(_),_}r.index_function=y;function o(l){l<3&&e.stop("error in indexed assign");let d=n.defs.tos-l,s=n.defs.stack[d],i=n.defs.stack[d+1];n.istensor(i)||e.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:a}=i.tensor,p=l-2;p>a&&e.stop("error in indexed assign");let u=0;for(let b=0;b<p;b++){let A=g.nativeInt(n.defs.stack[d+b+2]);(A<1||A>i.tensor.dim[b])&&e.stop(`error in indexed assign
`),u=u*i.tensor.dim[b]+A-1}for(let b=p;b<a;b++)u=u*i.tensor.dim[b]+0;let _=t.alloc_tensor(i.tensor.nelem);if(_.tensor.ndim=i.tensor.ndim,_.tensor.dim=Array.from(i.tensor.dim),_.tensor.elem=Array.from(i.tensor.elem),T.check_tensor_dimensions(i),T.check_tensor_dimensions(_),i=_,a===p){n.istensor(s)&&e.stop("error in indexed assign"),i.tensor.elem[u]=s,T.check_tensor_dimensions(i),E.moveTos(n.defs.tos-l),E.push(i);return}n.istensor(s)||e.stop("error in indexed assign"),a-p!==s.tensor.ndim&&e.stop("error in indexed assign");for(let b=0;b<s.tensor.ndim;b++)i.tensor.dim[p+b]!==s.tensor.dim[b]&&e.stop("error in indexed assign");for(let b=0;b<s.tensor.nelem;b++)i.tensor.elem[u+b]=s.tensor.elem[b];T.check_tensor_dimensions(i),T.check_tensor_dimensions(s),E.moveTos(n.defs.tos-l),E.push(i)}r.set_component=o}),$r=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.countsize=r.countOccurrencesOfSymbol=r.count=void 0;var t=Ht(),n=xt(),e=y=>y.reduce((o,l)=>o+l,0);function E(y){let o;if(n.iscons(y)){let l=[...y];o=e(l.map(E))+l.length}else o=1;return o}r.count=E;function g(y,o){let l=0;return n.iscons(o)?l=e([...o].map(d=>g(y,d))):t.equal(y,o)&&(l=1),l}r.countOccurrencesOfSymbol=g;function T(y){let o=0;if(n.istensor(y))for(let l=0;l<y.tensor.nelem;l++)o+=E(y.tensor.elem[l]);else if(n.iscons(y)){let l=[...y];o=e(l.map(E))+l.length}else o=1;return o}r.countsize=T}),Kt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.collectUserSymbols=r.clear_symbols=r.push_symbol=r.symnum=r.get_binding=r.set_binding=r.get_printname=r.usr_symbol=r.std_symbol=r.Eval_symbolsinfo=void 0;var t=zt(),n=Mt(),e=Ht(),E=$r(),g=xt();function T(){let x=y();x!==""?e.new_string(x):_(g.NIL)}r.Eval_symbolsinfo=T;function y(){let x="";for(let M=g.NIL+1;M<g.symtab.length;M++){if(g.symtab[M].printname===""){if(g.isSymbolReclaimable[M]===!1)break;continue}let j=g.symtab[M]+"",q=(g.binding[M]+"").substring(0,4);x+="symbol: "+j+" size: "+E.countsize(g.binding[M])+" value: "+q+`...
`}return x}function o(x,M,j){let q=g.symtab[M];q==null&&g.breakpoint,q.printname=x,j!=null?q.latexPrint=j:q.latexPrint=x}r.std_symbol=o;function l(x){let M=0;for(M=0;M<g.NSYM;M++){if(x===g.symtab[M].printname)return g.symtab[M];if(g.symtab[M].printname==="")break}return M===g.NSYM&&t.stop("symbol table overflow"),g.symtab[M]=new g.Sym(x),g.binding[M]=g.symtab[M],g.isSymbolReclaimable[M]=!1,g.symtab[M]}r.usr_symbol=l;function d(x){return x.k!==g.SYM&&t.stop("symbol error"),x.printname}r.get_printname=d;function s(x,M){x.k!==g.SYM&&t.stop("symbol error");let j=g.symtab.indexOf(x);g.symtab.indexOf(x,j+1)!==-1&&(console.log("ops, more than one element!"),g.breakpoint),g.DEBUG&&console.log(`lookup >> set_binding lookup ${j}`),g.isSymbolReclaimable[j]=!1,g.binding[j]=M}r.set_binding=s;function i(x){x.k!==g.SYM&&t.stop("symbol error");let M=g.symtab.indexOf(x);return g.symtab.indexOf(x,M+1)!==-1&&(console.log("ops, more than one element!"),g.breakpoint),g.DEBUG&&console.log(`lookup >> get_binding lookup ${M}`),g.binding[M]}r.get_binding=i;function a(x){if(x.k!==g.SYM)return!1;let M=u(x);return M>g.PI&&M!==g.SYMBOL_I&&M!==g.SYMBOL_IDENTITY_MATRIX}var p=0;function u(x){p++,x.k!==g.SYM&&t.stop("symbol error");let M=g.symtab.indexOf(x);return g.symtab.indexOf(x,M+1)!==-1&&(console.log("ops, more than one element!"),g.breakpoint),g.DEBUG&&console.log(`lookup >> symnum lookup ${M} lookup # ${p}`),M}r.symnum=u;function _(x){n.push(g.symtab[x])}r.push_symbol=_;function b(){for(let x=g.NIL+1;x<g.NSYM;x++){if(g.symtab[x].printname===""){if(g.isSymbolReclaimable[x]===!1)break;continue}g.symtab[x]=new g.Sym(""),g.binding[x]=g.symtab[x],g.isSymbolReclaimable[x]=!1}}r.clear_symbols=b;function A(x,M){if(M==null&&(M=[]),a(x)&&M.indexOf(x)===-1){M.push(x);return}if(g.istensor(x)){for(let j=0;j<x.tensor.nelem;j++)A(x.tensor.elem[j],M);return}for(;g.iscons(x);)A(g.car(x),M),x=g.cdr(x)}r.collectUserSymbols=A}),St=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeList=r.list=void 0;var t=xt(),n=Mt();function e(g){n.push(t.symbol(t.NIL));for(let T=0;T<g;T++){let y=n.pop(),o=n.pop();n.push(new t.Cons(o,y))}}r.list=e;function E(...g){let T=t.symbol(t.NIL);for(let y=g.length-1;y>=0;y--)T=new t.Cons(g[y],T);return T}r.makeList=E}),pr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sine=r.Eval_sin=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=kr(),T=Tt(),y=wt(),o=St(),l=qt(),d=ir();function s(u){let _=i(T.Eval(t.cadr(u)));n.push(_)}r.Eval_sin=s;function i(u){return t.isadd(u)?a(u):p(u)}r.sine=i;function a(u){let _=t.cdr(u);for(;t.iscons(_);){let b=t.car(_);if(y.isnpi(b)){let A=e.subtract(u,b);return e.add(l.multiply(i(A),g.cosine(b)),l.multiply(g.cosine(A),i(b)))}_=t.cdr(_)}return p(u)}function p(u){if(t.car(u)===t.symbol(t.ARCSIN))return t.cadr(u);if(t.isdouble(u)){let b=Math.sin(u.d);return Math.abs(b)<1e-10&&(b=0),E.double(b)}if(y.isnegative(u))return l.negate(i(l.negate(u)));if(t.car(u)===t.symbol(t.ARCTAN))return l.multiply(t.cadr(u),d.power(e.add(t.Constants.one,d.power(t.cadr(u),E.integer(2))),E.rational(-1,2)));let _=E.nativeInt(l.divide(l.multiply(u,E.integer(180)),t.Constants.Pi()));if(_<0||isNaN(_))return o.makeList(t.symbol(t.SIN),u);switch(_%360){case 0:case 180:return t.Constants.zero;case 30:case 150:return E.rational(1,2);case 210:case 330:return E.rational(-1,2);case 45:case 135:return l.multiply(E.rational(1,2),d.power(E.integer(2),E.rational(1,2)));case 225:case 315:return l.multiply(E.rational(-1,2),d.power(E.integer(2),E.rational(1,2)));case 60:case 120:return l.multiply(E.rational(1,2),d.power(E.integer(3),E.rational(1,2)));case 240:case 300:return l.multiply(E.rational(-1,2),d.power(E.integer(3),E.rational(1,2)));case 90:return t.Constants.one;case 270:return t.Constants.negOne;default:return o.makeList(t.symbol(t.SIN),u)}}}),kr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cosine=r.Eval_cos=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Tt(),T=wt(),y=St(),o=qt(),l=ir(),d=pr();function s(u){let _=i(g.Eval(t.cadr(u)));n.push(_)}r.Eval_cos=s;function i(u){return t.isadd(u)?a(u):p(u)}r.cosine=i;function a(u){if(t.iscons(u)){for(let _ of u.tail())if(T.isnpi(_)){let b=e.subtract(u,_);return e.subtract(o.multiply(i(b),i(_)),o.multiply(d.sine(b),d.sine(_)))}}return p(u)}function p(u){if(t.car(u)===t.symbol(t.ARCCOS))return t.cadr(u);if(t.isdouble(u)){let b=Math.cos(u.d);return Math.abs(b)<1e-10&&(b=0),E.double(b)}if(T.isnegative(u)&&(u=o.negate(u)),t.car(u)===t.symbol(t.ARCTAN)){let b=e.add(t.Constants.one,l.power(t.cadr(u),E.integer(2)));return l.power(b,E.rational(-1,2))}let _=E.nativeInt(o.divide(o.multiply(u,E.integer(180)),t.Constants.Pi()));if(_<0||isNaN(_))return y.makeList(t.symbol(t.COS),u);switch(_%360){case 90:case 270:return t.Constants.zero;case 60:case 300:return E.rational(1,2);case 120:case 240:return E.rational(-1,2);case 45:case 315:return o.multiply(E.rational(1,2),l.power(E.integer(2),E.rational(1,2)));case 135:case 225:return o.multiply(E.rational(-1,2),l.power(E.integer(2),E.rational(1,2)));case 30:case 330:return o.multiply(E.rational(1,2),l.power(E.integer(3),E.rational(1,2)));case 150:case 210:return o.multiply(E.rational(-1,2),l.power(E.integer(3),E.rational(1,2)));case 0:return t.Constants.one;case 180:return t.Constants.negOne;default:return y.makeList(t.symbol(t.COS),u)}}}),Jn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dpow=void 0;var t=xt(),n=zt(),e=Ft(),E=Nt(),g=qt();function T(y,o){if(y===0&&o<0&&n.stop("divide by zero"),y>=0||o%1==0)return E.double(Math.pow(y,o));let l=Math.pow(Math.abs(y),o),d=Math.PI*o,s=0,i=0;return o%.5==0?(s=0,i=Math.sin(d)):(s=Math.cos(d),i=Math.sin(d)),e.add(E.double(s*l),g.multiply(E.double(i*l),t.Constants.imaginaryunit))}r.dpow=T}),jr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.factorial=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=St(),y=qt(),o=ir();function l(d){let s=g.nativeInt(d);return s<0||isNaN(s)?T.makeList(t.symbol(t.FACTORIAL),d):g.bignum_factorial(s)}r.factorial=l}),ve=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mpow=void 0;function t(n,e){return n.pow(e)}r.mpow=t}),Kn=it(r=>{"use strict";var t=r&&r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(r,"__esModule",{value:!0}),r.mroot=void 0;var n=t(dr()),e=Cr(),E=zt(),g=Nt(),T=ve();function y(o,l){o=o.abs(),l===0&&E.stop("root index is zero");let d=0;for(;o.shiftRight(d).toJSNumber()>0;)d++;if(d===0)return g.mint(0);d=Math.floor((d-1)/l);let s=Math.floor(d/32+1),i=n.default(s);for(let a=0;a<s;a++)i=i.and(n.default(1).shiftLeft(a).not());for(;d>=0;){i=i.or(n.default(1).shiftLeft(d));let a=T.mpow(i,l);switch(e.mcmp(a,o)){case 0:return i;case 1:i=i.and(n.default(1).shiftLeft(d).not());break}d--}return 0}r.mroot=y}),Yr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.areunivarpolysfactoredorexpandedform=r.gcd=r.Eval_gcd=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=Tt(),y=wt(),o=qt(),l=ir(),d=Wr(),s=St();function i(O){O=t.cdr(O);let C=T.Eval(t.car(O));t.iscons(O)&&(C=O.tail().reduce((et,lt)=>a(et,T.Eval(lt)),C)),n.push(C)}r.Eval_gcd=i;function a(O,C){return t.doexpand(p,O,C)}r.gcd=a;function p(O,C){let et;return e.equal(O,C)?O:t.isrational(O)&&t.isrational(C)?g.gcd_numbers(O,C):(et=u(O,C))?_(O,C,et):t.isadd(O)&&t.isadd(C)?x(O,C):(t.isadd(O)&&(O=M(O)),t.isadd(C)&&(C=M(C)),t.ismultiply(O)?j(O,C):t.ismultiply(C)?q(O,C):t.ismultiply(O)&&t.ismultiply(C)?b(O,C):A(O,C))}function u(O,C){let et;if((et=y.isunivarpolyfactoredorexpandedform(O))&&y.isunivarpolyfactoredorexpandedform(C,et))return et}r.areunivarpolysfactoredorexpandedform=u;function _(O,C,et){return O=d.factorpoly(O,et),C=d.factorpoly(C,et),(t.ismultiply(O)||t.ismultiply(C))&&(t.ismultiply(O)||(O=s.makeList(t.symbol(t.MULTIPLY),O,t.Constants.one)),t.ismultiply(C)||(C=s.makeList(t.symbol(t.MULTIPLY),C,t.Constants.one))),t.ismultiply(O)&&t.ismultiply(C)?b(O,C):A(O,C)}function b(O,C){let et=t.cdr(O),lt=t.cdr(C);if(t.iscons(et))return[...et].reduce((H,U)=>{if(t.iscons(lt))return o.multiply(H,[...lt].reduce((v,S)=>o.multiply(v,a(U,S)),t.Constants.one))},t.Constants.one)}function A(O,C){let et,lt,H;if(t.ispower(O)?(et=t.caddr(O),O=t.cadr(O)):et=t.Constants.one,t.ispower(C)?(lt=t.caddr(C),C=t.cadr(C)):lt=t.Constants.one,!e.equal(O,C))return t.Constants.one;if(t.isNumericAtom(et)&&t.isNumericAtom(lt)){let S=e.lessp(et,lt)?et:lt;return l.power(O,S)}let U=o.divide(et,lt);if(t.isNumericAtom(U)){U=t.ismultiply(et)&&t.isNumericAtom(t.cadr(et))?t.cadr(et):t.Constants.one,H=t.ismultiply(lt)&&t.isNumericAtom(t.cadr(lt))?t.cadr(lt):t.Constants.one;let S=e.lessp(U,H)?et:lt;return l.power(O,S)}if(U=E.subtract(et,lt),!t.isNumericAtom(U))return t.Constants.one;let v=y.isnegativenumber(U)?et:lt;return l.power(O,v)}function x(O,C){let et,lt,H,U;return e.length(O)!==e.length(C)?t.Constants.one:(et=t.iscons(O)?O.tail().reduce(a):t.car(t.cdr(O)),lt=t.iscons(C)?C.tail().reduce(a):t.car(t.cdr(C)),H=o.divide(O,et),U=o.divide(C,lt),e.equal(H,U)?o.multiply(H,a(et,lt)):t.Constants.one)}function M(O){return t.iscons(O)?O.tail().reduce(a):t.car(t.cdr(O))}function j(O,C){return t.iscons(O)?O.tail().reduce((et,lt)=>o.multiply(et,a(lt,C)),t.Constants.one):t.Constants.one}function q(O,C){return t.iscons(C)?C.tail().reduce((et,lt)=>o.multiply(et,a(O,lt)),t.Constants.one):t.Constants.one}}),$e=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.lcm=r.Eval_lcm=void 0;var t=Yr(),n=xt(),e=Mt(),E=Tt(),g=qt();function T(l){l=n.cdr(l);let d=E.Eval(n.car(l));n.iscons(l)&&(d=l.tail().reduce((s,i)=>y(s,E.Eval(i)),d)),e.push(d)}r.Eval_lcm=T;function y(l,d){return n.doexpand(o,l,d)}r.lcm=y;function o(l,d){return g.inverse(g.divide(g.divide(t.gcd(l,d),l),d))}}),oe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filter=r.Eval_filter=void 0;var t=lr(),n=xt(),e=fr(),E=Mt(),g=Ft(),T=Tt();function y(i){i=n.cdr(i);let a=T.Eval(n.car(i));n.iscons(i)&&(a=i.tail().reduce((p,u)=>o(p,T.Eval(u)),a)),E.push(a)}r.Eval_filter=y;function o(i,a){return l(i,a)}r.filter=o;function l(i,a){return n.isadd(i)?d(i,a):n.istensor(i)?s(i,a):e.Find(i,a)?n.Constants.zero:i}function d(i,a){return n.iscons(i)?i.tail().reduce((p,u)=>g.add(p,o(u,a)),n.Constants.zero):n.Constants.zero}function s(i,a){let p=i.tensor.nelem,u=t.alloc_tensor(p);return u.tensor.ndim=i.tensor.ndim,u.tensor.dim=Array.from(i.tensor.dim),u.tensor.elem=i.tensor.elem.map(_=>o(_,a)),u}}),_r=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subst=void 0;var t=lr(),n=xt(),e=Ht(),E=or();function g(T,y,o){if(y===n.symbol(n.NIL)||o===n.symbol(n.NIL))return T;if(n.istensor(T)){let l=t.alloc_tensor(T.tensor.nelem);return l.tensor.ndim=T.tensor.ndim,l.tensor.dim=Array.from(T.tensor.dim),l.tensor.elem=T.tensor.elem.map(d=>{let s=g(d,y,o);return E.check_tensor_dimensions(l),s}),l}return e.equal(T,y)?o:n.iscons(T)?new n.Cons(g(n.car(T),y,o),g(n.cdr(T),y,o)):T}r.subst=g}),Xr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.coeff=r.Eval_coeff=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Tt(),T=oe(),y=qt(),o=ir(),l=_r();function d(i){let a=g.Eval(t.cadddr(i)),p=g.Eval(t.caddr(i)),u=g.Eval(t.cadr(i));a===t.symbol(t.NIL)&&(a=p,p=t.symbol(t.SYMBOL_X)),n.push(T.filter(y.divide(u,o.power(p,a)),p))}r.Eval_coeff=d;function s(i,a){let p=[];for(;;){let u=g.Eval(l.subst(i,a,t.Constants.zero));if(p.push(u),i=E.subtract(i,u),e.equal(i,t.Constants.zero))return p;i=t.doexpand(y.divide,i,a)}}r.coeff=s}),ie=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.yycondense=r.Condense=r.Eval_condense=void 0;var t=Yr(),n=xt(),e=Mt(),E=Ht(),g=Ft(),T=Tt(),y=qt();function o(s){let i=l(T.Eval(n.cadr(s)));e.push(i)}r.Eval_condense=o;function l(s){return n.noexpand(d,s)}r.Condense=l;function d(s){if(!n.isadd(s))return s;let i=s.tail().reduce(t.gcd),a=y.inverse(i),p=s.tail().reduce((_,b)=>g.add(_,y.multiply_noexpand(a,b)),n.Constants.zero),u=E.yyexpand(p);return y.divide(u,a)}r.yycondense=d}),ke=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ydivisors=r.divisors=void 0;var t=Yr(),n=lr(),e=xt(),E=Ht(),g=Ft(),T=Nt(),y=le(),o=wt(),l=qt(),d=ir();function s(_){let b=a(_),A=b.length;b.sort(E.cmp_expr);let x=n.alloc_tensor(A);return x.tensor.ndim=1,x.tensor.dim[0]=A,x.tensor.elem=b,x}r.divisors=s;var i=_=>[].concat(..._);function a(_){let b=[];if(e.isNumericAtom(_))b.push(...y.factor_small_number(T.nativeInt(_)));else if(e.isadd(_))b.push(...u(_));else if(e.ismultiply(_)){if(_=e.cdr(_),e.isNumericAtom(e.car(_))&&(b.push(...y.factor_small_number(T.nativeInt(e.car(_)))),_=e.cdr(_)),e.iscons(_)){let x=[..._].map(M=>e.ispower(M)?[e.cadr(M),e.caddr(M)]:[M,e.Constants.one]);b.push(...i(x))}}else e.ispower(_)?b.push(e.cadr(_),e.caddr(_)):b.push(_,e.Constants.one);let A=b.length;return b.push(e.Constants.one),p(b,0,A),b.slice(A)}r.ydivisors=a;function p(_,b,A){let x=_.pop();if(b===A){_.push(x);return}let M=_[b+0],j=_[b+1],q=T.nativeInt(j);if(!isNaN(q))for(let O=0;O<=Math.abs(q);O++)_.push(l.multiply(x,d.power(M,T.integer(E.sign(q)*O)))),p(_,b+2,A)}function u(_){let b=e.iscons(_)?_.tail().reduce(t.gcd):e.car(_),A=[],x=b;if(o.isplusone(x))return A.push(_,e.Constants.one),A;if(e.isNumericAtom(x))A.push(...y.factor_small_number(T.nativeInt(x)));else if(e.ismultiply(x)){let j=e.cdr(x);e.isNumericAtom(e.car(j))?A.push(...y.factor_small_number(T.nativeInt(e.car(j)))):A.push(e.car(j),e.Constants.one),e.iscons(j)&&j.tail().forEach(q=>A.push(q,e.Constants.one))}else A.push(x,e.Constants.one);x=l.inverse(x);let M=e.iscons(_)?_.tail().reduce((j,q)=>g.add(j,l.multiply(x,q)),e.Constants.zero):e.cdr(_);return A.push(M,e.Constants.one),A}}),ae=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rationalize=r.Eval_rationalize=void 0;var t=Yr(),n=xt(),e=Mt(),E=Ft(),g=ie(),T=Tt(),y=wt(),o=qt(),l=or();function d(A){let x=s(T.Eval(n.cadr(A)));e.push(x)}r.Eval_rationalize=d;function s(A){let x=n.defs.expanding,M=i(A);return n.defs.expanding=x,M}r.rationalize=s;function i(A){if(n.istensor(A))return _(A);if(n.defs.expanding=!1,!n.isadd(A))return A;let x=a(A),M=n.Constants.zero;return n.iscons(A)&&(M=A.tail().reduce((j,q)=>E.add(j,o.multiply(x,q)),M)),o.divide(g.Condense(M),x)}function a(A){return n.isadd(A)?A.tail().reduce((x,M)=>p(M,x),n.Constants.one):p(A,n.Constants.one)}function p(A,x){return n.ismultiply(A)?A.tail().reduce((M,j)=>u(j,M),x):u(A,x)}function u(A,x){if(!n.ispower(A))return x;let M=A;return A=n.caddr(A),y.isnegativenumber(A)||n.ismultiply(A)&&y.isnegativenumber(n.cadr(A))?b(x,o.inverse(M)):x}function _(A){return A=T.Eval(A),n.istensor(A)&&(A.tensor.elem=A.tensor.elem.map(s),l.check_tensor_dimensions(A)),A}function b(A,x){return o.divide(o.multiply(A,x),t.gcd(A,x))}}),qr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.numerator=r.Eval_numerator=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=qt(),y=ae();function o(d){let s=l(E.Eval(t.cadr(d)));n.push(s)}r.Eval_numerator=o;function l(d){return t.isadd(d)&&(d=y.rationalize(d)),t.ismultiply(d)&&!g.isplusone(t.car(t.cdr(d)))?T.multiply_all(d.tail().map(l)):t.isrational(d)?e.mp_numerator(d):t.ispower(d)&&g.isnegativeterm(t.caddr(d))?t.Constants.one:d}r.numerator=l}),Ue=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.print2dascii=void 0;var t=xt(),n=Pr(),e=Kt(),E=Nr(),g=Nt(),T=wt(),y=Ir(),o=1e4,l=class{constructor(){this.c=0,this.x=0,this.y=0}},d=[];for(let w=0;w<o;w++)d[w]=new l;var s=0,i=0,a=0,p=0;function u(w){let vt="";return vt+=w,vt}function _(w){return u(w)}function b(w){s=0,i=0,a=0,A(w);let[vt,P,rt]=Array.from(At(0,s));if(P>100){y.printline(w);return}return Bt()}r.print2dascii=b;function A(w){if(t.car(w)===t.symbol(t.SETQ)){M(t.cadr(w)),It(" = "),M(t.caddr(w));return}t.istensor(w)?rr(w):M(w)}function x(w){if(i>0)return!1;if(T.isfraction(w))return!0;if(!t.ismultiply(w))return!1;if(T.isfraction(t.cadr(w)))return!0;for(;t.iscons(w);){if(C(t.car(w)))return!0;w=t.cdr(w)}return!1}function M(w){if(p++,t.isadd(w))for(w=t.cdr(w),q(t.car(w))&&(ht("-"),x(t.car(w))&&ht(" ")),O(t.car(w)),w=t.cdr(w);t.iscons(w);)q(t.car(w))?(ht(" "),ht("-"),ht(" ")):(ht(" "),ht("+"),ht(" ")),O(t.car(w)),w=t.cdr(w);else q(w)&&(ht("-"),x(w)&&ht(" ")),O(w);p--}function j(w){if(t.isadd(w))for(w=t.cdr(w),O(t.car(w)),w=t.cdr(w);t.iscons(w);)q(t.car(w))?(ht(" "),ht("-"),ht(" ")):(ht(" "),ht("+"),ht(" ")),O(t.car(w)),w=t.cdr(w);else O(w)}function q(w){return!!(T.isnegativenumber(w)||t.ismultiply(w)&&T.isnegativenumber(t.cadr(w)))}function O(w){if(t.ismultiply(w)){let vt=et(w);vt&&i===0?H(w,vt):lt(w,vt)}else S(w)}function C(w){return t.ispower(w)&&t.cadr(w)!==t.symbol(t.E)&&q(t.caddr(w))}function et(w){let vt=0;for(w=t.cdr(w);t.iscons(w);){let P=t.car(w);C(P)&&vt++,w=t.cdr(w)}return vt}function lt(w,vt){if(vt===0)for(w=t.cdr(w),(T.isplusone(t.car(w))||T.isminusone(t.car(w)))&&(w=t.cdr(w)),S(t.car(w)),w=t.cdr(w);t.iscons(w);)ht(" "),S(t.car(w)),w=t.cdr(w);else U(w),ht("/"),vt>1||T.isfraction(t.cadr(w))?(ht("("),v(w),ht(")")):v(w)}function H(w,vt){let P,rt,W=0,f=0,L=0,V=0,G=0,st=t.Constants.one,tt=t.Constants.one;for(t.isrational(t.cadr(w))&&(st=E.absval(g.mp_numerator(t.cadr(w))),tt=g.mp_denominator(t.cadr(w))),t.isdouble(t.cadr(w))&&(st=E.absval(t.cadr(w))),V=T.isplusone(st)?0:1,P=t.cdr(w),t.isNumericAtom(t.car(P))&&(P=t.cdr(P));t.iscons(P);)rt=t.car(P),C(rt)||V++,P=t.cdr(P);for(G=a,f=s,W=0,T.isplusone(st)||(Lt(st,0),W++),P=t.cdr(w),t.isNumericAtom(t.car(P))&&(P=t.cdr(P));t.iscons(P);)rt=t.car(P),C(rt)||(W>0&&ht(" "),V===1?M(rt):S(rt),W++),P=t.cdr(P);for(W===0&&ht("1"),L=s,W=0,T.isplusone(tt)||(Lt(tt,0),W++,vt++),P=t.cdr(w),t.isrational(t.car(P))&&(P=t.cdr(P));t.iscons(P);)rt=t.car(P),C(rt)&&(W>0&&ht(" "),Q(rt,vt),W++),P=t.cdr(P);J(G,f,L)}function U(w){let vt=t.Constants.one;w=t.cdr(w),t.isrational(t.car(w))?(vt=E.absval(g.mp_numerator(t.car(w))),w=t.cdr(w)):t.isdouble(t.car(w))&&(vt=E.absval(t.car(w)),w=t.cdr(w));let P=0;for(T.isplusone(vt)||(Lt(vt,0),P++);t.iscons(w);)C(t.car(w))||(P>0&&ht(" "),S(t.car(w)),P++),w=t.cdr(w);P===0&&ht("1")}function v(w){let vt=0;if(w=t.cdr(w),T.isfraction(t.car(w))){let P=g.mp_denominator(t.car(w));Lt(P,0),vt++,w=t.cdr(w)}for(;t.iscons(w);)C(t.car(w))&&(vt>0&&ht(" "),Q(t.car(w),0),vt++),w=t.cdr(w)}function S(w){if(t.istensor(w)){nt(w);return}if(t.isdouble(w)){Lt(w,0);return}if(t.isadd(w)||t.ismultiply(w)){$(w);return}if(t.ispower(w)){F(w);return}if(t.iscons(w)){R(w);return}if(t.isNumericAtom(w)){i===0?D(w):Lt(w,0);return}if(t.issymbol(w)){B(w);return}t.isstr(w)&&X(w)}function D(w){let vt=E.absval(g.mp_numerator(w)),P=g.mp_denominator(w);if(T.isplusone(P)){Lt(vt,0);return}let rt=a,W=s;Lt(vt,0);let f=s;Lt(P,0),J(rt,W,f)}function Z(w){return t.iscons(w)&&!t.isadd(w)&&!t.ismultiply(w)&&!t.ispower(w)||t.issymbol(w)?!0:T.isfraction(w)||T.isnegativenumber(w)?!1:!!t.isNumericAtom(w)}function F(w){let vt=0,P=0,rt=0;if(t.cadr(w)===t.symbol(t.E)){It("exp("),M(t.caddr(w)),ht(")");return}if(i>0){T.isminusone(t.caddr(w))?(ht("1"),ht("/"),Z(t.cadr(w))?S(t.cadr(w)):$(t.cadr(w))):(Z(t.cadr(w))?S(t.cadr(w)):$(t.cadr(w)),ht("^"),Z(t.caddr(w))?S(t.caddr(w)):$(t.caddr(w)));return}if(q(t.caddr(w))){rt=a,vt=s,ht("1"),P=s,Q(w,1),J(rt,vt,P);return}vt=s,Z(t.cadr(w))?S(t.cadr(w)):$(t.cadr(w)),P=s,i++,M(t.caddr(w)),i--,pt(vt,P)}function Q(w,vt){let P=0,rt=0;if(T.isminusone(t.caddr(w))){vt===1?M(t.cadr(w)):S(t.cadr(w));return}P=s,Z(t.cadr(w))?S(t.cadr(w)):$(t.cadr(w)),rt=s,i++,j(t.caddr(w)),i--,pt(P,rt)}function R(w){if(t.car(w)===t.symbol(t.INDEX)&&t.issymbol(t.cadr(w))){h(w);return}if(t.isfactorial(w)){N(w);return}if(t.car(w)===t.symbol(t.DERIVATIVE)?ht("d"):B(t.car(w)),ht("("),w=t.cdr(w),t.iscons(w))for(M(t.car(w)),w=t.cdr(w);t.iscons(w);)ht(","),M(t.car(w)),w=t.cdr(w);ht(")")}function h(w){if(w=t.cdr(w),t.caar(w)===t.symbol(t.ADD)||t.caar(w)===t.symbol(t.MULTIPLY)||t.caar(w)===t.symbol(t.POWER)||t.caar(w)===t.symbol(t.FACTORIAL)?$(t.car(w)):M(t.car(w)),ht("["),w=t.cdr(w),t.iscons(w))for(M(t.car(w)),w=t.cdr(w);t.iscons(w);)ht(","),M(t.car(w)),w=t.cdr(w);ht("]")}function N(w){w=t.cadr(w),T.isfraction(w)||t.isadd(w)||t.ismultiply(w)||t.ispower(w)||t.isfactorial(w)?$(w):M(w),ht("!")}function $(w){ht("("),M(w),ht(")")}function B(w){if(w===t.symbol(t.E)){It("exp(1)");return}let vt=e.get_printname(w);for(let P=0;P<vt.length;P++)ht(vt[P])}function X(w){let vt=w.str;ht('"');for(let P=0;P<vt.length;P++)ht(vt[P]);ht('"')}function J(w,vt,P){let rt=0,W=0,[f,L,V]=Array.from(At(vt,P)),[G,st,tt]=Array.from(At(P,s));st>L?rt=(st-L)/2:rt=0,rt++,W=-(V+f-1)-1,_t(vt,P,rt,W),st>L?rt=-L:rt=-L+(L-st)/2,rt++,W=-tt+1,_t(P,s,rt,W);let Y=0;st>L?Y=st:Y=L,Y+=2,a=w;for(let ct=0;ct<Y;ct++)ht("-")}function pt(w,vt){let P=0,rt=0,W=0,f=0,L=0,V=0,G=0;[rt,W,f]=Array.from(At(w,vt)),[L,V,G]=Array.from(At(vt,s)),P=-G-L+1,P+=f-1,_t(vt,s,0,P)}function _t(w,vt,P,rt){for(let W=w;W<vt;W++)d[W].x+=P,d[W].y+=rt}function At(w,vt){let P=d[w].x,rt=d[w].x,W=d[w].y,f=d[w].y;for(let G=w+1;G<vt;G++)d[G].x<P&&(P=d[G].x),d[G].x>rt&&(rt=d[G].x),d[G].y<W&&(W=d[G].y),d[G].y>f&&(f=d[G].y);let L=f-W+1,V=rt-P+1;return[L,V,W]}function ht(w){if(s!==o)return d[s]==null&&t.breakpoint,d[s].c=w,d[s].x=a,d[s].y=0,s++,a++}function It(w){for(let vt=0;vt<w.length;vt++)ht(w[vt])}function Lt(w,vt){let P="";switch(w.k){case t.NUM:P=w.q.a.toString(),P[0]==="-"&&vt===0&&(P=P.substring(1));for(let rt=0;rt<P.length;rt++)ht(P[rt]);if(P=w.q.b.toString(),P==="1")break;ht("/");for(let rt=0;rt<P.length;rt++)ht(P[rt]);break;case t.DOUBLE:P=n.doubleToReasonableString(w.d),P[0]==="-"&&vt===0&&(P=P.substring(1));for(let rt=0;rt<P.length;rt++)ht(P[rt]);break}}function Yt(w,vt){return w.y<vt.y?-1:w.y>vt.y?1:w.x<vt.x?-1:w.x>vt.x?1:0}function Bt(){let w="",vt=d.slice(0,s);vt.sort(Yt),d=[].concat(vt).concat(d.slice(s));let P=0,{y:rt}=d[0];for(let W=0;W<s;W++){for(;d[W].y>rt;)w+=_(`
`),P=0,rt++;for(;d[W].x>P;)w+=u(" "),P++;w+=u(d[W].c),P++}return w}var Zt=100,ft=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},gt=[];for(let w=0;w<1e4;w++)gt[w]=new ft;var Pt=3,kt=1;function rr(w){let vt=0,P=0,rt=0;if(w.tensor.ndim>2){nt(w);return}let W=w.tensor.dim[0];w.tensor.ndim===2?vt=w.tensor.dim[1]:vt=1;let f=W*vt;if(f>Zt){nt(w);return}let L=a;for(let ct=0;ct<f;ct++)gt[ct].index=s,gt[ct].x=a,M(w.tensor.elem[ct]),gt[ct].count=s-gt[ct].index,[gt[ct].h,gt[ct].w,gt[ct].y]=Array.from(At(gt[ct].index,s));let V=0,G=0;for(let ct=0;ct<f;ct++)gt[ct].h>V&&(V=gt[ct].h),gt[ct].w>G&&(G=gt[ct].w);let st=W*V+(W-1)*kt,tt=vt*G+(vt-1)*Pt,Y=-(st/2);for(let ct=0;ct<W;ct++)for(let yt=0;yt<vt;yt++){let Ct=ct*vt+yt;P=L-gt[Ct].x,rt=Y-gt[Ct].y,_t(gt[Ct].index,gt[Ct].index+gt[Ct].count,P,rt),P=0,yt>0&&(P=yt*(G+Pt)),rt=0,ct>0&&(rt=ct*(V+kt)),P+=(G-gt[Ct].w)/2,rt+=(V-gt[Ct].h)/2,_t(gt[Ct].index,gt[Ct].index+gt[Ct].count,P,rt)}a=L+tt}function nt(w){Ot(w,0,0)}function Ot(w,vt,P){ht("(");for(let rt=0;rt<w.tensor.dim[vt];rt++)vt+1===w.tensor.ndim?(M(w.tensor.elem[P]),P=P+1):P=Ot(w,vt+1,P),rt+1<w.tensor.dim[vt]&&ht(",");return ht(")"),P}}),Ur=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.scan_meta=r.scan=void 0;var t=lr(),n=xt(),e=Pr(),E=zt(),g=Mt(),T=Kt(),y=Ht(),o=Nt(),l=wt(),d=St(),s=qt(),i=or(),a=1001,p=1002,u=1003,_=1004,b=1006,A=1007,x=1008,M=1009,j=1010,q=1011,O=1012,C="",et=0,lt=0,H=0,U=0,v=0,S="",D=null,Z=null,F=null,Q=null,R=null,h=null,N=!1,$=null,B="";function X(G){n.DEBUG&&console.log(`#### scanning ${G}`),D=null,Z=[],F=[],Q=!0,R=[],h=[""],$=!1,B=G,lt=0;let st=n.defs.expanding;return n.defs.expanding=!0,H=0,U=0,f(),C===""?(g.push(n.symbol(n.NIL)),n.defs.expanding=st,0):(pt(),n.defs.expanding=st,$||(n.defs.symbolsInExpressionsWithoutAssignments=n.defs.symbolsInExpressionsWithoutAssignments.concat(F)),v-H)}r.scan=X;function J(G){B=G,lt=1;let st=n.defs.expanding;if(n.defs.expanding=!0,H=0,U=0,f(),C===""){g.push(n.symbol(n.NIL)),n.defs.expanding=st;return}pt(),n.defs.expanding=st,v-H}r.scan_meta=J;function pt(){_t();let G=!1;if(C===O&&(G=!0),C===O||C==="="){let st=D;if(n.DEBUG&&console.log("assignment!"),$=!0,Q=!1,f(),T.push_symbol(n.SETQ),g.swap(),G&&T.push_symbol(n.QUOTE),_t(),G&&d.list(2),d.list(3),Q=!0,n.defs.codeGen){let tt=Z.indexOf(st);if(tt!==-1&&(Z.splice(tt,1),n.defs.symbolsHavingReassignments.push(st)),n.DEBUG){console.log(`locally, ${st} depends on: `);for(let ct of Array.from(Z))console.log(`  ${ct}`)}n.defs.symbolsDependencies[st]==null&&(n.defs.symbolsDependencies[st]=[]);let Y=n.defs.symbolsDependencies[st];for(let ct of Array.from(Z))Y.indexOf(ct)===-1&&Y.push(ct);Z=[]}}}function _t(){switch(At(),C){case j:return T.push_symbol(n.TESTEQ),g.swap(),f(),At(),d.list(3);case q:return T.push_symbol(n.NOT),g.swap(),T.push_symbol(n.TESTEQ),g.swap(),f(),At(),d.list(3),d.list(2);case M:return T.push_symbol(n.TESTLE),g.swap(),f(),At(),d.list(3);case x:return T.push_symbol(n.TESTGE),g.swap(),f(),At(),d.list(3);case"<":return T.push_symbol(n.TESTLT),g.swap(),f(),At(),d.list(3);case">":return T.push_symbol(n.TESTGT),g.swap(),f(),At(),d.list(3)}}function At(){let G=n.defs.tos;switch(C){case"+":f(),Bt();break;case"-":f(),Bt(),g.push(s.negate(g.pop()));break;default:Bt()}for(;et===0&&(C==="+"||C==="-");)C==="+"?(f(),Bt()):(f(),Bt(),g.push(s.negate(g.pop())));n.defs.tos-G>1&&(d.list(n.defs.tos-G),g.push(new n.Cons(n.symbol(n.ADD),g.pop())))}function ht(){if(typeof C=="string")return C.charCodeAt(0)}function It(){if(ht()===n.dotprod_unicode)return!0;switch(C){case"*":case"/":return!0;case"(":case u:case _:case a:case p:case A:return et?(U=v,!1):!0}return!1}function Lt(G,st){G>st&&n.isrational(n.defs.stack[G-1])&&l.equaln(n.defs.stack[G-1],1)&&g.pop()}function Yt(G,st){if(G>st+1&&n.isNumericAtom(n.defs.stack[G-2])&&n.isNumericAtom(n.defs.stack[G-1])){let tt=g.pop(),Y=g.pop();g.push(s.multiply(Y,tt))}}function Bt(){let G=n.defs.tos;for(gt(),n.parse_time_simplifications&&Lt(n.defs.tos,G);It();)C==="*"?(f(),gt()):C==="/"?(Lt(n.defs.tos,G),f(),gt(),g.push(s.inverse(g.pop()))):ht()===n.dotprod_unicode?(f(),T.push_symbol(n.INNER),g.swap(),gt(),d.list(3)):gt(),n.parse_time_simplifications&&(Yt(n.defs.tos,G),Lt(n.defs.tos,G));G===n.defs.tos?g.push(n.Constants.one):n.defs.tos-G>1&&(d.list(n.defs.tos-G),g.push(new n.Cons(n.symbol(n.MULTIPLY),g.pop())))}function Zt(){C==="^"&&(f(),T.push_symbol(n.POWER),g.swap(),gt(),d.list(3))}function ft(G){for(f(),T.push_symbol(n.INDEX),g.swap(),At();C===",";)f(),At();C!=="]"&&rt("] expected"),f(),d.list(n.defs.tos-G)}function gt(){let G=n.defs.tos,st=!1;for(C==="("?vt():C===u?rr():C===_?Ot():C==="["?P():C===a?(st=!0,o.bignum_scan_integer(S),f()):C===p?(st=!0,o.bignum_scan_float(S),f()):C===A?nt():rt("syntax error");C==="["||C==="("&&et===0&&!st;)C==="["?ft(G):C==="("&&w();for(;C==="!";)f(),T.push_symbol(n.FACTORIAL),g.swap(),d.list(2);for(;ht()===n.transpose_unicode;)f(),T.push_symbol(n.TRANSPOSE),g.swap(),d.list(2);Zt()}function Pt(G){if(n.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(G)===-1&&Z.indexOf(G)===-1&&Z.indexOf("'"+G)===-1&&!N){n.DEBUG&&console.log(`... adding symbol: ${G} to the set of the symbols right of assignment`);let st="";for(let tt=1;tt<h.length;tt++)h[tt]!==""&&(st+=h[tt]+"_"+tt+"_");G=st+G,Z.push(G)}}function kt(G){if(n.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(G)===-1&&F.indexOf(G)===-1&&F.indexOf("'"+G)===-1&&!N){n.DEBUG&&console.log(`... adding symbol: ${G} to the set of the symbols left of assignment`);let st="";for(let tt=1;tt<h.length;tt++)h[tt]!==""&&(st+=h[tt]+"_"+tt+"_");G=st+G,F.push(G)}}function rr(){if(C!==u&&rt("symbol expected"),lt&&typeof S=="string"&&S.length===1)switch(S[0]){case"a":g.push(n.symbol(n.METAA));break;case"b":g.push(n.symbol(n.METAB));break;case"x":g.push(n.symbol(n.METAX));break;default:g.push(T.usr_symbol(S))}else g.push(T.usr_symbol(S));R.length===0?(n.DEBUG&&console.log(`out of scanning parameters, processing ${S}`),D=S,Q&&kt(S)):(n.DEBUG&&console.log(`still scanning parameters, skipping ${S}`),Q&&Pt("'"+S)),n.DEBUG&&console.log(`found symbol: ${S} left of assignment: ${Q}`),Q||Pt(S),f()}function nt(){y.new_string(S),f()}function Ot(){n.DEBUG&&console.log("-- scan_function_call_with_function_name start");let G=1,st=T.usr_symbol(S);g.push(st);let tt=S;if((tt==="roots"||tt==="defint"||tt==="sum"||tt==="product"||tt==="for")&&h.push(S),D=S,Q||Pt(S),f(),f(),R.push(!0),C!==")"){for(pt(),G++;C===",";)f(),G===2&&h[h.length-1].indexOf("roots")!==-1&&(Z=Z.filter(Y=>!new RegExp("roots_"+(h.length-1)+"_"+S).test(Y)),N=!0),G===2&&h[h.length-1].indexOf("sum")!==-1&&(Z=Z.filter(Y=>!new RegExp("sum_"+(h.length-1)+"_"+S).test(Y)),N=!0),G===2&&h[h.length-1].indexOf("product")!==-1&&(Z=Z.filter(Y=>!new RegExp("product_"+(h.length-1)+"_"+S).test(Y)),N=!0),G===2&&h[h.length-1].indexOf("for")!==-1&&(Z=Z.filter(Y=>!new RegExp("for_"+(h.length-1)+"_"+S).test(Y)),N=!0),h[h.length-1].indexOf("defint")!==-1&&(G===2||G>2&&(G-2)%3==0)&&(Z=Z.filter(Y=>!new RegExp("defint_"+(h.length-1)+"_"+S).test(Y)),N=!0),pt(),N=!1,G++;G===2&&h[h.length-1].indexOf("roots")!==-1&&(Z=Z.filter(Y=>!new RegExp("roots_"+(h.length-1)+"_x").test(Y)))}R.pop();for(let Y=0;Y<=Z.length;Y++)Z[Y]!=null&&(tt==="roots"&&(Z[Y]=Z[Y].replace(new RegExp("roots_"+(h.length-1)+"_"),"")),tt==="defint"&&(Z[Y]=Z[Y].replace(new RegExp("defint_"+(h.length-1)+"_"),"")),tt==="sum"&&(Z[Y]=Z[Y].replace(new RegExp("sum_"+(h.length-1)+"_"),"")),tt==="product"&&(Z[Y]=Z[Y].replace(new RegExp("product_"+(h.length-1)+"_"),"")),tt==="for"&&(Z[Y]=Z[Y].replace(new RegExp("for_"+(h.length-1)+"_"),"")));C!==")"&&rt(") expected"),f(),d.list(G),(tt==="roots"||tt==="defint"||tt==="sum"||tt==="product"||tt==="for")&&h.pop(),tt===n.symbol(n.PATTERN).printname&&(n.defs.patternHasBeenFound=!0),n.DEBUG&&console.log("-- scan_function_call_with_function_name end")}function w(){n.DEBUG&&console.log("-- scan_function_call_without_function_name start"),T.push_symbol(n.EVAL),g.swap(),d.list(2);let G=1;if(f(),R.push(!0),C!==")")for(pt(),G++;C===",";)f(),pt(),G++;R.pop(),C!==")"&&rt(") expected"),f(),d.list(G),n.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${g.top()}`)}function vt(){let G=0;C!=="("&&rt("( expected"),f(),pt(),C!==")"&&rt(") expected"),f()}function P(){C!=="["&&rt("[ expected"),f(),pt();let G=1;for(;C===",";)f(),pt(),G++;W(G),C!=="]"&&rt("] expected"),f()}function rt(G){for(n.defs.errorMessage="";H!==U&&!((B[H]===`
`||B[H]==="\r")&&H+1===U);)n.defs.errorMessage+=B[H++];for(n.defs.errorMessage+=" ? ";B[H]&&B[H]!==`
`&&B[H]!=="\r";)n.defs.errorMessage+=B[H++];n.defs.errorMessage+=`
`,E.stop(G)}function W(G){let st=t.alloc_tensor(G);st.tensor.ndim=1,st.tensor.dim[0]=G;for(let tt=0;tt<G;tt++)st.tensor.elem[tt]=n.defs.stack[n.defs.tos-G+tt];i.check_tensor_dimensions(st),g.moveTos(n.defs.tos-G),g.push(st)}function f(){for(et=0;L(),C===b;)et=1;n.DEBUG&&console.log(`get_next_token token: ${C}`)}function L(){for(;e.isspace(B[U]);){if(B[U]===`
`||B[U]==="\r"){C=b,U++;return}U++}if(v=U,U===B.length){C="";return}if(e.isdigit(B[U])||B[U]==="."){for(;e.isdigit(B[U]);)U++;if(B[U]==="."){for(U++;e.isdigit(B[U]);)U++;if(B[U]==="e"&&(B[U+1]==="+"||B[U+1]==="-"||e.isdigit(B[U+1])))for(U+=2;e.isdigit(B[U]);)U++;C=p}else C=a;V(v,U);return}if(e.isalpha(B[U])){for(;e.isalnumorunderscore(B[U]);)U++;B[U]==="("?C=_:C=u,V(v,U);return}if(B[U]==='"'){for(U++;B[U]!=='"';)U===B.length-1&&(U++,rt("runaway string"),U--),U++;U++,C=A,V(v+1,U-1);return}if(B[U]==="#"||B[U]==="-"&&B[U+1]==="-"){for(;B[U]&&B[U]!==`
`&&B[U]!=="\r";)U++;B[U]&&U++,C=b;return}if(B[U]===":"&&B[U+1]==="="){U+=2,C=O;return}if(B[U]==="="&&B[U+1]==="="){U+=2,C=j;return}if(B[U]==="!"&&B[U+1]==="="){U+=2,C=q;return}if(B[U]==="<"&&B[U+1]==="="){U+=2,C=M;return}if(B[U]===">"&&B[U+1]==="="){U+=2,C=x;return}C=B[U++]}function V(G,st){S=B.substring(G,st)}}),Ir=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.print_list=r.print_expr=r.printline=r.collectLatexStringFromReturnValue=r.print_str=r.Eval_printlist=r.Eval_printhuman=r.Eval_printlatex=r.Eval_printcomputer=r.Eval_print2dascii=r.Eval_print=void 0;var t=xt(),n=Mt(),e=Kt(),E=Ht(),g=Nr(),T=Nt(),y=Lr(),o=Tt(),l=wt(),d=qt(),s=qr(),i=Ue(),a=Ur(),p="^";function u(I){t.defs.stringsEmittedByUserPrintouts+=j(t.cdr(I),t.defs.printMode),n.push(t.symbol(t.NIL))}r.Eval_print=u;function _(I){t.defs.stringsEmittedByUserPrintouts+=j(t.cdr(I),t.PRINTMODE_2DASCII),n.push(t.symbol(t.NIL))}r.Eval_print2dascii=_;function b(I){t.defs.stringsEmittedByUserPrintouts+=j(t.cdr(I),t.PRINTMODE_COMPUTER),n.push(t.symbol(t.NIL))}r.Eval_printcomputer=b;function A(I){t.defs.stringsEmittedByUserPrintouts+=j(t.cdr(I),t.PRINTMODE_LATEX),n.push(t.symbol(t.NIL))}r.Eval_printlatex=A;function x(I){let k=t.defs.test_flag;t.defs.test_flag=!1,t.defs.stringsEmittedByUserPrintouts+=j(t.cdr(I),t.PRINTMODE_HUMAN),t.defs.test_flag=k,n.push(t.symbol(t.NIL))}r.Eval_printhuman=x;function M(I){let k=j(t.cdr(I),t.PRINTMODE_LIST);t.defs.stringsEmittedByUserPrintouts+=k,n.push(t.symbol(t.NIL))}r.Eval_printlist=M;function j(I,k){let bt="";for(;t.iscons(I);){let at=o.Eval(t.car(I)),jt=t.defs.printMode;k===t.PRINTMODE_COMPUTER?(t.defs.printMode=t.PRINTMODE_COMPUTER,bt=lt(at),q(bt,t.LAST_FULL_PRINT)):k===t.PRINTMODE_HUMAN?(t.defs.printMode=t.PRINTMODE_HUMAN,bt=lt(at),q(bt,t.LAST_PLAIN_PRINT)):k===t.PRINTMODE_2DASCII?(t.defs.printMode=t.PRINTMODE_2DASCII,bt=i.print2dascii(at),q(bt,t.LAST_2DASCII_PRINT)):k===t.PRINTMODE_LATEX?(t.defs.printMode=t.PRINTMODE_LATEX,bt=lt(at),q(bt,t.LAST_LATEX_PRINT)):k===t.PRINTMODE_LIST&&(t.defs.printMode=t.PRINTMODE_LIST,bt=Ut(at),q(bt,t.LAST_LIST_PRINT)),t.defs.printMode=jt,I=t.cdr(I)}return t.DEBUG&&console.log(`emttedString from display: ${t.defs.stringsEmittedByUserPrintouts}`),bt}function q(I,k){a.scan('"'+I+'"');let bt=n.pop();e.set_binding(t.symbol(k),bt)}function O(I){return t.DEBUG&&console.log(`emttedString from print_str: ${t.defs.stringsEmittedByUserPrintouts}`),I}r.print_str=O;function C(I){return I}function et(I){let k=t.defs.printMode;t.defs.printMode=t.PRINTMODE_LATEX;let bt=t.defs.codeGen;t.defs.codeGen=!1;let at=D(I);return at=at.replace(/_/g,"\\_"),t.defs.printMode=k,t.defs.codeGen=bt,t.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${t.defs.stringsEmittedByUserPrintouts}`),at}r.collectLatexStringFromReturnValue=et;function lt(I){let k="";return k+=D(I),k}r.printline=lt;function H(I){let k="";return l.isfraction(I)||t.isadd(I)||t.ismultiply(I)||t.ispower(I)||E.lessp(I,t.Constants.zero)?(k+="(",k+=D(I),k+=")"):k+=D(I),k}function U(I){let k="";return l.isfraction(I)||t.isadd(I)||t.ismultiply(I)||t.ispower(I)?(k+="(",k+=D(I),k+=")"):k+=D(I),k}function v(I,k){let bt="",at=t.cadr(I),jt=t.caddr(I);return l.isminusone(jt)?(bt+=H(at),bt):(k===1&&(bt+="("),jt=d.negate(jt),bt+=yt(at,jt),k===1&&(bt+=")"),bt)}function S(I){let k,bt,at="",jt=0,Vt=0,mr=0,sr=t.cdr(I),br=t.car(sr);for(t.isrational(br)?(k=g.absval(T.mp_numerator(br)),bt=T.mp_denominator(br),l.isplusone(k)||Vt++,l.isplusone(bt)||mr++,sr=t.cdr(sr)):(k=t.Constants.one,bt=t.Constants.one);t.iscons(sr);)br=t.car(sr),Qt(br)?mr++:Vt++,sr=t.cdr(sr);if(t.defs.printMode===t.PRINTMODE_LATEX&&(at+=O("\\frac{")),Vt===0)at+="1";else for(jt=0,sr=t.cdr(I),t.isrational(t.car(sr))&&(sr=t.cdr(sr)),l.isplusone(k)||(at+=Xt(k),jt=1);t.iscons(sr);)br=t.car(sr),Qt(br)||(jt&&(at+=Gt()),at+=Xt(br),jt=1),sr=t.cdr(sr);for(t.defs.printMode===t.PRINTMODE_LATEX?at+=O("}{"):t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?at+=O(" / "):at+=O("/"),mr>1&&t.defs.printMode!==t.PRINTMODE_LATEX&&(at+="("),jt=0,sr=t.cdr(I),t.isrational(t.car(sr))&&(sr=t.cdr(sr)),l.isplusone(bt)||(at+=Xt(bt),jt=1);t.iscons(sr);)br=t.car(sr),Qt(br)&&(jt&&(at+=Gt()),at+=v(br,mr),jt=1),sr=t.cdr(sr);return mr>1&&t.defs.printMode!==t.PRINTMODE_LATEX&&(at+=")"),t.defs.printMode===t.PRINTMODE_LATEX&&(at+=O("}")),at}function D(I){let k="";if(t.isadd(I))for(I=t.cdr(I),Z(t.car(I))==="-"&&(k+=O("-")),k+=F(t.car(I)),I=t.cdr(I);t.iscons(I);)Z(t.car(I))==="+"?t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?k+=O(" + "):k+=O("+"):t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?k+=O(" - "):k+=O("-"),k+=F(t.car(I)),I=t.cdr(I);else Z(I)==="-"&&(k+=O("-")),k+=F(I);return k}r.print_expr=D;function Z(I){let k="";return t.ismultiply(I)&&t.isNumericAtom(t.cadr(I))&&E.lessp(t.cadr(I),t.Constants.zero)||t.isNumericAtom(I)&&E.lessp(I,t.Constants.zero)?k+="-":k+="+",k}function F(I){let k="";if(t.ismultiply(I)&&er(I))return k+=S(I),k;if(t.ismultiply(I)){let bt,at;I=t.cdr(I),l.isminusone(t.car(I))&&(I=t.cdr(I));let jt=!1;t.isNumericAtom(t.car(I))&&(jt=!0);let Vt=!1;for(t.defs.printMode===t.PRINTMODE_LATEX&&t.iscons(t.cdr(I))&&l.isNumberOneOverSomething(t.car(I))&&(Vt=!0,bt=t.car(I).q.b.toString()),Vt?(at=k,k=""):k+=Xt(t.car(I)),I=t.cdr(I);t.iscons(I);)t.defs.printMode===t.PRINTMODE_LATEX&&jt&&t.caar(I)===t.symbol(t.POWER)&&t.isNumericAtom(t.car(t.cdr(t.car(I))))&&(l.isfraction(t.car(t.cdr(t.cdr(t.car(I)))))||(k+=" \\cdot ")),k+=Gt(),k+=Xt(t.car(I),!1,!0),jt=!1,t.isNumericAtom(t.car(I))&&(jt=!0),I=t.cdr(I);Vt&&(k=at+"\\frac{"+k+"}{"+bt+"}")}else k+=Xt(I);return k}function Q(I){let k="";return k+="(",k+=D(I),k+=")",k}function R(I){let k="";return I=t.cadr(I),l.isfraction(I)||t.isadd(I)||t.ismultiply(I)||t.ispower(I)||t.isfactorial(I)?k+=Q(I):k+=D(I),k+="!",k}function h(I){let k="";return k+=O("\\left |"),k+=D(t.cadr(I)),k+=O(" \\right |"),k}function N(I){let k="";return k+=O("\\binom{"),k+=D(t.cadr(I)),k+=O("}{"),k+=D(t.caddr(I)),k+=O("} "),k}function $(I){let k="";return k+=D(t.cadr(I)),k+=O(" \\cdot "),k+=D(t.caddr(I)),k}function B(I){let k="dot(";return k+=D(t.cadr(I)),k+=", ",k+=D(t.caddr(I)),k+=")",k}function X(I){let k="Math.sin(";return k+=D(t.cadr(I)),k+=")",k}function J(I){let k="Math.cos(";return k+=D(t.cadr(I)),k+=")",k}function pt(I){let k="Math.tan(";return k+=D(t.cadr(I)),k+=")",k}function _t(I){let k="Math.asin(";return k+=D(t.cadr(I)),k+=")",k}function At(I){let k="Math.acos(";return k+=D(t.cadr(I)),k+=")",k}function ht(I){let k="Math.atan(";return k+=D(t.cadr(I)),k+=")",k}function It(I){let k="";return k+=O("\\sqrt{"),k+=D(t.cadr(I)),k+=O("} "),k}function Lt(I){let k="";return k+=O("{"),t.iscons(t.cadr(I))&&(k+=O("(")),k+=D(t.cadr(I)),t.iscons(t.cadr(I))&&(k+=O(")")),k+=O("}"),k+=O("^T"),k}function Yt(I){let k="";return k+=O("transpose("),k+=D(t.cadr(I)),k+=O(")"),k}function Bt(I){let k="";return k+=O("identity("),k+=D(t.cadr(I)),k+=O(")"),k}function Zt(I){let k="";return k+=O("{"),t.iscons(t.cadr(I))&&(k+=O("(")),k+=D(t.cadr(I)),t.iscons(t.cadr(I))&&(k+=O(")")),k+=O("}"),k+=O("^{-1}"),k}function ft(I){let k="";return k+=O("inv("),k+=D(t.cadr(I)),k+=O(")"),k}function gt(I){let k="",bt=t.car(t.cdr(I));I=t.cdr(I);let at=I,jt=0;for(;t.iscons(t.cdr(t.cdr(I)));){jt++;let Vt=t.cdr(t.cdr(I));k+=O("\\int^{"),k+=D(t.car(t.cdr(Vt))),k+=O("}_{"),k+=D(t.car(Vt)),k+=O("} \\! "),I=t.cdr(Vt)}k+=D(bt),k+=O(" \\,"),I=at;for(let Vt=1;Vt<=jt;Vt++){let mr=t.cdr(I);k+=O(" \\mathrm{d} "),k+=D(t.car(mr)),Vt<jt&&(k+=O(" \\, ")),I=t.cdr(t.cdr(mr))}return k}function Pt(I){let k="";return k+=kt(I,0,0)[1],k}function kt(I,k,bt){let at="";if(at+=O("["),k<I.tensor.ndim-1)for(let jt=0;jt<I.tensor.dim[k];jt++){let Vt;[bt,Vt]=Array.from(kt(I,k+1,bt)),at+=Vt,jt!==I.tensor.dim[k]-1&&(at+=O(","))}else for(let jt=0;jt<I.tensor.dim[k];jt++)at+=D(I.tensor.elem[bt]),jt!==I.tensor.dim[k]-1&&(at+=O(",")),bt++;return at+=O("]"),[bt,at]}function rr(I){let k="";return I.tensor.ndim<=2&&(k+=nt(!0,I,0,0)[1]),k}function nt(I,k,bt,at){let jt="";if(I&&(jt+="\\begin{bmatrix} "),bt<k.tensor.ndim-1)for(let Vt=0;Vt<k.tensor.dim[bt];Vt++){let mr;[at,mr]=Array.from(nt(!1,k,bt+1,at)),jt+=mr,Vt!==k.tensor.dim[bt]-1&&(jt+=O(" \\\\ "))}else for(let Vt=0;Vt<k.tensor.dim[bt];Vt++)jt+=D(k.tensor.elem[at]),Vt!==k.tensor.dim[bt]-1&&(jt+=O(" & ")),at++;return I&&(jt+=" \\end{bmatrix}"),[at,jt]}function Ot(I){let k="\\sum_{";return k+=D(t.caddr(I)),k+="=",k+=D(t.cadddr(I)),k+="}^{",k+=D(t.caddddr(I)),k+="}{",k+=D(t.cadr(I)),k+="}",k}function w(I){let k=t.cadr(I),bt=t.caddr(I),at=t.cadddr(I),jt=t.caddddr(I);return"(function(){ var "+bt+";  var holderSum = 0;  var lowerlimit = "+D(at)+";  var upperlimit = "+D(jt)+";  for ("+bt+" = lowerlimit; "+bt+" < upperlimit; "+bt+"++) {    holderSum += "+D(k)+"; }  return holderSum;})()"}function vt(I){let k="\\left\\{ \\begin{array}{ll}";for(I=t.cdr(I);t.iscons(I);){if(t.cdr(I)===t.symbol(t.NIL)){k+="{",k+=D(t.car(I)),k+="} & otherwise ",k+=" \\\\\\\\";break}k+="{",k+=D(t.cadr(I)),k+="} & if & ",k+=D(t.car(I)),k+=" \\\\\\\\",I=t.cddr(I)}return k=k.substring(0,k.length-4),k+="\\end{array} \\right."}function P(I){let k="(function(){";I=t.cdr(I);let bt=0;for(;t.iscons(I);){if(t.cdr(I)===t.symbol(t.NIL)){k+="else {",k+="return ("+D(t.car(I))+");",k+="}";break}bt&&(k+=" else "),k+="if ("+D(t.car(I))+"){",k+="return ("+D(t.cadr(I))+");",k+="}",bt++,I=t.cddr(I)}return k+="})()",k}function rt(I){let k="{";return k+=D(t.cadr(I)),k+="}",k+=" < ",k+="{",k+=D(t.caddr(I)),k+="}"}function W(I){let k="{";return k+=D(t.cadr(I)),k+="}",k+=" \\leq ",k+="{",k+=D(t.caddr(I)),k+="}"}function f(I){let k="{";return k+=D(t.cadr(I)),k+="}",k+=" > ",k+="{",k+=D(t.caddr(I)),k+="}"}function L(I){let k="{";return k+=D(t.cadr(I)),k+="}",k+=" \\geq ",k+="{",k+=D(t.caddr(I)),k+="}"}function V(I){let k="{";return k+=D(t.cadr(I)),k+="}",k+=" = ",k+="{",k+=D(t.caddr(I)),k+="}"}function G(I){let k=t.cadr(I),bt=t.caddr(I),at=t.cadddr(I),jt=t.caddddr(I);return"(function(){ var "+bt+";  var lowerlimit = "+D(at)+";  var upperlimit = "+D(jt)+";  for ("+bt+" = lowerlimit; "+bt+" < upperlimit; "+bt+"++) {    "+D(k)+" } })()"}function st(I){let k="";for(I=t.cdr(I);t.iscons(I);)k+=D(t.car(I)),I=t.cdr(I);return k}function tt(I){let k="";return k+=D(t.cadr(I)),k+=" = ",k+=D(t.caddr(I)),k+="; ",k}function Y(I){let k="\\prod_{";return k+=D(t.caddr(I)),k+="=",k+=D(t.cadddr(I)),k+="}^{",k+=D(t.caddddr(I)),k+="}{",k+=D(t.cadr(I)),k+="}",k}function ct(I){let k=t.cadr(I),bt=t.caddr(I),at=t.cadddr(I),jt=t.caddddr(I);return"(function(){ var "+bt+";  var holderProduct = 1;  var lowerlimit = "+D(at)+";  var upperlimit = "+D(jt)+";  for ("+bt+" = lowerlimit; "+bt+" < upperlimit; "+bt+"++) {    holderProduct *= "+D(k)+"; }  return holderProduct;})()"}function yt(I,k){let bt="";if(t.DEBUG&&console.log("power base: "+I+"  exponent: "+k),l.isoneovertwo(k))if(l.equaln(I,2)){if(t.defs.codeGen)return bt+=O("Math.SQRT2"),bt}else{if(t.defs.printMode===t.PRINTMODE_LATEX)return bt+=O("\\sqrt{"),bt+=D(I),bt+=O("}"),bt;if(t.defs.codeGen)return bt+=O("Math.sqrt("),bt+=D(I),bt+=O(")"),bt}if(l.equaln(e.get_binding(t.symbol(t.PRINT_LEAVE_E_ALONE)),1)&&I===t.symbol(t.E))return t.defs.codeGen?(bt+=O("Math.exp("),bt+=U(k),bt+=O(")"),bt):(t.defs.printMode===t.PRINTMODE_LATEX?(bt+=O("e^{"),bt+=D(k),bt+=O("}")):(bt+=O("exp("),bt+=D(k),bt+=O(")")),bt);if(t.defs.codeGen)return bt+=O("Math.pow("),bt+=H(I),bt+=O(", "),bt+=U(k),bt+=O(")"),bt;if(l.equaln(e.get_binding(t.symbol(t.PRINT_LEAVE_X_ALONE)),0)||I.printname!=="x"){if(I!==t.symbol(t.E)){if(l.isminusone(k))return t.defs.printMode===t.PRINTMODE_LATEX?bt+=O("\\frac{1}{"):t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?bt+=O("1 / "):bt+=O("1/"),t.iscons(I)&&t.defs.printMode!==t.PRINTMODE_LATEX?(bt+=O("("),bt+=D(I),bt+=O(")")):bt+=D(I),t.defs.printMode===t.PRINTMODE_LATEX&&(bt+=O("}")),bt;if(l.isnegativeterm(k)){t.defs.printMode===t.PRINTMODE_LATEX?bt+=O("\\frac{1}{"):t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?bt+=O("1 / "):bt+=O("1/");let at=d.multiply(k,t.Constants.negOne);return t.iscons(I)&&t.defs.printMode!==t.PRINTMODE_LATEX?(bt+=O("("),bt+=yt(I,at),bt+=O(")")):bt+=yt(I,at),t.defs.printMode===t.PRINTMODE_LATEX&&(bt+=O("}")),bt}}if(l.isfraction(k)&&t.defs.printMode===t.PRINTMODE_LATEX){bt+=O("\\sqrt");let at=y.denominator(k);return l.isplustwo(at)||(bt+=O("["),bt+=D(at),bt+=O("]")),bt+=O("{"),k=s.numerator(k),bt+=yt(I,k),bt+=O("}"),bt}}return t.defs.printMode===t.PRINTMODE_LATEX&&l.isplusone(k)?bt+=D(I):(t.isadd(I)||l.isnegativenumber(I)?(bt+=O("("),bt+=D(I),bt+=O(")")):t.ismultiply(I)||t.ispower(I)?(t.defs.printMode!==t.PRINTMODE_LATEX&&(bt+=O("(")),bt+=Xt(I,!0),t.defs.printMode!==t.PRINTMODE_LATEX&&(bt+=O(")"))):t.isNumericAtom(I)&&(E.lessp(I,t.Constants.zero)||l.isfraction(I))?(bt+=O("("),bt+=Xt(I),bt+=O(")")):bt+=Xt(I),t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?bt+=O(p):bt+=O("^"),t.defs.printMode===t.PRINTMODE_LATEX?D(k).length>1?(bt+=O("{"),bt+=D(k),bt+=O("}")):bt+=D(k):t.iscons(k)||l.isfraction(k)||t.isNumericAtom(k)&&E.lessp(k,t.Constants.zero)?(bt+=O("("),bt+=D(k),bt+=O(")")):bt+=Xt(k)),bt}function Ct(I){let k="";if(I=t.cdr(I),t.caar(I)===t.symbol(t.ADD)||t.caar(I)===t.symbol(t.MULTIPLY)||t.caar(I)===t.symbol(t.POWER)||t.caar(I)===t.symbol(t.FACTORIAL)?k+=Q(t.car(I)):k+=D(t.car(I)),k+=O("["),I=t.cdr(I),t.iscons(I))for(k+=D(t.car(I)),I=t.cdr(I);t.iscons(I);)k+=O(","),k+=D(t.car(I)),I=t.cdr(I);return k+=O("]"),k}function Xt(I,k=!1,bt=!1){let at="";if(t.isNumericAtom(I))return bt&&E.lessp(I,t.Constants.zero)&&(at+="("),at+=T.print_number(I,bt),bt&&E.lessp(I,t.Constants.zero)&&(at+=")"),at;if(t.isstr(I))return at+=O('"'),at+=O(I.str),at+=O('"'),at;if(t.istensor(I))return t.defs.printMode===t.PRINTMODE_LATEX?at+=rr(I):at+=Pt(I),at;if(t.ismultiply(I))return k||(Z(I)==="-"||t.defs.printMode!==t.PRINTMODE_LATEX)&&(t.defs.printMode===t.PRINTMODE_LATEX?at+=O(" \\left ("):at+=O("(")),at+=D(I),k||(Z(I)==="-"||t.defs.printMode!==t.PRINTMODE_LATEX)&&(t.defs.printMode===t.PRINTMODE_LATEX?at+=O(" \\right ) "):at+=O(")")),at;if(t.isadd(I))return k||(at+=O("(")),at+=D(I),k||(at+=O(")")),at;if(t.ispower(I)){let jt=t.cadr(I),Vt=t.caddr(I);return at+=yt(jt,Vt),at}if(t.car(I)===t.symbol(t.FUNCTION)){let jt=t.cadr(I);if(!t.defs.codeGen){let Vt=t.caddr(I);at+=O("function "),t.DEBUG&&console.log(`emittedString from print_factor ${t.defs.stringsEmittedByUserPrintouts}`),at+=Ut(Vt),at+=O(" -> ")}return at+=D(jt),at}if(t.car(I)===t.symbol(t.PATTERN))return at+=D(t.caadr(I)),t.defs.printMode===t.PRINTMODE_LATEX?at+=O(" \\rightarrow "):t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag?at+=O(" -> "):at+=O("->"),at+=D(t.car(t.cdr(t.cadr(I)))),at;if(t.car(I)===t.symbol(t.INDEX)&&t.issymbol(t.cadr(I)))return at+=Ct(I),at;if(t.isfactorial(I))return at+=R(I),at;if(t.car(I)===t.symbol(t.ABS)&&t.defs.printMode===t.PRINTMODE_LATEX)return at+=h(I),at;if(t.car(I)===t.symbol(t.SQRT)&&t.defs.printMode===t.PRINTMODE_LATEX)return at+=It(I),at;if(t.isfactorial(I)){if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=Lt(I),at;if(t.defs.codeGen)return at+=Yt(I),at}else if(t.car(I)===t.symbol(t.UNIT)){if(t.defs.codeGen)return at+=Bt(I),at}else if(t.isinv(I)){if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=Zt(I),at;if(t.defs.codeGen)return at+=ft(I),at}else{if(t.car(I)===t.symbol(t.BINOMIAL)&&t.defs.printMode===t.PRINTMODE_LATEX)return at+=N(I),at;if(t.car(I)===t.symbol(t.DEFINT)&&t.defs.printMode===t.PRINTMODE_LATEX)return at+=gt(I),at;if(t.isinnerordot(I)){if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=$(I),at;if(t.defs.codeGen)return at+=B(I),at}else if(t.car(I)===t.symbol(t.SIN)){if(t.defs.codeGen)return at+=X(I),at}else if(t.car(I)===t.symbol(t.COS)){if(t.defs.codeGen)return at+=J(I),at}else if(t.car(I)===t.symbol(t.TAN)){if(t.defs.codeGen)return at+=pt(I),at}else if(t.car(I)===t.symbol(t.ARCSIN)){if(t.defs.codeGen)return at+=_t(I),at}else if(t.car(I)===t.symbol(t.ARCCOS)){if(t.defs.codeGen)return at+=At(I),at}else if(t.car(I)===t.symbol(t.ARCTAN)){if(t.defs.codeGen)return at+=ht(I),at}else if(t.car(I)===t.symbol(t.SUM)){if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=Ot(I),at;if(t.defs.codeGen)return at+=w(I),at}else if(t.car(I)===t.symbol(t.PRODUCT)){if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=Y(I),at;if(t.defs.codeGen)return at+=ct(I),at}else if(t.car(I)===t.symbol(t.FOR)){if(t.defs.codeGen)return at+=G(I),at}else if(t.car(I)===t.symbol(t.DO)){if(t.defs.codeGen)return at+=st(I),at}else if(t.car(I)===t.symbol(t.TEST)){if(t.defs.codeGen)return at+=P(I),at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=vt(I),at}else if(t.car(I)===t.symbol(t.TESTLT)){if(t.defs.codeGen)return at+="(("+D(t.cadr(I))+") < ("+D(t.caddr(I))+"))",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=rt(I),at}else if(t.car(I)===t.symbol(t.TESTLE)){if(t.defs.codeGen)return at+="(("+D(t.cadr(I))+") <= ("+D(t.caddr(I))+"))",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=W(I),at}else if(t.car(I)===t.symbol(t.TESTGT)){if(t.defs.codeGen)return at+="(("+D(t.cadr(I))+") > ("+D(t.caddr(I))+"))",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=f(I),at}else if(t.car(I)===t.symbol(t.TESTGE)){if(t.defs.codeGen)return at+="(("+D(t.cadr(I))+") >= ("+D(t.caddr(I))+"))",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=L(I),at}else if(t.car(I)===t.symbol(t.TESTEQ)){if(t.defs.codeGen)return at+="(("+D(t.cadr(I))+") === ("+D(t.caddr(I))+"))",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=V(I),at}else if(t.car(I)===t.symbol(t.FLOOR)){if(t.defs.codeGen)return at+="Math.floor("+D(t.cadr(I))+")",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=" \\lfloor {"+D(t.cadr(I))+"} \\rfloor ",at}else if(t.car(I)===t.symbol(t.CEILING)){if(t.defs.codeGen)return at+="Math.ceiling("+D(t.cadr(I))+")",at;if(t.defs.printMode===t.PRINTMODE_LATEX)return at+=" \\lceil {"+D(t.cadr(I))+"} \\rceil ",at}else if(t.car(I)===t.symbol(t.ROUND)){if(t.defs.codeGen)return at+="Math.round("+D(t.cadr(I))+")",at}else if(t.car(I)===t.symbol(t.SETQ))return t.defs.codeGen?(at+=tt(I),at):(at+=D(t.cadr(I)),at+=O("="),at+=D(t.caddr(I)),at)}if(t.iscons(I)){if(at+=Xt(t.car(I)),I=t.cdr(I),k||(at+=O("(")),t.iscons(I))for(at+=D(t.car(I)),I=t.cdr(I);t.iscons(I);)at+=O(","),at+=D(t.car(I)),I=t.cdr(I);return k||(at+=O(")")),at}return I===t.symbol(t.DERIVATIVE)?at+="d":I===t.symbol(t.E)?t.defs.codeGen?at+=O("Math.E"):at+=O("e"):I===t.symbol(t.PI)?t.defs.printMode===t.PRINTMODE_LATEX?at+=O("\\pi"):at+=O("pi"):at+=O(e.get_printname(I)),at}function Ut(I){let k="";switch(I.k){case t.CONS:for(k+="(",k+=Ut(t.car(I)),I===t.cdr(I)&&(console.log("oh no recursive!"),t.breakpoint),I=t.cdr(I);t.iscons(I);)k+=" ",k+=Ut(t.car(I)),I=t.cdr(I),I===t.cdr(I)&&I!==t.symbol(t.NIL)&&(console.log("oh no recursive!"),t.breakpoint);I!==t.symbol(t.NIL)&&(k+=" . ",k+=Ut(I)),k+=")";break;case t.STR:k+=I.str;break;case t.NUM:case t.DOUBLE:k+=T.print_number(I,!0);break;case t.SYM:k+=e.get_printname(I);break;default:k+="<tensor>"}return k}r.print_list=Ut;function Gt(){let I="";return t.defs.printMode===t.PRINTMODE_LATEX||(t.defs.printMode===t.PRINTMODE_HUMAN&&!t.defs.test_flag&&!t.defs.codeGen?I+=O(" "):I+=O("*")),I}function Qt(I){return t.ispower(I)&&t.cadr(I)!==t.symbol(t.E)&&l.isnegativeterm(t.caddr(I))}function er(I){for(I=t.cdr(I);t.iscons(I);){let k=t.car(I);if(Qt(k))return!0;I=t.cdr(I)}return!1}}),he=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.divpoly=r.Eval_quotient=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Xr(),T=Tt(),y=qt(),o=ir();function l(s){let i=T.Eval(t.cadr(s)),a=T.Eval(t.caddr(s)),p=T.Eval(t.cadddr(s));p===t.symbol(t.NIL)&&(p=t.symbol(t.SYMBOL_X)),n.push(d(i,a,p))}r.Eval_quotient=l;function d(s,i,a){let p=g.coeff(s,a),u=p.length-1,_=g.coeff(i,a),b=_.length-1,A=u-b,x=t.Constants.zero;for(;A>=0;){let M=y.divide(p[u],_[b]);for(let j=0;j<=b;j++)p[A+j]=e.subtract(p[A+j],y.multiply(_[j],M));x=e.add(x,y.multiply(M,o.power(a,E.integer(A)))),u--,A--}return x}r.divpoly=d}),wr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rect=r.Eval_rect=void 0;var t=xt(),n=fr(),e=Mt(),E=Kt(),g=Nr(),T=Ft(),y=Qr(),o=kr(),l=Tt(),d=wt(),s=St(),i=qt(),a=pr(),p=!1;function u(b){let A=_(l.Eval(t.cadr(b)));e.push(A)}r.Eval_rect=u;function _(b){let A=b;if(p&&(console.log(`RECT of ${A}`),console.log(`any clock forms in : ${A} ? ${n.findPossibleClockForm(A,b)}`)),t.issymbol(b))return p&&console.log(` rect: simple symbol: ${A}`),d.isZeroAtomOrTensor(E.get_binding(t.symbol(t.ASSUME_REAL_VARIABLES)))?s.makeList(t.symbol(t.YYRECT),b):b;if(!d.isZeroAtomOrTensor(E.get_binding(t.symbol(t.ASSUME_REAL_VARIABLES)))&&!n.findPossibleExponentialForm(b)&&!n.findPossibleClockForm(b,b)&&!(n.Find(b,t.symbol(t.SIN))&&n.Find(b,t.symbol(t.COS))&&n.Find(b,t.Constants.imaginaryunit)))return p&&console.log(` rect: simple symbol: ${A}`),b;if(t.ismultiply(b)&&d.isimaginaryunit(t.cadr(b))&&!d.isZeroAtomOrTensor(E.get_binding(t.symbol(t.ASSUME_REAL_VARIABLES))))return b;if(t.isadd(b))return p&&console.log(` rect - ${A} is a sum `),b.tail().reduce((M,j)=>T.add(M,_(j)),t.Constants.zero);let x=i.multiply(g.abs(b),T.add(o.cosine(y.arg(b)),i.multiply(t.Constants.imaginaryunit,a.sine(y.arg(b)))));return p&&(console.log(` rect - ${A} is NOT a sum `),console.log(` rect - ${A} abs: ${g.abs(b)}`),console.log(` rect - ${A} arg of ${b} : ${b}`),console.log(` rect - ${A} cosine: ${o.cosine(y.arg(b))}`),console.log(` rect - ${A} sine: ${a.sine(y.arg(b))}`),console.log(` rect - ${A} i * sine: ${i.multiply(t.Constants.imaginaryunit,a.sine(y.arg(b)))}`),console.log(` rect - ${A} cos + i * sine: ${T.add(o.cosine(y.arg(b)),i.multiply(t.Constants.imaginaryunit,a.sine(y.arg(b))))}`),console.log(`rect of ${A} : ${x}`)),x}r.rect=_}),Wr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.factorpoly=void 0;var t=$e(),n=xt(),e=fr(),E=zt(),g=Mt(),T=Ht(),y=Ft(),o=Nt(),l=Xr(),d=ie(),s=zr(),i=Lr(),a=ke(),p=wt(),u=qt(),_=ir(),b=Ir(),A=he(),x=wr();function M(H,U){return!e.Find(H,U)||!p.ispolyexpandedform(H,U)||!n.issymbol(U)?H:j(H,U)}r.factorpoly=M;function j(H,U){let v,S,D,Z;p.isfloating(H)&&E.stop("floating point numbers in polynomial");let F=l.coeff(H,U),Q=F.length-1,R=q(F),h="real",N=null;for(;Q>0;){var $,B;if(p.isZeroAtomOrTensor(F[0])?(v=n.Constants.one,S=n.Constants.zero):h==="real"?[B,v,S]=O(F,Q,U,v,S):h==="complex"&&([$,v]=C(N,F,Q)),h==="real")if(B===!1){h="complex";continue}else{for(D=y.add(u.multiply(v,U),S),n.DEBUG&&console.log(`success
FACTOR=${D}`),R=u.multiply_noexpand(R,D),et(v,S,F,Q);Q&&p.isZeroAtomOrTensor(F[Q]);)Q--;let J=n.Constants.zero;for(let pt=0;pt<=Q;pt++)J=y.add(J,u.multiply(F[pt],_.power(U,o.integer(pt))));N=J}else if(h==="complex"){if($===!1)break;{let J=y.subtract(v,U),pt=y.subtract(s.conjugate(v),U);D=u.multiply(J,pt),n.DEBUG&&console.log(`success
FACTOR=${D}`);let _t=R;if(R=u.multiply_noexpand(R,D),N==null){let Yt=n.Constants.zero;for(let Bt=0;Bt<=Q;Bt++)Yt=y.add(Yt,u.multiply(F[Bt],_.power(U,o.integer(Bt))));N=Yt}let At=U,ht=D,It=N;N=A.divpoly(It,ht,At);let Lt=u.multiply(N,D);if(!T.equal(Lt,It)){n.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${_t} * ${It}`)),g.push(_t);let Yt=n.noexpand(d.yycondense,It),Bt=g.pop();return u.multiply_noexpand(Bt,Yt)}for(let Yt=0;Yt<=Q;Yt++)F.pop();F.push(...l.coeff(N,U)),Q-=2}}}let X=n.Constants.zero;for(let J=0;J<=Q;J++)X=y.add(X,u.multiply(F[J],_.power(U,o.integer(J))));return H=X,n.DEBUG&&console.log(`POLY=${H}`),H=n.noexpand(d.yycondense,H),Q>0&&p.isnegativeterm(F[Q])&&(H=u.negate(H),R=u.negate_noexpand(R)),R=u.multiply_noexpand(R,H),n.DEBUG&&console.log(`RESULT=${R}`),R}function q(H){let U=n.Constants.one;for(let v of H)U=t.lcm(i.denominator(v),U);for(let v=0;v<H.length;v++)H[v]=u.multiply(U,H[v]);return U=u.reciprocate(U),n.DEBUG&&console.log("rationalize_coefficients result"),U}function O(H,U,v,S,D){let Z,F,Q;if(n.DEBUG){let X=n.Constants.zero;for(let J=0;J<=U;J++)X=y.add(X,u.multiply(H[J],_.power(v,o.integer(J))));Z=X,console.log(`POLY=${Z}`)}let R=n.defs.tos,h=n.defs.tos;g.push_all(a.ydivisors(H[U]));let N=n.defs.tos-h,$=n.defs.tos;g.push_all(a.ydivisors(H[0]));let B=n.defs.tos-$;if(n.DEBUG){console.log("divisors of base term");for(let X=0;X<B;X++)console.log(`, ${n.defs.stack[$+X]}`);console.log("divisors of leading term");for(let X=0;X<N;X++)console.log(`, ${n.defs.stack[h+X]}`)}for(let X=0;X<N;X++)for(let J=0;J<B;J++){if(S=n.defs.stack[h+X],D=n.defs.stack[$+J],F=u.negate(u.divide(D,S)),[Q]=lt(F,H,U),n.DEBUG&&console.log(`try A=${S}
, B=${D}
, root ${v}
=-B/A=${F}
, POLY(${F}
)=${Q}`),p.isZeroAtomOrTensor(Q))return g.moveTos(R),n.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,S,D];if(D=u.negate(D),F=u.negate(F),[Q]=lt(F,H,U),n.DEBUG&&console.log(`try A=${S}
, B=${D}
, root ${v}
=-B/A=${F}
, POLY(${F}
)=${Q}`),p.isZeroAtomOrTensor(Q))return g.moveTos(R),n.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,S,D]}return g.moveTos(R),n.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,S,D]}function C(H,U,v){let S,D,Z,F;if(v<=2)return n.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,D];S=H,n.DEBUG&&console.log(`complex root finding for POLY=${S}`);let Q=n.defs.tos;if(D=x.rect(_.power(n.Constants.negOne,o.rational(2,3))),n.DEBUG&&console.log(`complex root finding: trying with ${D}`),Z=D,g.push(Z),[F]=lt(Z,U,v),n.DEBUG&&console.log(`complex root finding result: ${F}`),p.isZeroAtomOrTensor(F))return g.moveTos(Q),n.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,D];if(D=x.rect(_.power(n.Constants.one,o.rational(2,3))),n.DEBUG&&console.log(`complex root finding: trying with ${D}`),Z=D,g.push(Z),[F]=lt(Z,U,v),n.DEBUG&&console.log(`complex root finding result: ${F}`),p.isZeroAtomOrTensor(F))return g.moveTos(Q),n.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,D];for(let R=-10;R<=10;R++)for(let h=1;h<=5;h++){D=x.rect(y.add(o.integer(R),u.multiply(o.integer(h),n.Constants.imaginaryunit)));let N=D;g.push(N);let[$]=lt(N,U,v);if(p.isZeroAtomOrTensor($))return g.moveTos(Q),n.DEBUG&&console.log(`found complex root: ${$}`),[!0,D]}return g.moveTos(Q),n.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,D]}function et(H,U,v,S){let D=n.Constants.zero;for(let Z=S;Z>0;Z--){let F=u.divide(v[Z],H);v[Z]=D,D=F,v[Z-1]=y.subtract(v[Z-1],u.multiply(D,U))}v[0]=D,n.DEBUG&&console.log("yydivpoly Q:")}function lt(H,U,v){let S=n.Constants.zero;for(let D=v;D>=0;D--)n.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(b.print_list(S))),S=y.add(u.multiply(S,H),U[D]);return[S]}}),Er=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.guess=void 0;var t=xt(),n=fr();function e(E){return n.Find(E,t.symbol(t.SYMBOL_X))?t.symbol(t.SYMBOL_X):n.Find(E,t.symbol(t.SYMBOL_Y))?t.symbol(t.SYMBOL_Y):n.Find(E,t.symbol(t.SYMBOL_Z))?t.symbol(t.SYMBOL_Z):n.Find(E,t.symbol(t.SYMBOL_T))?t.symbol(t.SYMBOL_T):n.Find(E,t.symbol(t.SYMBOL_S))?t.symbol(t.SYMBOL_S):t.symbol(t.SYMBOL_X)}r.guess=e}),Be=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.msub=r.madd=void 0;function t(e,E){return e.add(E)}r.madd=t;function n(e,E){return e.subtract(E)}r.msub=n}),Jr=it(r=>{"use strict";var t=r&&r.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(r,"__esModule",{value:!0}),r.mgcd=void 0;var n=t(dr());function e(E,g){return n.default.gcd(E,g)}r.mgcd=e}),Tr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mdivrem=r.mmod=r.mdiv=r.mmul=void 0;function t(g,T){return g.multiply(T)}r.mmul=t;function n(g,T){return g.divide(T)}r.mdiv=n;function e(g,T){return g.mod(T)}r.mmod=e;function E(g,T){let y=g.divmod(T);return[y.quotient,y.remainder]}r.mdivrem=E}),Ge=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mprime=void 0;function t(n){return n.isProbablePrime()}r.mprime=t}),Qn=it(r=>{"use strict";var t=r&&r.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(r,"__esModule",{value:!0}),r.factor_number=void 0;var n=t(dr()),e=xt(),E=Cr(),g=zt(),T=Nt(),y=wt(),o=St(),l=Be(),d=Jr(),s=Tr(),i=Ge(),a=n.default(0);function p(x){if(y.equaln(x,0)||y.equaln(x,1)||y.equaln(x,-1))return x;a=x.q.a;let M=u();if(M.length,M.length===1)return M[0];if(M.length>1)return new e.Cons(e.symbol(e.MULTIPLY),o.makeList(...M))}r.factor_number=p;function u(){let x=[];a.isNegative()&&(a=T.setSignTo(a,1),x.push(e.Constants.negOne));for(let M=0;M<1e4;M++)if(x.push(..._(M)),a.compare(1)===0)return x;return x.push(...b()),x}function _(x){let M=[],j,q=T.mint(e.primetab[x]),O=0;for(;;){if(a.compare(1)===0)return O&&M.push(A(q,O)),M;let C;if([j,C]=Array.from(s.mdivrem(a,q)),C.isZero())O++,a=j;else break}return O&&M.push(A(q,O)),E.mcmp(j,q)===-1&&(M.push(A(a,1)),a=T.mint(1)),M}function b(){let x=[],M=T.mint(1),j=T.mint(5),q=T.mint(2),O=1,C=1;for(;;){if(i.mprime(a))return x.push(A(a,1)),x;for(;;){e.defs.esc_flag&&g.stop("esc");let et=l.msub(q,j);et=T.setSignTo(et,1);let lt=d.mgcd(et,a);if(e.MEQUAL(lt,1)){--O==0&&(q=j,C*=2,O=C),et=s.mmul(j,j),j=l.madd(et,M),et=s.mmod(j,a),j=et;continue}if(x.push(A(lt,1)),E.mcmp(lt,a)===0)return x;et=s.mdiv(a,lt),a=et,et=s.mmod(j,a),j=et,et=s.mmod(q,a),q=et;break}}}function A(x,M){let j=new e.Num(x);return M>1&&(j=o.makeList(e.symbol(e.POWER),j,new e.Num(T.mint(M)))),j}}),le=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.factor_small_number=r.factor=r.Eval_factor=void 0;var t=xt(),n=zt(),e=Mt(),E=Nt(),g=Tt(),T=Wr(),y=Er(),o=wt(),l=qt(),d=Qn();function s(_){let b=g.Eval(t.cadr(_)),A=g.Eval(t.caddr(_)),x=A===t.symbol(t.NIL)?y.guess(b):A,M=p(b,x);_=t.cdddr(_),t.iscons(_)&&(M=[..._].reduce((j,q)=>i(j,g.Eval(q)),M)),e.push(M)}r.Eval_factor=s;function i(_,b){if(t.ismultiply(_)){let x=[];return _.tail().forEach(M=>a(x,M,b)),l.multiply_all_noexpand(x)}let A=[];return a(A,_,b),A[0]}function a(_,b,A){let x=T.factorpoly(b,A);if(t.ismultiply(x)){_.push(...x.tail());return}_.push(x)}function p(_,b){return o.isinteger(_)?d.factor_number(_):T.factorpoly(_,b)}r.factor=p;function u(_){isNaN(_)&&n.stop("number too big to factor");let b=[];_<0&&(_=-_);for(let A=0;A<t.MAXPRIMETAB;A++){let x=t.primetab[A];if(x>_/x)break;let M=0;for(;_%x==0;)_/=x,M++;M&&(b.push(E.integer(x)),b.push(E.integer(M)))}return _>1&&(b.push(E.integer(_)),b.push(t.Constants.one)),b}r.factor_small_number=u}),ts=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.quickpower=r.quickfactor=void 0;var t=xt(),n=Ft(),e=Nt(),E=le(),g=wt(),T=St(),y=qt();function o(d,s){let i=E.factor_small_number(e.nativeInt(d)),a=i.length;for(let p=0;p<a;p+=2)i.push(...l(i[p],y.multiply(i[p+1],s)));return y.multiply_all(i.slice(a))}r.quickfactor=o;function l(d,s){let i=e.bignum_truncate(s),a=n.subtract(s,i),p;g.isZeroAtomOrTensor(a)||(p=T.makeList(t.symbol(t.POWER),d,a));let u=e.nativeInt(i);if(isNaN(u)){let b=T.makeList(t.symbol(t.POWER),d,i);return p?[p,b]:[b]}if(u===0)return[p];let _=e.bignum_power_number(d,u);return p?[p,_]:[_]}r.quickpower=l}),rs=it(r=>{"use strict";var t=r&&r.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(r,"__esModule",{value:!0}),r.qpow=void 0;var n=t(dr()),e=xt(),E=zt(),g=Ft(),T=Nt(),y=wt(),o=St(),l=ve(),d=Kn(),s=qt(),i=ts();function a(b,A){return p(b,A)}r.qpow=a;function p(b,A){if(y.isplusone(b)||y.isZeroAtomOrTensor(A))return e.Constants.one;if(y.isminusone(b)&&y.isoneovertwo(A))return e.Constants.imaginaryunit;if(y.isZeroAtomOrTensor(b))return y.isnegativenumber(A)&&E.stop("divide by zero"),e.Constants.zero;if(y.isplusone(A))return b;let x=0,M,j;if(y.isinteger(A)){if(x=T.nativeInt(A),isNaN(x))return o.makeList(e.symbol(e.POWER),b,A);if(M=l.mpow(b.q.a,Math.abs(x)),j=l.mpow(b.q.b,Math.abs(x)),x<0){let C=M;M=j,j=C,M=T.makeSignSameAs(M,j),j=T.makePositive(j)}return new e.Num(M,j)}if(y.isminusone(b))return u(A);if(y.isnegativenumber(b))return s.multiply(a(s.negate(b),A),a(e.Constants.negOne,A));if(!y.isinteger(b))return s.multiply(a(T.mp_numerator(b),A),a(T.mp_denominator(b),s.negate(A)));if(_(b))return i.quickfactor(b,A);if(!T.isSmall(A.q.a)||!T.isSmall(A.q.b))return o.makeList(e.symbol(e.POWER),b,A);let{a:q,b:O}=A.q;return M=d.mroot(b.q.a,O.toJSNumber()),M===0?o.makeList(e.symbol(e.POWER),b,A):(j=l.mpow(M,q),A.q.a.isNegative()?new e.Num(n.default.one,j):new e.Num(j))}function u(b){if(y.isinteger(b))return b.q.a.isOdd()?e.Constants.negOne:e.Constants.one;let A=T.bignum_truncate(b);y.isnegativenumber(b)&&(A=g.add(A,e.Constants.negOne));let x=g.subtract(b,A),M=o.makeList(e.symbol(e.POWER),e.Constants.negOne,x);return A.q.a.isOdd()&&(M=s.negate(M)),M}function _(b){return T.isSmall(b.q.a)}}),ir=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.power=r.Eval_power=void 0;var t=xt(),n=fr(),e=Mt(),E=Kt(),g=Ht(),T=Nr(),y=Ft(),o=Qr(),l=Nt(),d=zr(),s=kr(),i=Jn(),a=Tt(),p=jr(),u=wt(),_=St(),b=qt(),A=rs(),x=wr(),M=pr(),j=or(),q=!1;function O(v){q&&t.breakpoint;let S=a.Eval(t.caddr(v)),D=a.Eval(t.cadr(v));e.push(C(D,S))}r.Eval_power=O;function C(v,S){return et(v,S)}r.power=C;function et(v,S){q&&t.breakpoint;let D=S,Z=v;if(q&&console.log(`POWER: ${v} ^ ${S}`),g.equal(v,t.Constants.one)||u.isZeroAtomOrTensor(S)){let $=t.Constants.One();return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(g.equal(S,t.Constants.one))return q&&console.log(`   power of ${Z} ^ ${D}: ${v}`),v;if(u.isminusone(v)&&u.isminusone(S)){let $=b.negate(t.Constants.One());return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(u.isminusone(v)&&u.isoneovertwo(S)){let $=t.Constants.imaginaryunit;return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(u.isminusone(v)&&u.isminusoneovertwo(S)){let $=b.negate(t.Constants.imaginaryunit);return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}let F;if(u.isminusone(v)&&!t.isdouble(v)&&t.isrational(S)&&!u.isinteger(S)&&u.ispositivenumber(S)&&!t.defs.evaluatingAsFloats){q&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${S.q.a} , ${S.q.b}`)),S.q.a<S.q.b?F=_.makeList(t.symbol(t.POWER),v,S):(F=_.makeList(t.symbol(t.MULTIPLY),v,_.makeList(t.symbol(t.POWER),v,l.rational(S.q.a.mod(S.q.b),S.q.b))),q&&console.log(` trick applied : ${F}`));let $=x.rect(F);return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(t.isrational(v)&&t.isrational(S)){q&&console.log("   power: isrational(base) && isrational(exponent)");let $=A.qpow(v,S);return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(t.isNumericAtom(v)&&t.isNumericAtom(S)){let $=i.dpow(l.nativeDouble(v),l.nativeDouble(S));return q&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(t.istensor(v)){let $=j.power_tensor(v,S);return q&&(console.log("   power: istensor(base) "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(t.car(v)===t.symbol(t.ABS)&&u.iseveninteger(S)&&!u.isZeroAtomOrTensor(E.get_binding(t.symbol(t.ASSUME_REAL_VARIABLES)))){let $=C(t.cadr(v),S);return q&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(v===t.symbol(t.E)&&t.car(S)===t.symbol(t.LOG)){let $=t.cadr(S);return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}if(v===t.symbol(t.E)&&t.isdouble(S)){let $=l.double(Math.exp(S.d));return q&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(v===t.symbol(t.E)&&n.Find(S,t.Constants.imaginaryunit)&&n.Find(S,t.symbol(t.PI))&&!t.defs.evaluatingPolar){let $=_.makeList(t.symbol(t.POWER),v,S);q&&console.log(`   power: turning complex exponential to rect: ${e.top()}`);let B=x.rect($);if(!n.Find(B,t.symbol(t.PI)))return q&&console.log(`   power: turned complex exponential to rect: ${B}`),B}if(t.ismultiply(v)&&u.isinteger(S)){v=t.cdr(v);let $=C(t.car(v),S);return t.iscons(v)&&($=v.tail().reduce((B,X)=>b.multiply(B,C(X,S)),$)),q&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}let Q=!1;if(t.isNumericAtom(t.cadr(v))&&(Q=g.sign(l.compare_numbers(t.cadr(v),t.Constants.zero))>0),t.ispower(v)&&(u.isinteger(S)||Q)){let $=C(t.cadr(v),b.multiply(t.caddr(v),S));return q&&console.log(`   power of ${Z} ^ ${D}: ${$}`),$}let R=!1;if(u.iseveninteger(t.caddr(v))){let $=b.multiply(t.caddr(v),S);u.isone($)&&(R=!0)}if(t.ispower(v)&&R){let $=T.abs(t.cadr(v));return q&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(t.defs.expanding&&t.isadd(v)&&t.isNumericAtom(S)){let $=l.nativeInt(S);if($>1&&!isNaN($)){q&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let B=lt($,v);return q&&console.log(`   power of ${Z} ^ ${D}: ${B}`),B}}if(t.defs.trigmode===1&&t.car(v)===t.symbol(t.SIN)&&u.iseveninteger(S)){let $=C(y.subtract(t.Constants.one,C(s.cosine(t.cadr(v)),l.integer(2))),b.multiply(S,l.rational(1,2)));return q&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(t.defs.trigmode===2&&t.car(v)===t.symbol(t.COS)&&u.iseveninteger(S)){let $=C(y.subtract(t.Constants.one,C(M.sine(t.cadr(v)),l.integer(2))),b.multiply(S,l.rational(1,2)));return q&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${Z} ^ ${D}: ${$}`)),$}if(u.iscomplexnumber(v)){if(q&&console.log(" power - handling the case (a + ib) ^ n"),u.isinteger(S)){let $=d.conjugate(v),B=b.divide($,b.multiply($,v));return u.isone(S)||(B=C(B,b.negate(S))),q&&console.log(`   power of ${Z} ^ ${D}: ${B}`),B}if(t.isNumericAtom(S)){let $=t.defs.evaluatingAsFloats||u.iscomplexnumberdouble(v)&&t.isdouble(S)?l.double(Math.PI):t.symbol(t.PI),B=b.multiply(C(T.abs(v),S),C(t.Constants.negOne,b.divide(b.multiply(o.arg(v),S),$)));return t.avoidCalculatingPowersIntoArctans&&n.Find(B,t.symbol(t.ARCTAN))&&(B=_.makeList(t.symbol(t.POWER),v,S)),q&&console.log(`   power of ${Z} ^ ${D}: ${B}`),B}}let h=U(S);if(h!==void 0)return q&&console.log("   power: using simplify_polar"),h;let N=_.makeList(t.symbol(t.POWER),v,S);return q&&(console.log("   power: nothing can be done "),console.log(`   power of ${Z} ^ ${D}: ${N}`)),N}function lt(v,S){let D=[],Z=g.length(S)-1,F=[];S=t.cdr(S);for(let Q=0;Q<Z;Q++){for(let R=0;R<=v;R++)F[Q*(v+1)+R]=C(t.car(S),l.integer(R));S=t.cdr(S)}S=p.factorial(l.integer(v));for(let Q=0;Q<Z;Q++)D[Q]=0;return H(Z,v,D,0,v,F,S,t.Constants.zero)}function H(v,S,D,Z,F,Q,R,h){if(Z<v-1){for(let $=0;$<=F;$++)D[Z]=$,h=H(v,S,D,Z+1,F-$,Q,R,h);return h}D[Z]=F;let N=R;for(let $=0;$<v;$++)N=b.divide(N,p.factorial(l.integer(D[$])));for(let $=0;$<v;$++)N=b.multiply(N,Q[$*(S+1)+D[$]]);return y.add(h,N)}function U(v){let S=u.isquarterturn(v);switch(S){case 0:break;case 1:return t.Constants.one;case 2:return t.Constants.negOne;case 3:return t.Constants.imaginaryunit;case 4:return b.negate(t.Constants.imaginaryunit)}if(t.isadd(v)){let D=t.cdr(v);for(;t.iscons(D)&&(S=u.isquarterturn(t.car(D)),!S);)D=t.cdr(D);let Z;switch(S){case 0:return;case 1:Z=t.Constants.one;break;case 2:Z=t.Constants.negOne;break;case 3:Z=t.Constants.imaginaryunit;break;case 4:Z=b.negate(t.Constants.imaginaryunit);break}return b.multiply(Z,g.exponential(y.subtract(v,t.car(D))))}}}),qt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.negate_noexpand=r.negate=r.reciprocate=r.inverse=r.divide=r.multiply_all_noexpand=r.multiply_all=r.multiply_noexpand=r.multiply=r.Eval_multiply=void 0;var t=xt(),n=zt(),e=Mt(),E=Ht(),g=Ft(),T=Nt(),y=Tt(),o=wt(),l=St(),d=ir(),s=or(),i=Pr();function a(v){let S=y.Eval(t.cadr(v));v=t.cddr(v),t.iscons(v)&&(S=[...v].reduce((D,Z)=>p(D,y.Eval(Z)),S)),e.push(S)}r.Eval_multiply=a;function p(v,S){return t.defs.esc_flag&&n.stop("escape key stop"),t.isNumericAtom(v)&&t.isNumericAtom(S)?T.multiply_numbers(v,S):u(v,S)}r.multiply=p;function u(v,S){let D=t.defs.tos;if(o.isZeroAtom(v)||o.isZeroAtom(S))return t.Constants.Zero();if(t.defs.expanding&&t.isadd(v))return v.tail().reduce((B,X)=>g.add(B,p(X,S)),t.Constants.Zero());if(t.defs.expanding&&t.isadd(S))return S.tail().reduce((B,X)=>g.add(B,p(v,X)),t.Constants.Zero());if(!t.istensor(v)&&t.istensor(S))return s.scalar_times_tensor(v,S);if(t.istensor(v)&&!t.istensor(S))return s.tensor_times_scalar(v,S);if(v=t.ismultiply(v)?t.cdr(v):l.makeList(v),S=t.ismultiply(S)?t.cdr(S):l.makeList(S),t.isNumericAtom(t.car(v))&&t.isNumericAtom(t.car(S))){let B=t.car(v),X=t.car(S);e.push(T.multiply_numbers(B,X)),v=t.cdr(v),S=t.cdr(S)}else t.isNumericAtom(t.car(v))?(e.push(t.car(v)),v=t.cdr(v)):t.isNumericAtom(t.car(S))?(e.push(t.car(S)),S=t.cdr(S)):e.push(t.Constants.One());let[Z,F]=_(v),[Q,R]=b(S);for(;t.iscons(v)&&t.iscons(S);){if(t.caar(v)===t.symbol(t.OPERATOR)&&t.caar(S)===t.symbol(t.OPERATOR)){e.push(new t.Cons(t.symbol(t.OPERATOR),i.append(t.cdar(v),t.cdar(S)))),v=t.cdr(v),S=t.cdr(S),[Z,F]=_(v),[Q,R]=b(S);continue}switch(E.cmp_expr(Z,Q)){case-1:e.push(t.car(v)),v=t.cdr(v),[Z,F]=_(v);break;case 1:e.push(t.car(S)),S=t.cdr(S),[Q,R]=b(S);break;case 0:A(D,Q,F,R),v=t.cdr(v),S=t.cdr(S),[Z,F]=_(v),[Q,R]=b(S);break;default:n.stop("internal error 2")}}let h=[];if(t.iscons(v)&&h.push(...v),t.iscons(S)&&h.push(...S),e.push_all(h),H(D),t.defs.expanding){for(let B=D;B<t.defs.tos;B++)if(t.isadd(t.defs.stack[B])){let X=e.pop_n_items(t.defs.tos-D);return M(X)}}let N=t.defs.tos-D;if(N===1)return e.pop();if(t.isrational(t.defs.stack[D])&&o.equaln(t.defs.stack[D],1))if(N===2){let B=e.pop();return e.pop(),B}else return t.defs.stack[D]=t.symbol(t.MULTIPLY),l.list(N),e.pop();l.list(N);let $=e.pop();return new t.Cons(t.symbol(t.MULTIPLY),$)}function _(v){let S=t.car(v),D=t.Constants.One();return t.ispower(S)&&(D=t.caddr(S),S=t.cadr(S)),[S,D]}function b(v){let S=t.car(v),D=t.Constants.One();return t.ispower(S)&&(D=t.caddr(S),S=t.cadr(S)),[S,D]}function A(v,S,D,Z){let F=d.power(S,g.add(D,Z));if(t.isNumericAtom(F))t.defs.stack[v]=T.multiply_numbers(t.defs.stack[v],F);else if(t.ismultiply(F))if(t.isNumericAtom(t.cadr(F))&&t.cdddr(F)===t.symbol(t.NIL)){let Q=t.defs.stack[v],R=t.cadr(F);t.defs.stack[v]=T.multiply_numbers(Q,R),e.push(t.caddr(F))}else e.push(F);else e.push(F)}function x(v,S){return t.noexpand(p,v,S)}r.multiply_noexpand=x;function M(v){if(v.length===1)return v[0];if(v.length===0)return t.Constants.One();let S=v[0];for(let D=1;D<v.length;D++)S=p(S,v[D]);return S}r.multiply_all=M;function j(v){return t.noexpand(M,v)}r.multiply_all_noexpand=j;function q(v,S){return t.isNumericAtom(v)&&t.isNumericAtom(S)?T.divide_numbers(v,S):p(v,O(S))}r.divide=q;function O(v){return t.isNumericAtom(v)?T.invert_number(v):d.power(v,t.Constants.negOne)}r.inverse=O;function C(v){return O(v)}r.reciprocate=C;function et(v){return t.isNumericAtom(v)?T.negate_number(v):p(v,t.Constants.NegOne())}r.negate=et;function lt(v){return t.noexpand(et,v)}r.negate_noexpand=lt;function H(v){let S=0;if(o.isplusone(t.defs.stack[v])||o.isminusone(t.defs.stack[v])||t.isdouble(t.defs.stack[v]))return;for(S=v+1;S<t.defs.tos&&!U(t.defs.stack[S]);S++);if(S===t.defs.tos)return;let D=T.mp_numerator(t.defs.stack[v]);for(let F=v+1;F<t.defs.tos&&!(o.isplusone(D)||o.isminusone(D));F++){if(!U(t.defs.stack[F]))continue;let Q=t.cadr(t.defs.stack[F]),R=t.caddr(t.defs.stack[F]);if(!o.isnegativenumber(R))continue;let h=q(D,Q);!o.isinteger(h)||(D=h,t.defs.stack[F]=l.makeList(t.symbol(t.POWER),Q,g.add(t.Constants.One(),R)))}let Z=T.mp_denominator(t.defs.stack[v]);for(let F=v+1;F<t.defs.tos&&!o.isplusone(Z);F++){if(!U(t.defs.stack[F]))continue;let Q=t.cadr(t.defs.stack[F]),R=t.caddr(t.defs.stack[F]);if(o.isnegativenumber(R))continue;let h=q(Z,Q);if(!o.isinteger(h))continue;Z=h;let N=g.subtract(R,t.Constants.one);if(t.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&o.isinteger(Q)&&!o.isinteger(N)&&o.isnegativenumber(N)){D=q(D,Q);break}t.defs.stack[F]=l.makeList(t.symbol(t.POWER),Q,N)}t.defs.stack[v]=q(D,Z)}function U(v){return t.ispower(v)&&t.isNumericAtom(t.cadr(v))&&o.isfraction(t.caddr(v))&&!o.isminusone(t.cadr(v))}}),Lr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.denominator=r.Eval_denominator=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=qt(),y=ae();function o(d){let s=l(E.Eval(t.cadr(d)));n.push(s)}r.Eval_denominator=o;function l(d){return t.isadd(d)&&(d=y.rationalize(d)),t.ismultiply(d)&&!g.isplusone(t.car(t.cdr(d)))?T.multiply_all(d.tail().map(l)):t.isrational(d)?e.mp_denominator(d):t.ispower(d)&&g.isnegativeterm(t.caddr(d))?T.reciprocate(d):t.Constants.one}r.denominator=l}),Fe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.arctan=r.Eval_arctan=void 0;var t=xt(),n=fr(),e=Mt(),E=Ht(),g=Nt(),T=Lr(),y=Tt(),o=wt(),l=St(),d=qt(),s=qr();function i(p){e.push(a(y.Eval(t.cadr(p))))}r.Eval_arctan=i;function a(p){if(t.car(p)===t.symbol(t.TAN))return t.cadr(p);if(t.isdouble(p))return g.double(Math.atan(p.d));if(o.isZeroAtomOrTensor(p))return t.Constants.zero;if(o.isnegative(p))return d.negate(a(d.negate(p)));if(n.Find(p,t.symbol(t.SIN))&&n.Find(p,t.symbol(t.COS))){let u=s.numerator(p),_=T.denominator(p);if(t.car(u)===t.symbol(t.SIN)&&t.car(_)===t.symbol(t.COS)&&E.equal(t.cadr(u),t.cadr(_)))return t.cadr(u)}return t.ispower(p)&&o.equaln(t.cadr(p),3)&&o.equalq(t.caddr(p),-1,2)||t.ismultiply(p)&&o.equalq(t.car(t.cdr(p)),1,3)&&t.car(t.car(t.cdr(t.cdr(p))))===t.symbol(t.POWER)&&o.equaln(t.car(t.cdr(t.car(t.cdr(t.cdr(p))))),3)&&o.equalq(t.car(t.cdr(t.cdr(t.car(t.cdr(t.cdr(p)))))),1,2)?d.multiply(g.rational(1,6),t.Constants.Pi()):o.equaln(p,1)?d.multiply(g.rational(1,4),t.Constants.Pi()):t.ispower(p)&&o.equaln(t.cadr(p),3)&&o.equalq(t.caddr(p),1,2)?d.multiply(g.rational(1,3),t.Constants.Pi()):l.makeList(t.symbol(t.ARCTAN),p)}r.arctan=a}),ue=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.imag=r.Eval_imag=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=zr(),T=Tt(),y=qt(),o=wr(),l=!1;function d(i){let a=s(T.Eval(t.cadr(i)));n.push(a)}r.Eval_imag=d;function s(i){let a=o.rect(i),p=g.conjugate(a),u=y.divide(e.subtract(a,p),E.integer(2)),_=y.divide(u,t.Constants.imaginaryunit);return l&&(console.log(`IMAGE of ${a}`),console.log(` image: conjugate result: ${p}`),console.log(` image: 1st divide result: ${u}`),console.log(` image: 2nd divide result: ${_}`)),_}r.imag=s}),Kr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.real=r.Eval_real=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=zr(),T=Tt(),y=qt(),o=wr();function l(s){let i=d(T.Eval(t.cadr(s)));n.push(i)}r.Eval_real=l;function d(s){let i=o.rect(s);return y.divide(e.add(i,g.conjugate(i)),E.integer(2))}r.real=d}),Qr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.arg=r.Eval_arg=void 0;var t=xt(),n=Mt(),e=Kt(),E=Ft(),g=Fe(),T=Lr(),y=Tt(),o=ue(),l=wt(),d=St(),s=qt(),i=qr(),a=Kr(),p=wr(),u=!1;function _(x){n.push(b(y.Eval(t.cadr(x))))}r.Eval_arg=_;function b(x){return E.subtract(A(i.numerator(x)),A(T.denominator(x)))}r.arg=b;function A(x){if(l.ispositivenumber(x)||x===t.symbol(t.PI))return t.isdouble(x)||t.defs.evaluatingAsFloats?t.Constants.zeroAsDouble:t.Constants.zero;if(l.isnegativenumber(x)){let M=t.isdouble(x)||t.defs.evaluatingAsFloats?t.Constants.piAsDouble:t.symbol(t.PI);return s.negate(M)}if(t.issymbol(x))return d.makeList(t.symbol(t.ARG),x);if(t.ispower(x)&&l.equaln(t.cadr(x),-1))return s.multiply(t.Constants.Pi(),t.caddr(x));if(t.ispower(x)&&t.cadr(x)===t.symbol(t.E))return o.imag(t.caddr(x));if(t.ispower(x)&&l.isoneovertwo(t.caddr(x))){let M=b(t.cadr(x));return u&&(console.log(`arg of a sqrt: ${x}`),t.breakpoint,console.log(` = 1/2 * ${M}`)),s.multiply(M,t.caddr(x))}if(t.ismultiply(x))return x.tail().map(b).reduce(E.add,t.Constants.zero);if(t.isadd(x)){x=p.rect(x);let M=a.real(x),j=o.imag(x);if(l.isZeroAtomOrTensor(M))return l.isnegative(j)?s.negate(t.Constants.Pi()):t.Constants.Pi();{let q=g.arctan(s.divide(j,M));return l.isnegative(M)?l.isnegative(j)?E.subtract(q,t.Constants.Pi()):E.add(q,t.Constants.Pi()):q}}return l.isZeroAtomOrTensor(e.get_binding(t.symbol(t.ASSUME_REAL_VARIABLES)))?d.makeList(t.symbol(t.ARG),x):t.Constants.zero}}),xe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.clockform=r.Eval_clock=void 0;var t=xt(),n=Mt(),e=Nr(),E=Qr(),g=Tt(),T=St(),y=qt(),o=!1;function l(s){let i=d(g.Eval(t.cadr(s)));n.push(i)}r.Eval_clock=l;function d(s){let i=T.makeList(t.symbol(t.POWER),t.Constants.negOne,y.divide(E.arg(s),t.Constants.Pi())),a=y.multiply(e.abs(s),i);return o&&(console.log(`clockform: abs of ${s} : ${e.abs(s)}`),console.log(`clockform: arg of ${s} : ${E.arg(s)}`),console.log(`clockform: divide : ${y.divide(E.arg(s),t.Constants.Pi())}`),console.log(`clockform: power : ${i}`),console.log(`clockform: multiply : ${a}`)),a}r.clockform=d}),_e=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.polar=r.Eval_polar=void 0;var t=xt(),n=Mt(),e=Ht(),E=Nr(),g=Qr(),T=Tt(),y=qt();function o(d){let s=l(T.Eval(t.cadr(d)));n.push(s)}r.Eval_polar=o;function l(d){return t.evalPolar(()=>y.multiply(E.abs(d),e.exponential(y.multiply(t.Constants.imaginaryunit,g.arg(d)))))}r.polar=l}),zr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.conjugate=r.Eval_conj=void 0;var t=xt(),n=fr(),e=Mt(),E=xe(),g=Tt(),T=qt(),y=_e(),o=_r();function l(s){s=g.Eval(t.cadr(s)),n.Find(s,t.Constants.imaginaryunit)?e.push(d(s)):e.push(E.clockform(d(y.polar(s))))}r.Eval_conj=l;function d(s){return g.Eval(o.subst(s,t.Constants.imaginaryunit,T.negate(t.Constants.imaginaryunit)))}r.conjugate=d}),Sr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.yyfloat=r.zzfloat=r.Eval_float=void 0;var t=$r(),n=xt(),e=zt(),E=Mt(),g=Nt(),T=Tt(),y=St(),o=or();function l(a){n.evalFloats(()=>{let p=T.Eval(s(T.Eval(n.cadr(a))));E.push(p)})}r.Eval_float=l;function d(a){return n.evalFloats(()=>T.Eval(s(T.Eval(a))))}r.zzfloat=d;function s(a){return n.evalFloats(i,a)}r.yyfloat=s;function i(a){return n.iscons(a)?y.makeList(...a.map(i)):n.istensor(a)?(a=o.copy_tensor(a),a.tensor.elem=a.tensor.elem.map(i),a):n.isrational(a)?g.bignum_float(a):a===n.symbol(n.PI)?n.Constants.piAsDouble:a===n.symbol(n.E)?g.double(Math.E):a}}),Ee=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.determinant=r.det=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=St(),y=qt(),o=or();function l(u){if(!o.is_square_matrix(u))return T.makeList(t.symbol(t.DET),u);let _=u.tensor.elem;return _.every(b=>t.isNumericAtom(b))?s(u):d(_,u.tensor.dim[0])}r.det=l;function d(u,_){let b=0,A=[];for(let j=0;j<_;j++)A[j]=j,A[j+_]=0,A[j+_+_]=1;let x=1,M=t.Constants.zero;for(;;){let j=g.integer(x);for(let lt=0;lt<_;lt++){let H=_*A[lt]+lt;j=y.multiply(j,u[H])}M=E.add(M,j);let q=_-1,O=0,C=!1;for(;;){if(b=A[_+q]+A[_+_+q],b<0){A[_+_+q]=-A[_+_+q],q--;continue}if(b===q+1){if(q===0){C=!0;break}O++,A[_+_+q]=-A[_+_+q],q--;continue}break}if(C)break;let et=A[q-A[_+q]+O];A[q-A[_+q]+O]=A[q-b+O],A[q-b+O]=et,A[_+q]=b,x=x===1?-1:1}return M}r.determinant=d;function s(u){let _=u.tensor.dim[0],b=[...u.tensor.elem];return p(b,_)}function i(u,_,b,A){return u[_*b+A]}function a(u,_,b,A,x){u[_*b+A]=x}function p(u,_){let b=t.Constants.one;for(let A=0;A<_-1;A++){if(e.equal(i(u,_,A,A),t.Constants.zero)){let x=0;for(x=A+1;x<_&&e.equal(i(u,_,x,A),t.Constants.zero);x++);if(x===_){b=t.Constants.zero;break}for(let M=A;M<_;M++){let j=i(u,_,A,M);a(u,_,A,M,i(u,_,x,M)),a(u,_,x,M,j)}b=y.negate(b)}b=y.multiply(b,i(u,_,A,A));for(let x=A+1;x<_;x++){let M=y.negate(y.divide(i(u,_,x,A),i(u,_,A,A)));a(u,_,x,A,t.Constants.zero);for(let j=A+1;j<_;j++){let q=E.add(y.multiply(i(u,_,A,j),M),i(u,_,x,j));a(u,_,x,j,q)}}}return y.multiply(b,i(u,_,_-1,_-1))}}),je=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cofactor=r.Eval_cofactor=void 0;var t=xt(),n=zt(),e=Mt(),E=Ee(),g=Tt(),T=qt(),y=or();function o(d){let s=g.Eval(t.cadr(d));y.is_square_matrix(s)||n.stop("cofactor: 1st arg: square matrix expected");let i=s.tensor.dim[0],a=g.evaluate_integer(t.caddr(d));(a<1||a>i)&&n.stop("cofactor: 2nd arg: row index expected");let p=g.evaluate_integer(t.cadddr(d));(p<1||p>i)&&n.stop("cofactor: 3rd arg: column index expected"),e.push(l(s,i,a-1,p-1))}r.Eval_cofactor=o;function l(d,s,i,a){let p=[];for(let _=0;_<s;_++)for(let b=0;b<s;b++)_!==i&&b!==a&&p.push(d.tensor.elem[s*_+b]);let u=E.determinant(p,s-1);return(i+a)%2&&(u=T.negate(u)),u}r.cofactor=l}),Ye=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adj=r.Eval_adj=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=je(),T=Tt(),y=or();function o(d){let s=l(T.Eval(n.cadr(d)));E.push(s)}r.Eval_adj=o;function l(d){y.is_square_matrix(d)||e.stop("adj: square matrix expected");let s=d.tensor.dim[0],i=t.alloc_tensor(s*s);i.tensor.ndim=2,i.tensor.dim[0]=s,i.tensor.dim[1]=s;for(let a=0;a<s;a++)for(let p=0;p<s;p++)i.tensor.elem[s*p+a]=g.cofactor(d,s,a,p);return i}r.adj=l}),ce=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.invg=r.inv=void 0;var t=lr(),n=xt(),e=zt(),E=Ht(),g=Ft(),T=Ye(),y=Ee(),o=Br(),l=wt(),d=St(),s=qt(),i=or();function a(b){if(n.isinv(b))return n.car(n.cdr(b));if(n.isidentitymatrix(b))return b;if(n.defs.expanding&&n.isinnerordot(b)){let x=(n.iscons(b)?b.tail():[]).map(a);for(let M=x.length-1;M>0;M--)x[M-1]=o.inner(x[M],x[M-1]);return x[0]}if(!i.is_square_matrix(b))return d.makeList(n.symbol(n.INV),b);if(n.isNumericAtomOrTensor(b))return u(b);let A=y.det(b);return l.isZeroAtomOrTensor(A)&&e.stop("inverse of singular matrix"),s.divide(T.adj(b),A)}r.inv=a;function p(b){return i.is_square_matrix(b)?u(b):d.makeList(n.symbol(n.INVG),b)}r.invg=p;function u(b){let A=b.tensor.dim[0],x=new Array(A*A);x.fill(n.Constants.zero);for(let q=0;q<A;q++)x[q*A+q]=n.Constants.one;let M=_(x,b.tensor.elem,A),j=t.alloc_tensor(A*A);return j.tensor.ndim=2,j.tensor.dim[0]=A,j.tensor.dim[1]=A,j.tensor.elem=M,j}function _(b,A,x){for(let M=0;M<x;M++){if(E.equal(A[x*M+M],n.Constants.zero)){let q=0;for(q=M+1;q<x&&E.equal(A[x*q+M],n.Constants.zero);q++);q===x&&e.stop("inverse of singular matrix");for(let O=0;O<x;O++){let C=A[x*M+O];A[x*M+O]=A[x*q+O],A[x*q+O]=C,C=b[x*M+O],b[x*M+O]=b[x*q+O],b[x*q+O]=C}}let j=A[x*M+M];for(let q=0;q<x;q++)q>M&&(A[x*M+q]=s.divide(A[x*M+q],j)),b[x*M+q]=s.divide(b[x*M+q],j);for(let q=0;q<x;q++){if(q===M)continue;let O=A[x*q+M];for(let C=0;C<x;C++)C>M&&(A[x*q+C]=g.subtract(A[x*q+C],s.multiply(A[x*M+C],O))),b[x*q+C]=g.subtract(b[x*q+C],s.multiply(b[x*M+C],O))}}return b}}),Br=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.inner=r.Eval_inner=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ft(),T=Tt(),y=ce(),o=wt(),l=St(),d=qt(),s=or();function i(b){let A=[];A.push(n.car(n.cdr(b))),n.car(n.cdr(n.cdr(b)))===n.symbol(n.NIL)&&e.stop("pattern needs at least a template and a transformed version");let x=n.cdr(n.cdr(b));for(;x!==n.symbol(n.NIL);)A.push(n.car(x)),x=n.cdr(x);if(A.length>2){let O=l.makeList(n.symbol(n.INNER),A[A.length-2],A[A.length-1]);for(let C=2;C<A.length;C++)O=l.makeList(n.symbol(n.INNER),A[A.length-C-1],O);i(O);return}let M=[];u(b,M);let j=[];for(let O=0;O<M.length;O++)M[O]!==n.symbol(n.SYMBOL_IDENTITY_MATRIX)&&j.push(M[O]);if(M=j,j=[],M.length>1){let O=0;for(let C=0;C<M.length&&C+O+1<=M.length-1;C++){if(n.isNumericAtomOrTensor(M[C+O])||n.isNumericAtomOrTensor(M[C+O+1]))j.push(M[C+O]);else{let et=T.Eval(M[C+O+1]),lt=y.inv(T.Eval(M[C+O])),H=g.subtract(lt,et);o.isZeroAtomOrTensor(H)?O+=1:j.push(M[C+O])}if(C+O===M.length-2&&j.push(M[M.length-1]),C+O>=M.length-1)break}M=j}if(M.length===0){E.push(n.symbol(n.SYMBOL_IDENTITY_MATRIX));return}b=l.makeList(n.symbol(n.INNER),...M),b=n.cdr(b);let q=T.Eval(n.car(b));n.iscons(b)&&(q=b.tail().reduce((O,C)=>a(O,T.Eval(C)),q)),E.push(q)}r.Eval_inner=i;function a(b,A){if(o.isnegativeterm(A)&&o.isnegativeterm(b)&&(A=d.negate(A),b=d.negate(b)),n.isinnerordot(b)&&(A=a(n.car(n.cdr(n.cdr(b))),A),b=n.car(n.cdr(b))),b===n.symbol(n.SYMBOL_IDENTITY_MATRIX))return A;if(A===n.symbol(n.SYMBOL_IDENTITY_MATRIX))return b;if(n.istensor(b)&&n.istensor(A))return p(b,A);if(!(n.isNumericAtomOrTensor(b)||n.isNumericAtomOrTensor(A))){let x=g.subtract(b,y.inv(A));if(o.isZeroAtomOrTensor(x))return n.symbol(n.SYMBOL_IDENTITY_MATRIX)}return n.defs.expanding&&n.isadd(b)?b.tail().reduce((x,M)=>g.add(x,a(M,A)),n.Constants.zero):n.defs.expanding&&n.isadd(A)?A.tail().reduce((x,M)=>g.add(x,a(b,M)),n.Constants.zero):n.istensor(b)&&n.isNumericAtom(A)?s.tensor_times_scalar(b,A):n.isNumericAtom(b)&&n.istensor(A)?s.scalar_times_tensor(b,A):n.isNumericAtom(b)||n.isNumericAtom(A)?d.multiply(b,A):l.makeList(n.symbol(n.INNER),b,A)}r.inner=a;function p(b,A){let x=b.tensor.dim[b.tensor.ndim-1];x!==A.tensor.dim[0]&&(n.breakpoint,e.stop("inner: tensor dimension check"));let M=b.tensor.ndim+A.tensor.ndim-2;M>n.MAXDIM&&e.stop("inner: rank of result exceeds maximum");let j=b.tensor.elem,q=A.tensor.elem,O=b.tensor.dim.slice(0,b.tensor.dim.length-1).reduce((H,U)=>H*U,1),C=A.tensor.dim.slice(1).reduce((H,U)=>H*U,1),et=t.alloc_tensor(O*C),lt=et.tensor.elem;for(let H=0;H<O;H++)for(let U=0;U<x;U++)if(!o.isZeroAtomOrTensor(j[H*x+U]))for(let v=0;v<C;v++)lt[H*C+v]=g.add(d.multiply(j[H*x+U],q[U*C+v]),lt[H*C+v]);return M===0?et.tensor.elem[0]:(et.tensor.ndim=M,et.tensor.dim=[...b.tensor.dim.slice(0,b.tensor.ndim-1),...A.tensor.dim.slice(1,A.tensor.ndim)],et)}function u(b,A){if(!n.iscons(b)){_(b,A);return}if(n.cdr(b)===n.symbol(n.NIL)){u(n.car(b),A);return}if(n.isinnerordot(b)){u(n.car(n.cdr(b)),A),u(n.cdr(n.cdr(b)),A);return}_(b,A)}function _(b,A){b!==n.symbol(n.NIL)&&A.push(b)}}),Xe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.roots=r.Eval_roots=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ht(),T=Nr(),y=Ft(),o=Nt(),l=Xr(),d=Tt(),s=Wr(),i=Er(),a=wt(),p=qt(),u=ir(),_=Gr(),b={debug:h=>{n.DEBUG&&console.log(h)}},A=h=>[].concat(...h);function x(h){let N=n.cadr(h),$;n.car(N)===n.symbol(n.SETQ)||n.car(N)===n.symbol(n.TESTEQ)?$=y.subtract(d.Eval(n.cadr(N)),d.Eval(n.caddr(N))):(N=d.Eval(N),n.car(N)===n.symbol(n.SETQ)||n.car(N)===n.symbol(n.TESTEQ)?$=y.subtract(d.Eval(n.cadr(N)),d.Eval(n.caddr(N))):$=N),N=d.Eval(n.caddr(h));let B=N===n.symbol(n.NIL)?i.guess($):N;a.ispolyexpandedform($,B)||e.stop("roots: 1st argument is not a polynomial in the variable "+B),E.push_all(O($,B))}r.Eval_roots=x;function M(h){return h.some(N=>a.iscomplexnumber(N))}function j(h){return h.length<=2||a.isZeroAtomOrTensor(h[0])?!1:h.slice(1,h.length-1).every(N=>a.isZeroAtomOrTensor(N))}function q(h,N){let $=l.coeff(h,N),B=$[$.length-1];return $.map(X=>p.divide(X,B))}function O(h,N){if(n.defs.recursionLevelNestedRadicalsRemoval>1)return[n.symbol(n.NIL)];b.debug(`checking if ${E.top()} is a case of simple roots`);let $=q(h,N),B=[];if(j($)){b.debug(`yes, ${$[$.length-1]} is a case of simple roots`);let J=$.length,pt=$[0],_t=$.pop(),At=C(J,_t,pt);B.push(...At)}else{let J=et(h,N);B.push(...J)}let X=B.length;if(X===0&&e.stop("roots: the polynomial is not factorable, try nroots"),X===1)return B;g.sort(B),h=t.alloc_tensor(X),h.tensor.ndim=1,h.tensor.dim[0]=X;for(let J=0;J<X;J++)h.tensor.elem[J]=B[J];return[h]}r.roots=O;function C(h,N,$){b.debug("getSimpleRoots"),h=h-1;let B=p.divide(u.power($,o.rational(1,h)),u.power(N,o.rational(1,h))),X=[];if(h%2==0){for(let J=1;J<=h;J+=2){let pt=p.multiply(B,u.power(n.Constants.negOne,o.rational(J,h)));X.push(pt),X.push(p.negate(pt))}return X}for(let J=1;J<=h;J++){let pt=p.multiply(B,u.power(n.Constants.negOne,o.rational(J,h)));J%2==0&&(pt=p.negate(pt)),X.push(pt)}return X}function et(h,N){let $=q(h,N);if(M($)||(h=s.factorpoly(h,N)),n.ismultiply(h)){let B=h.tail().map(X=>lt(X,N));return A(B)}return lt(h,N)}function lt(h,N){if(n.ispower(h)&&a.ispolyexpandedform(n.cadr(h),N)&&a.isposint(n.caddr(h))){let $=q(n.cadr(h),N);return H($)}if(a.ispolyexpandedform(h,N)){let $=q(h,N);return H($)}return[]}function H(h){let N=h.length;if(N===2){let $=h.pop(),B=h.pop();return U($,B)}if(N===3){let $=h.pop(),B=h.pop(),X=h.pop();return v($,B,X)}if(N===4){let $=h.pop(),B=h.pop(),X=h.pop(),J=h.pop();return S($,B,X,J)}if(N===5){let $=h.pop(),B=h.pop(),X=h.pop(),J=h.pop(),pt=h.pop();return Z($,B,X,J,pt)}return[]}function U(h,N){return[p.negate(p.divide(N,h))]}function v(h,N,$){let B=u.power(y.subtract(u.power(N,o.integer(2)),p.multiply(p.multiply(o.integer(4),h),$)),o.rational(1,2)),X=p.divide(y.subtract(B,N),p.multiply(h,o.integer(2))),J=p.multiply(p.divide(p.negate(y.add(B,N)),h),o.rational(1,2));return[X,J]}function S(h,N,$,B){let X=p.multiply(p.multiply($,$),$),J=p.multiply(N,N),pt=p.multiply(J,N),_t=p.multiply(p.multiply(pt,B),o.integer(-4)),At=p.multiply(pt,o.integer(2)),ht=p.multiply(o.integer(3),h),It=p.multiply(p.multiply(h,h),B),Lt=p.multiply(It,o.integer(27)),Yt=p.multiply(p.multiply(It,B),o.integer(-27)),Bt=p.multiply(p.multiply(h,$),N),Zt=p.multiply(p.multiply(h,$),o.integer(3)),ft=p.multiply(o.integer(-4),p.multiply(h,X)),gt=p.negate(p.multiply(Bt,o.integer(9))),Pt=p.multiply(p.multiply(Bt,B),o.integer(18)),kt=y.subtract(J,Zt),rr=p.multiply(J,p.multiply($,$)),nt=p.divide(p.negate(N),ht),Ot=p.multiply(u.power(kt,o.integer(3)),o.integer(4)),w=T.absValFloat(_.simplify(kt)),vt=T.absValFloat(_.simplify(y.add_all([Pt,_t,rr,ft,Yt]))),P=y.add_all([At,gt,Lt]),rt=_.simplify(u.power(y.subtract(u.power(P,o.integer(2)),Ot),o.rational(1,2)));if(b.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),b.debug(`cubic: D0: ${kt}`),b.debug(`cubic: D0 as float: ${w}`),b.debug(`cubic: DETERMINANT: ${vt}`),b.debug(`cubic: D1: ${P}`),a.isZeroAtomOrTensor(vt))return D(h,N,$,B,{R_DELTA0_toBeCheckedIfZero:w,R_m_b_over_3a:nt,R_DELTA0:kt,R_b3:pt,R_a_b_c:Bt});let W=!1,f=!1,L;for(;!W;){let jt=f?p.negate(rt):rt;L=_.simplify(u.power(p.multiply(y.add(jt,P),o.rational(1,2)),o.rational(1,3)));let Vt=T.absValFloat(_.simplify(L));b.debug(`cubic: C: ${L}`),b.debug(`cubic: C as absval and float: ${Vt}`),a.isZeroAtomOrTensor(Vt)?(b.debug(" cubic: C IS ZERO flipping the sign"),f=!0):W=!0}let V=p.multiply(p.multiply(L,ht),o.integer(2)),G=p.multiply(n.Constants.imaginaryunit,u.power(o.integer(3),o.rational(1,2))),st=y.add(n.Constants.one,G),tt=y.subtract(n.Constants.one,G),Y=p.divide(L,ht),ct=nt,yt=p.negate(Y),Ct=p.negate(p.divide(kt,p.multiply(L,ht))),Xt=_.simplify(y.add_all([ct,yt,Ct])),Ut=nt,Gt=p.divide(p.multiply(Y,st),o.integer(2)),Qt=p.divide(p.multiply(tt,kt),V),er=_.simplify(y.add_all([Ut,Gt,Qt])),I=nt,k=p.divide(p.multiply(Y,tt),o.integer(2)),bt=p.divide(p.multiply(st,kt),V),at=_.simplify(y.add_all([I,k,bt]));return[Xt,er,at]}function D(h,N,$,B,X){let{R_DELTA0_toBeCheckedIfZero:J,R_m_b_over_3a:pt,R_DELTA0:_t,R_b3:At,R_a_b_c:ht}=X;if(a.isZeroAtomOrTensor(J))return b.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[pt];b.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let It=p.divide(y.subtract(p.multiply(h,p.multiply(B,o.integer(9))),p.multiply(N,$)),p.multiply(_t,o.integer(2))),Lt=p.negate(At),Yt=p.negate(p.multiply(h,p.multiply(h,p.multiply(B,o.integer(9))))),Bt=p.multiply(ht,o.integer(4)),Zt=p.divide(y.add_all([Bt,Yt,Lt]),p.multiply(h,_t));return[It,It,Zt]}function Z(h,N,$,B,X){return b.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),a.isZeroAtomOrTensor(N)&&a.isZeroAtomOrTensor(B)&&!a.isZeroAtomOrTensor($)&&!a.isZeroAtomOrTensor(X)?F(h,N,$,B,X):a.isZeroAtomOrTensor(N)?Q(h,N,$,B,X):R(h,N,$,B,X)}function F(h,N,$,B,X){b.debug("biquadratic case");let J=O(y.add(p.multiply(h,u.power(n.symbol(n.SECRETX),o.integer(2))),y.add(p.multiply($,n.symbol(n.SECRETX)),X)),n.symbol(n.SECRETX))[0],pt=[];for(let _t of J.tensor.elem)pt.push(_.simplify(u.power(_t,o.rational(1,2)))),pt.push(_.simplify(p.negate(u.power(_t,o.rational(1,2)))));return pt}function Q(h,N,$,B,X){let J=$,pt=B,_t=X,At=p.multiply(o.rational(5,2),J),ht=y.subtract(p.multiply(o.integer(2),u.power(J,o.integer(2))),_t),It=y.add(p.multiply(o.rational(-1,2),p.multiply(J,_t)),y.add(p.divide(u.power(J,o.integer(3)),o.integer(2)),p.multiply(o.rational(-1,8),u.power(pt,o.integer(2))))),Lt=y.add(u.power(n.symbol(n.SECRETX),o.integer(3)),y.add(p.multiply(At,u.power(n.symbol(n.SECRETX),o.integer(2))),y.add(p.multiply(ht,n.symbol(n.SECRETX)),It)));b.debug(`resolventCubic: ${E.top()}`);let Yt=O(Lt,n.symbol(n.SECRETX))[0];b.debug(`resolventCubicSolutions: ${Yt}`);let Bt=null;for(let rt of Yt.tensor.elem){b.debug(`examining solution: ${rt}`);let W=T.absValFloat(y.add(p.multiply(rt,o.integer(2)),J));if(b.debug(`abs value is: ${rt}`),!a.isZeroAtomOrTensor(W)){Bt=rt;break}}b.debug(`chosen solution: ${Bt}`);let Zt=_.simplify(u.power(y.add(p.multiply(Bt,o.integer(2)),J),o.rational(1,2))),ft=_.simplify(p.divide(p.multiply(pt,o.integer(2)),Zt)),gt=y.add(p.multiply(J,o.integer(3)),p.multiply(Bt,o.integer(2))),Pt=_.simplify(u.power(p.negate(y.add(gt,ft)),o.rational(1,2))),kt=p.divide(y.add(Zt,Pt),o.integer(2)),rr=_.simplify(u.power(p.negate(y.add(gt,ft)),o.rational(1,2))),nt=p.divide(y.subtract(Zt,rr),o.integer(2)),Ot=_.simplify(u.power(p.negate(y.subtract(gt,ft)),o.rational(1,2))),w=p.divide(y.add(p.negate(Zt),Ot),o.integer(2)),vt=_.simplify(u.power(p.negate(y.subtract(gt,ft)),o.rational(1,2))),P=p.divide(y.subtract(p.negate(Zt),vt),o.integer(2));return[kt,nt,w,P]}function R(h,N,$,B,X){let J=p.divide(y.add(p.multiply(o.integer(8),p.multiply($,h)),p.multiply(o.integer(-3),u.power(N,o.integer(2)))),p.multiply(o.integer(8),u.power(h,o.integer(2)))),pt=p.divide(y.add(u.power(N,o.integer(3)),y.add(p.multiply(o.integer(-4),p.multiply(h,p.multiply(N,$))),p.multiply(o.integer(8),p.multiply(B,u.power(h,o.integer(2)))))),p.multiply(o.integer(8),u.power(h,o.integer(3)))),_t=p.multiply(p.multiply(h,h),h),At=p.multiply(N,N),ht=p.multiply(p.multiply(h,h),B),It=p.divide(y.add(p.multiply(u.power(N,o.integer(4)),o.integer(-3)),y.add(p.multiply(o.integer(256),p.multiply(_t,X)),y.add(p.multiply(o.integer(-64),p.multiply(ht,N)),p.multiply(o.integer(16),p.multiply(At,p.multiply(h,$)))))),p.multiply(o.integer(256),u.power(h,o.integer(4)))),Lt=u.power(n.symbol(n.SECRETX),o.integer(4)),Yt=p.multiply(J,u.power(n.symbol(n.SECRETX),o.integer(2))),Bt=p.multiply(pt,n.symbol(n.SECRETX)),Zt=_.simplify(y.add_all([Lt,Yt,Bt,It])),ft=O(Zt,n.symbol(n.SECRETX))[0];return b.debug(`p for depressed quartic: ${J}`),b.debug(`q for depressed quartic: ${pt}`),b.debug(`r for depressed quartic: ${It}`),b.debug(`tos 4 ${n.defs.tos}`),b.debug(`4 * x^4: ${Lt}`),b.debug(`R_p * x^2: ${Yt}`),b.debug(`R_q * x: ${Bt}`),b.debug(`R_r: ${It}`),b.debug(`solving depressed quartic: ${Zt}`),b.debug(`depressedSolutions: ${ft}`),ft.tensor.elem.map(gt=>{let Pt=_.simplify(y.subtract(gt,p.divide(N,p.multiply(o.integer(4),h))));return b.debug(`solution from depressed: ${Pt}`),Pt})}}),es=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.simfac=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Tt(),T=jr(),y=wt(),o=qt();function l(i){if(t.isadd(i)){let a=i.tail().map(d);return E.add_all(a)}return d(i)}r.simfac=l;function d(i){if(!t.ismultiply(i))return i;let a=i.tail();for(;s(a););return o.multiply_all_noexpand(a)}function s(i){for(let a=0;a<i.length;a++){let p=i[a];for(let u=0;u<i.length;u++){if(a===u)continue;let _=i[u];if(t.isfactorial(p)&&t.ispower(_)&&y.isminusone(t.caddr(_))&&e.equal(t.cadr(p),t.cadr(_)))return i[a]=T.factorial(E.subtract(t.cadr(p),t.Constants.one)),i[u]=t.Constants.one,!0;if(t.ispower(_)&&y.isminusone(t.caddr(_))&&t.caadr(_)===t.symbol(t.FACTORIAL)&&e.equal(p,t.cadadr(_)))return i[a]=o.reciprocate(T.factorial(E.add(p,t.Constants.negOne))),i[u]=t.Constants.one,!0;if(t.isfactorial(_)){let b=E.subtract(p,t.cadr(_));if(y.isplusone(b))return i[a]=T.factorial(p),i[u]=t.Constants.one,!0}if(t.ispower(p)&&y.isminusone(t.caddr(p))&&t.ispower(_)&&y.isminusone(t.caddr(_))&&t.caadr(_)===t.symbol(t.FACTORIAL)){let b=E.subtract(t.cadr(p),t.cadr(t.cadr(_)));if(y.isplusone(b))return i[a]=o.reciprocate(T.factorial(t.cadr(p))),i[u]=t.Constants.one,!0}if(t.isfactorial(p)&&t.ispower(_)&&y.isminusone(t.caddr(_))&&t.caadr(_)===t.symbol(t.FACTORIAL)){let b=E.subtract(t.cadr(p),t.cadr(t.cadr(_)));if(y.isplusone(b))return i[a]=t.cadr(p),i[u]=t.Constants.one,!0;if(y.isminusone(b))return i[a]=o.reciprocate(t.cadr(t.cadr(_))),i[u]=t.Constants.one,!0;if(y.equaln(b,2))return i[a]=t.cadr(p),i[u]=E.add(t.cadr(p),t.Constants.negOne),!0;if(y.equaln(b,-2))return i[a]=o.reciprocate(t.cadr(t.cadr(_))),i[u]=o.reciprocate(E.add(t.cadr(t.cadr(_)),t.Constants.negOne)),!0}}}return!1}}),ze=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decomp=r.Eval_decomp=void 0;var t=xt(),n=fr(),e=Mt(),E=Ht(),g=Ft(),T=Tt(),y=Er(),o=St(),l=qt();function d(u){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let _=T.Eval(t.cadr(u));u=T.Eval(t.caddr(u));let b=u===t.symbol(t.NIL)?y.guess(_):u,A=i(!1,_,b);e.push(o.makeList(t.symbol(t.NIL),...A))}r.Eval_decomp=d;function s(u,_){return u.length>0&&E.equal(_,u[u.length-1])?!1:(u.push(_),!0)}function i(u,_,b){if(t.DEBUG&&console.log(`DECOMPOSING ${_}`),u){if(!t.iscons(_))return t.DEBUG&&console.log(` ground thing: ${_}`),[_]}else if(!n.Find(_,b))return t.DEBUG&&console.log(" entire expression is constant"),[_];if(t.isadd(_))return a(u,_,b);if(t.ismultiply(_))return p(u,_,b);let A=t.cdr(_);t.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${A}`));let x=[];for(;t.iscons(A);)u&&x.push(t.car(A)),t.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${t.car(A)}`),console.log(`p2: ${b}`)),x.push(...i(u,t.car(A),b)),A=t.cdr(A);return x}r.decomp=i;function a(u,_,b){t.DEBUG&&console.log(" decomposing the sum ");let A=t.cdr(_),x=[];for(;t.iscons(A);)(n.Find(t.car(A),b)||u)&&x.push(...i(u,t.car(A),b)),A=t.cdr(A);A=t.cdr(_);let M=[...A].filter(j=>!n.Find(j,b));return M.length&&(A=g.add_all(M),s(x,A),x.push(l.negate(A))),x}function p(u,_,b){t.DEBUG&&console.log(" decomposing the product ");let A=t.cdr(_),x=[];for(;t.iscons(A);)(n.Find(t.car(A),b)||u)&&x.push(...i(u,t.car(A),b)),A=t.cdr(A);A=t.cdr(_);let M=[];for(;t.iscons(A);){let j=t.car(A);n.Find(j,b)||(M.length<1||!E.equal(j,M[M.length-1]))&&M.push(j),A=t.cdr(A)}return M.length>0&&x.push(l.multiply_all(M)),x}}),Ze=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.transform=void 0;var t=xt(),n=Mt(),e=Kt(),E=Ft(),g=cn(),T=ze(),y=Tt(),o=wt(),l=St(),d=Ur(),s=_r();function i(_,b,A,x){t.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${_}`);let M=a();e.set_binding(t.symbol(t.METAX),b);let j=g.polyform(_,b),q=T.decomp(x,j,b);if(t.DEBUG){console.log(`  ${q.length} decomposed elements ====== `);for(let lt=0;lt<q.length;lt++)console.log(`  decomposition element ${lt}: ${q[lt]}`)}let O=!1,C;if(x){if(!t.isNumericAtom(_)){let lt=A;t.DEBUG&&(console.log(`applying transform: ${lt}`),console.log(`scanning table entry ${lt}`));let H=s.subst(lt,t.symbol(t.SYMBOL_A_UNDERSCORE),t.symbol(t.METAA));H=s.subst(H,t.symbol(t.SYMBOL_B_UNDERSCORE),t.symbol(t.METAB));let U=s.subst(H,t.symbol(t.SYMBOL_X_UNDERSCORE),t.symbol(t.METAX)),v=t.car(U);t.DEBUG&&console.log(`template expression: ${v}`),C=t.cadr(U);let S=t.cddr(U);if(u([t.Constants.one,...q],x,_,v,S))O=!0;else{t.DEBUG&&(console.log(`p3 at this point: ${_}`),console.log(`car(p3): ${t.car(_)}`));let D=[],Z=_;for(t.iscons(Z)&&(D.push(t.car(_)),Z=t.cdr(_));t.iscons(Z);){let F=t.car(Z);Z=t.cdr(Z),t.DEBUG&&(console.log("tos before recursive transform: "+t.defs.tos),console.log(`testing: ${F}`),console.log(`about to try to simplify other term: ${F}`));let[Q,R]=i(F,t.symbol(t.NIL),A,x);O=O||R,D.push(Q),t.DEBUG&&console.log(`tried to simplify other term: ${F} ...successful?: ${R} ...transformed: ${D[D.length-1]}`)}D.length!==0&&(C=l.makeList(...D))}}}else for(let lt of Array.from(A))if(t.DEBUG&&(console.log(`scanning table entry ${lt}`),(lt+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&t.breakpoint),lt){d.scan_meta(lt);let H=n.pop(),U=t.cadr(H);C=t.caddr(H);let v=t.cdddr(H);if(u([t.Constants.one,...q],x,_,U,v)){O=!0;break}}let et=O?y.Eval(C):x?_:t.symbol(t.NIL);return p(M),[et,O]}r.transform=i;function a(){return{METAA:e.get_binding(t.symbol(t.METAA)),METAB:e.get_binding(t.symbol(t.METAB)),METAX:e.get_binding(t.symbol(t.METAX))}}function p(_){e.set_binding(t.symbol(t.METAX),_.METAX),e.set_binding(t.symbol(t.METAB),_.METAB),e.set_binding(t.symbol(t.METAA),_.METAA)}function u(_,b,A,x,M){for(let j of _){e.set_binding(t.symbol(t.METAA),j),t.DEBUG&&console.log(`  binding METAA to ${e.get_binding(t.symbol(t.METAA))}`);for(let q of _){e.set_binding(t.symbol(t.METAB),q),t.DEBUG&&console.log(`  binding METAB to ${e.get_binding(t.symbol(t.METAB))}`);let O=M;for(;t.iscons(O);){let et=y.Eval(t.car(O));if(o.isZeroAtomOrTensor(et))break;O=t.cdr(O)}if(t.iscons(O))continue;let C=b?t.noexpand(y.Eval,x):y.Eval(x);if(t.DEBUG&&(console.log(`about to evaluate template expression: ${x} binding METAA to ${e.get_binding(t.symbol(t.METAA))} and binding METAB to ${e.get_binding(t.symbol(t.METAB))} and binding METAX to ${e.get_binding(t.symbol(t.METAX))}`),console.log(`  comparing ${C} to: ${A}`)),o.isZeroAtomOrTensor(E.subtract(A,C)))return t.DEBUG&&(console.log(`binding METAA to ${e.get_binding(t.symbol(t.METAA))}`),console.log(`binding METAB to ${e.get_binding(t.symbol(t.METAB))}`),console.log(`binding METAX to ${e.get_binding(t.symbol(t.METAX))}`),console.log(`comparing ${A} to: ${x}`)),!0}}return!1}}),He=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.transpose=r.Eval_transpose=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ht(),T=Ft(),y=Nt(),o=Tt(),l=Br(),d=wt(),s=St(),i=qt();function a(u){let _=o.Eval(n.cadr(u)),b=n.Constants.one,A=y.integer(2);n.cddr(u)!==n.symbol(n.NIL)&&(b=o.Eval(n.caddr(u)),A=o.Eval(n.cadddr(u))),E.push(p(_,b,A))}r.Eval_transpose=a;function p(u,_,b){let A=0,x=Array(n.MAXDIM).fill(0),M=Array(n.MAXDIM).fill(0);if(n.isNumericAtom(u)||(d.isplusone(_)&&d.isplustwo(b)||d.isplusone(b)&&d.isplustwo(_))&&n.isidentitymatrix(u))return u;if(n.istranspose(u)){let H=n.car(n.cdr(n.cdr(u))),U=n.car(n.cdr(n.cdr(n.cdr(u))));if(g.equal(H,b)&&g.equal(U,_)||g.equal(U,b)&&g.equal(H,_)||g.equal(H,n.symbol(n.NIL))&&g.equal(U,n.symbol(n.NIL))&&(d.isplusone(b)&&d.isplustwo(_)||d.isplusone(_)&&d.isplustwo(b)))return n.car(n.cdr(u))}if(n.defs.expanding&&n.isadd(u))return u.tail().reduce((H,U)=>T.add(H,p(U,_,b)),n.Constants.zero);if(n.defs.expanding&&n.ismultiply(u))return u.tail().reduce((H,U)=>i.multiply(H,p(U,_,b)),n.Constants.one);if(n.defs.expanding&&n.isinnerordot(u)){let H=[];return n.iscons(u)&&H.push(...u.tail().map(U=>[U,_,b])),H.reverse(),H.reduce((U,v)=>l.inner(U,p(v[0],v[1],v[2])),n.symbol(n.SYMBOL_IDENTITY_MATRIX))}if(!n.istensor(u))return d.isZeroAtomOrTensor(u)?n.Constants.zero:(!d.isplusone(_)||!d.isplustwo(b))&&(!d.isplusone(b)||!d.isplustwo(_))?s.makeList(n.symbol(n.TRANSPOSE),u,_,b):s.makeList(n.symbol(n.TRANSPOSE),u);let{ndim:j,nelem:q}=u.tensor;if(j===1)return u;let O=y.nativeInt(_),C=y.nativeInt(b);(O<1||O>j||C<1||C>j)&&e.stop("transpose: index out of range"),O--,C--,_=t.alloc_tensor(q),_.tensor.ndim=j,_.tensor.dim=[...u.tensor.dim],_.tensor.dim[O]=u.tensor.dim[C],_.tensor.dim[C]=u.tensor.dim[O];let et=u.tensor.elem,lt=_.tensor.elem;for(let H=0;H<j;H++)x[H]=0,M[H]=u.tensor.dim[H];for(let H=0;H<q;H++){A=x[O],x[O]=x[C],x[C]=A,A=M[O],M[O]=M[C],M[C]=A;let U=0;for(let v=0;v<j;v++)U=U*M[v]+x[v];A=x[O],x[O]=x[C],x[C]=A,A=M[O],M[O]=M[C],M[C]=A,lt[U]=et[H];for(let v=j-1;v>=0&&!(++x[v]<M[v]);v--)x[v]=0}return _}r.transpose=p}),Gr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.simplify_trig=r.simplify=r.simplifyForCodeGeneration=r.Eval_simplify=void 0;var t=lr(),n=$r(),e=xt(),E=fr(),g=zt(),T=Mt(),y=Kt(),o=Ht(),l=Ft(),d=Nt(),s=xe(),i=ie(),a=Tt(),p=Sr(),u=Br(),_=wt(),b=St(),A=qt(),x=_e(),M=ir(),j=ae(),q=Kr(),O=wr(),C=Xe(),et=es(),lt=or(),H=Ze(),U=He(),v=Lr(),S=Yr(),D=le(),Z=qr();function F(nt){let Ot=Q(e.cadr(nt)),w=h(a.Eval(Ot));T.push(w)}r.Eval_simplify=F;function Q(nt){if(e.defs.userSimplificationsInListForm.length===0||E.Find(nt,e.symbol(e.INTEGRAL)))return nt;e.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${nt}`);let Ot=e.noexpand(a.Eval,nt);if(e.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${Ot}`),console.log("patterns to be checked: ");for(let P of Array.from(e.defs.userSimplificationsInListForm))console.log(`...${P}`)}let w=!0,vt=0;for(;w&&vt<e.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){w=!1,vt++;for(let P of Array.from(e.defs.userSimplificationsInListForm)){let rt=!0,W=0;for(;rt&&W<e.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)W++,e.DEBUG&&console.log(`simplify - tos: ${e.defs.tos} checking pattern: ${P} on: ${Ot}`),[Ot,rt]=H.transform(Ot,e.symbol(e.NIL),P,!0),rt&&(w=!0),e.DEBUG&&console.log(`p1 at this stage of simplification: ${Ot}`);W===e.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&g.stop(`maximum application of single transformation rule exceeded: ${P}`)}}return vt===e.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&g.stop("maximum application of all transformation rules exceeded "),e.DEBUG&&(console.log(`METAX = ${y.get_binding(e.symbol(e.METAX))}`),console.log(`METAA = ${y.get_binding(e.symbol(e.METAA))}`),console.log(`METAB = ${y.get_binding(e.symbol(e.METAB))}`)),Ot}function R(nt){let Ot=Q(nt);e.defs.codeGen=!0;let w=h(Ot);return e.defs.codeGen=!1,w}r.simplifyForCodeGeneration=R;function h(nt){if(e.defs.codeGen&&e.car(nt)===e.symbol(e.FUNCTION)){let Ot=e.cadr(nt),w=h(a.Eval(Ot)),vt=e.caddr(nt);nt=b.makeList(e.symbol(e.FUNCTION),w,vt)}if(e.istensor(nt))return N(nt);if(E.Find(nt,e.symbol(e.FACTORIAL))){let Ot=et.simfac(nt),w=et.simfac(j.rationalize(nt));nt=n.count(Ot)<n.count(w)?Ot:w}if(nt=J(nt),nt=$(nt),nt=B(nt),nt=X(nt),nt=pt(nt),nt=At(nt),nt=ht(nt),[nt]=Yt(nt),e.do_simplify_nested_radicals){let Ot;if([Ot,nt]=ft(nt),Ot)return e.DEBUG&&console.log("de-nesting successful into: "+nt.toString()),h(nt)}return[nt]=Lt(nt),nt=It(nt),nt}r.simplify=h;function N(nt){let Ot=t.alloc_tensor(nt.tensor.nelem);return Ot.tensor.ndim=nt.tensor.ndim,Ot.tensor.dim=Array.from(nt.tensor.dim),Ot.tensor.elem=nt.tensor.elem.map(h),lt.check_tensor_dimensions(Ot),_.isZeroAtomOrTensor(Ot)&&(Ot=e.Constants.zero),Ot}function $(nt){if(!e.isadd(nt))return nt;let Ot=j.rationalize(nt);return n.count(Ot)<n.count(nt)&&(nt=Ot),nt}function B(nt){if(!e.isadd(nt))return nt;let Ot=i.Condense(nt);return n.count(Ot)<=n.count(nt)&&(nt=Ot),nt}function X(nt){let Ot=j.rationalize(A.negate(j.rationalize(A.negate(j.rationalize(nt)))));return n.count(Ot)<n.count(nt)&&(nt=Ot),nt}function J(nt){let Ot=e.car(nt);if((Ot===e.symbol(e.MULTIPLY)||e.isinnerordot(nt))&&e.car(e.car(e.cdr(nt)))===e.symbol(e.TRANSPOSE)&&e.car(e.car(e.cdr(e.cdr(nt))))===e.symbol(e.TRANSPOSE)){e.DEBUG&&console.log(`maybe collecting a transpose ${nt}`);let w=e.cadr(e.car(e.cdr(nt))),vt=e.cadr(e.car(e.cdr(e.cdr(nt)))),P;Ot===e.symbol(e.MULTIPLY)?P=A.multiply(w,vt):e.isinnerordot(nt)?P=u.inner(vt,w):P=T.pop();let rt=e.noexpand(()=>U.transpose(P,e.Constants.one,d.integer(2)));n.count(rt)<n.count(nt)&&(nt=rt),e.DEBUG&&console.log(`collecting a transpose ${rt}`)}return nt}function pt(nt){if(_.isZeroAtomOrTensor(nt))return nt;let Ot=j.rationalize(A.inverse(j.rationalize(A.inverse(j.rationalize(nt)))));return n.count(Ot)<n.count(nt)&&(nt=Ot),nt}function _t(nt){return At(nt)}r.simplify_trig=_t;function At(nt){if(!E.Find(nt,e.symbol(e.SIN))&&!E.Find(nt,e.symbol(e.COS)))return nt;let Ot=nt;e.defs.trigmode=1;let w=a.Eval(Ot);e.defs.trigmode=2;let vt=a.Eval(Ot);return e.defs.trigmode=0,(n.count(vt)<n.count(w)||Zt(vt)<Zt(w))&&(w=vt),(n.count(w)<n.count(nt)||Zt(w)<Zt(nt))&&(nt=w),nt}function ht(nt){if(!e.isadd(nt))return nt;let Ot=e.cdr(nt);return e.iscons(Ot)&&(Ot=[...Ot].reduce((w,vt)=>It(l.add(w,h(vt))),e.Constants.zero)),n.count(Ot)<n.count(nt)&&(nt=Ot),nt}function It(nt){var Ot,w,vt,P,rt;if(Ot=v.denominator(nt),_.isone(Ot)||(w=Z.numerator(nt),_.isone(w))||!(P=S.areunivarpolysfactoredorexpandedform(w,Ot))||(rt=D.factor(S.gcd(w,Ot),P),_.isone(rt)))return nt;let W=D.factor(w,P),f=A.inverse(rt),L=A.multiply_noexpand(W,f),V=h(L),G=D.factor(Ot,P),st=A.multiply_noexpand(G,f),tt=h(st),Y=A.divide(V,tt);return vt=i.Condense(Y),n.count(vt)<n.count(nt)?vt:nt}function Lt(nt){let Ot;return!E.Find(nt,e.symbol(e.SIN))&&!E.Find(nt,e.symbol(e.COS))?[nt]:(Ot=s.clockform(a.Eval(nt)),e.DEBUG&&console.log(`before simplification clockform: ${nt} after: ${Ot}`),n.count(Ot)<n.count(nt)&&(nt=Ot),[nt])}function Yt(nt){let Ot=Bt(nt),w=a.Eval(Ot);return n.count(w)<n.count(nt)&&(nt=w),[nt]}function Bt(nt){if(_.isimaginaryunit(nt))return nt;if(o.equal(e.car(nt),e.symbol(e.POWER))&&_.isminusone(e.cadr(nt))){let Ot=A.negate(e.Constants.one),w=Bt(e.caddr(nt));return O.rect(x.polar(M.power(Ot,w)))}if(e.iscons(nt)){let Ot=[];for(;e.iscons(nt);)Ot.push(Bt(e.car(nt))),nt=e.cdr(nt);return b.makeList(...Ot)}return nt}function Zt(nt){return e.isadd(nt)?o.length(nt)-1:1}function ft(nt){if(e.defs.recursionLevelNestedRadicalsRemoval>0)return e.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,nt];let[Ot,w]=gt(nt),vt=e.noexpand(i.yycondense,Ot);return nt=n.countOccurrencesOfSymbol(e.symbol(e.POWER),Ot)<n.countOccurrencesOfSymbol(e.symbol(e.POWER),vt)?Ot:vt,[w,nt]}function gt(nt){return e.defs.recursionLevelNestedRadicalsRemoval>0?(e.DEBUG&&console.log("denesting bailing out because of too much recursion"),[nt,!1]):o.equal(e.car(nt),e.symbol(e.POWER))?Pt(nt):e.iscons(nt)?rr(nt):[nt,!1]}function Pt(nt){let Ot=e.cadr(nt),w=e.caddr(nt);if(_.isminusone(w)||!o.equal(e.car(Ot),e.symbol(e.ADD))||!_.isfraction(w)||!_.equalq(w,1,3)&&!_.equalq(w,1,2))return[nt,!1];let vt=e.cadr(Ot);gt(vt);let P=e.caddr(Ot);gt(P);let rt=0,W=Ot;for(;e.cdr(W)!==e.symbol(e.NIL);)rt++,W=e.cdr(W);if(rt>2)return[nt,!1];let{commonBases:f,termsThatAreNotPowers:L}=kt(P);if(f.length===0)return[nt,!1];let V=vt,G=f.reduce(A.multiply,e.Constants.one),st=L.reduce(A.multiply,e.Constants.one),tt;if(_.equalq(w,1,3)){let Gt=A.divide(A.multiply(A.negate(V),G),st),Qt=d.nativeDouble(p.yyfloat(q.real(Gt)));if(Math.abs(Qt)>Math.pow(2,32))return[nt,!1];let er=A.multiply(d.integer(3),G),I=d.nativeDouble(p.yyfloat(q.real(er)));if(Math.abs(I)>Math.pow(2,32))return[nt,!1];let k=A.multiply(er,e.symbol(e.SECRETX)),bt=A.divide(A.multiply(d.integer(-3),V),st),at=d.nativeDouble(p.yyfloat(q.real(bt)));if(Math.abs(at)>Math.pow(2,32))return[nt,!1];tt=l.add_all([Gt,k,A.multiply(bt,M.power(e.symbol(e.SECRETX),d.integer(2))),A.multiply(e.Constants.one,M.power(e.symbol(e.SECRETX),d.integer(3)))])}else if(_.equalq(w,1,2)){let Gt=d.nativeDouble(p.yyfloat(q.real(G)));if(Math.abs(Gt)>Math.pow(2,32))return[nt,!1];let Qt=A.divide(A.multiply(d.integer(-2),V),st),er=d.nativeDouble(p.yyfloat(q.real(Qt)));if(Math.abs(er)>Math.pow(2,32))return[nt,!1];tt=l.add(G,l.add(A.multiply(Qt,e.symbol(e.SECRETX)),A.multiply(e.Constants.one,M.power(e.symbol(e.SECRETX),d.integer(2)))))}e.defs.recursionLevelNestedRadicalsRemoval++;let Y=C.roots(tt,e.symbol(e.SECRETX));if(e.defs.recursionLevelNestedRadicalsRemoval--,o.equal(Y[Y.length-1],e.symbol(e.NIL)))return e.DEBUG&&console.log("roots bailed out because of too much recursion"),[nt,!1];let ct=Y[Y.length-1].elem.filter(Gt=>!E.Find(Gt,e.symbol(e.POWER)));if(ct.length===0)return[nt,!1];let yt=[],Ct=[];for(let Gt of Array.from(ct)){let Qt=d.nativeDouble(p.yyfloat(q.real(Gt)));yt.push(Gt),Ct.push(Qt)}let Xt=Ct.indexOf(Math.max.apply(Math,Ct)),Ut=yt[Xt];if(!_.equalq(w,1,3)&&!_.equalq(w,1,2))return[nt,!1];if(_.equalq(w,1,3)){let Gt=M.power(A.divide(V,l.add(M.power(Ut,d.integer(3)),A.multiply(A.multiply(d.integer(3),G),Ut))),d.rational(1,3)),Qt=A.multiply(Gt,Ut);return[h(l.add(A.multiply(Gt,M.power(G,d.rational(1,2))),Qt)),!0]}if(_.equalq(w,1,2)){let Gt=M.power(A.divide(V,l.add(M.power(Ut,d.integer(2)),G)),d.rational(1,2)),Qt=A.multiply(Gt,Ut),er=h(l.add(A.multiply(Gt,M.power(G,d.rational(1,2))),Qt)),I=p.yyfloat(q.real(er));return _.isnegativenumber(I)?[h(l.add(A.multiply(A.negate(Gt),M.power(G,d.rational(1,2))),A.negate(Qt))),!0]:[er,!0]}return[null,!0]}function kt(nt){let Ot=null,w=[],vt=[];if(e.ismultiply(nt)){let P=e.cdr(nt);if(e.iscons(P))for(;e.iscons(P);){let rt=e.car(P);if(e.ispower(rt)){let W=e.cadr(rt),f=e.caddr(rt);_.equalq(f,1,2)&&(Ot==null?(Ot=f,w.push(W)):o.equal(f,Ot)&&w.push(W))}else vt.push(rt);P=e.cdr(P)}}else if(e.ispower(nt)){let P=e.cadr(nt),rt=e.caddr(nt);Ot==null&&_.equalq(rt,1,2)&&(Ot=rt,w.push(P))}return{commonBases:w,termsThatAreNotPowers:vt}}function rr(nt){let Ot=!1,w=[];if(e.iscons(nt)){let vt=Array.from(nt).map(P=>{if(!Ot){let rt;return[rt,Ot]=gt(P),rt}return P});w.push(...vt)}return[b.makeList(...w),Ot]}}),Nr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.absval=r.abs=r.absValFloat=r.Eval_abs=void 0;var t=xt(),n=fr(),e=zt(),E=Mt(),g=Ht(),T=Ft(),y=Nt(),o=zr(),l=Lr(),d=Tt(),s=Sr(),i=ue(),a=Br(),p=wt(),u=St(),_=qt(),b=qr(),A=ir(),x=Kr(),M=wr(),j=Gr(),q=!1;function O(U){let v=et(d.Eval(t.cadr(U)));E.push(v)}r.Eval_abs=O;function C(U){return s.zzfloat(d.Eval(lt(d.Eval(U))))}r.absValFloat=C;function et(U){let v=b.numerator(U),S=lt(v),D=l.denominator(U),Z=lt(D),F=_.divide(S,Z);return q&&(console.trace(">>>>  ABS of "+U),console.log(`ABS numerator ${v}`),console.log(`ABSVAL numerator: ${S}`),console.log(`ABS denominator: ${D}`),console.log(`ABSVAL denominator: ${Z}`),console.log(`ABSVAL divided: ${F}`),console.log("<<<<<<<  ABS")),F}r.abs=et;function lt(U){let v=U;if(q&&console.log(`ABS of ${U}`),p.isZeroAtomOrTensor(U))return q&&(console.log(` abs: ${U} just zero`),console.log(" --> ABS of "+v+" : "+t.Constants.zero)),t.Constants.zero;if(p.isnegativenumber(U))return q&&console.log(` abs: ${U} just a negative`),_.negate(U);if(p.ispositivenumber(U))return q&&(console.log(` abs: ${U} just a positive`),console.log(` --> ABS of ${v} : ${U}`)),U;if(U===t.symbol(t.PI))return q&&(console.log(` abs: ${U} of PI`),console.log(` --> ABS of ${v} : ${U}`)),U;if(t.isadd(U)&&(n.findPossibleClockForm(U,U)||n.findPossibleExponentialForm(U)||n.Find(U,t.Constants.imaginaryunit))){q&&(console.log(` abs: ${U} is a sum`),console.log("abs of a sum")),U=M.rect(U);let D=j.simplify_trig(A.power(T.add(A.power(x.real(U),y.integer(2)),A.power(i.imag(U),y.integer(2))),y.rational(1,2)));return q&&console.log(` --> ABS of ${v} : ${D}`),D}if(t.ispower(U)&&p.equaln(t.cadr(U),-1)){let D=t.Constants.One();if(q){console.log(` abs: ${U} is -1 to any power`);let Z=t.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(Z),console.log(` --> ABS of ${v} : ${D}`)}return D}if(t.ispower(U)&&p.ispositivenumber(t.caddr(U))){let D=A.power(et(t.cadr(U)),t.caddr(U));return q&&(console.log(` abs: ${U} is something to the power of a positive number`),console.log(` --> ABS of ${v} : ${D}`)),D}if(t.ispower(U)&&t.cadr(U)===t.symbol(t.E)){let D=g.exponential(x.real(t.caddr(U)));return q&&(console.log(` abs: ${U} is an exponential`),console.log(` --> ABS of ${v} : ${D}`)),D}if(t.ismultiply(U)){let D=U.tail().map(lt).reduce(_.multiply);return q&&(console.log(` abs: ${U} is a product`),console.log(` --> ABS of ${v} : ${D}`)),D}if(t.car(U)===t.symbol(t.ABS)){let D=u.makeList(t.symbol(t.ABS),t.cadr(U));return q&&(console.log(` abs: ${U} is abs of a abs`),console.log(` --> ABS of ${v} : ${D}`)),D}if(t.istensor(U))return H(U);(p.isnegativeterm(U)||t.isadd(U)&&p.isnegativeterm(t.cadr(U)))&&(U=_.negate(U));let S=u.makeList(t.symbol(t.ABS),U);return q&&(console.log(` abs: ${U} is nothing decomposable`),console.log(` --> ABS of ${v} : ${S}`)),S}r.absval=lt;function H(U){return U.tensor.ndim!==1&&e.stop("abs(tensor) with tensor rank > 1"),d.Eval(j.simplify(A.power(a.inner(U,o.conjugate(U)),y.rational(1,2))))}}),Ve=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.testApprox=r.approxAll=r.approxRationalsOfLogs=r.approxRadicals=r.Eval_approxratio=void 0;var t=lr(),n=xt(),e=Mt(),E=Nt(),g=Sr(),T=St(),y=or();function o(R){e.push(l(n.cadr(R)))}r.Eval_approxratio=o;function l(R){if(n.istensor(R)){let h=t.alloc_tensor(R.tensor.nelem);return h.tensor.ndim=R.tensor.ndim,h.tensor.dim=Array.from(R.tensor.dim),h.tensor.elem=h.tensor.elem.map(N=>{let $=l(N);return y.check_tensor_dimensions(h),$}),h}return R.k===n.DOUBLE?d(R):n.iscons(R)?new n.Cons(l(n.car(R)),l(n.cdr(R))):R}function d(R){let h=g.zzfloat(R);if(h.k===n.DOUBLE){let N=h.d,$=N.toString().split(".");if($.length===2){let B=$[1].length,X=1/Math.pow(10,B),J=s(N,X);return E.rational(J[0],J[1])}return E.integer(N)}return T.makeList(n.symbol(n.APPROXRATIO),h)}function s(R,h){if(isNaN(R))return[0,0];if(R===1/0)return[1,0];if(R===-1/0)return[-1,0];let N=R<0?-1:1;if(R=Math.abs(R),Math.abs(R-Math.floor(R))<h)return[R*N,1];if(R<1e-19)return[N,1e19];if(R>1e19)return[1e19*N,1];let $=R,B=0,X=1,J;for(;;){$=1/($-Math.floor($));let pt=X;if(X=X*Math.floor($)+B,B=pt,J=Math.floor(R*X+.5),!(Math.abs(R-J/X)>h)||$===Math.floor($))break}return J=N*J,[J,X]}var i=0,a=1,p=2,u=3,_=4,b=6,A=7,x=8,M=9;function j(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X of[2,3,5,6,7,8,10])for(let J=1;J<=10;J++){let pt,_t,At,ht=Math.sqrt(X)/J;if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),pt<2*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * sqrt( ${X} ) / ${J}`,b,_t,X,J])}}return $}function q(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X of[1,2,3,5,6,7,8,10])for(let J of[1,2,3,5,6,7,8,10]){let pt,_t,At,ht=Math.sqrt(X/J);if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),pt<2*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * (sqrt( ${X} / ${J} )`,_,_t,X,J])}}return $}function O(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=j(R);if($!=null)return $;let B=q(R);return B??null}r.approxRadicals=O;function C(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=et(R);if($!=null)return $;let B=lt(R);return B??null}function et(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=2;X<=5;X++)for(let J=1;J<=5;J++){let pt,_t,At,ht=Math.log(X)/J;if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),!(_t!==1&&Math.abs(Math.floor(_t/J))===Math.abs(_t/J))&&pt<2.2*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * log( ${X} ) / ${J}`,M,_t,X,J])}}return $}r.approxRationalsOfLogs=et;function lt(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=1;X<=5;X++)for(let J=1;J<=5;J++){let pt,_t,At,ht=Math.log(X/J);if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),pt<1.96*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * log( ${X} / ${J} )`,x,_t,X,J])}}return $}function H(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=1;X<=2;X++)for(let J=1;J<=12;J++){let pt,_t,At,ht=Math.pow(Math.E,X)/J;if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),pt<2*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * (e ^ ${X} ) / ${J}`,A,_t,X,J])}}return $}function U(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=1;X<=5;X++)for(let J=1;J<=12;J++){let pt,_t,At,ht=Math.pow(Math.PI,X)/J;if(Math.abs(ht)>1e-10?(At=R/ht,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-ht)),pt<2*h){let It=F(_t,X,J);It<B&&(B=It,$=[`${_t} * (pi ^ ${X} ) / ${J} )`,u,_t,X,J])}}return $}function v(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=S(R);if($!=null)return $;let B=D(R);return B??null}function S(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=1;X<=4;X++)for(let J=1;J<=4;J++){let pt,_t,At,ht=X/J,It=Math.sin(ht);if(Math.abs(It)>1e-10?(At=R/It,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-It)),pt<2*h){let Lt=F(_t,X,J);Lt<B&&(B=Lt,$=[`${_t} * sin( ${X}/${J} )`,a,_t,X,J])}}return $}function D(R){let h,N=R.toString().split(".");if(N.length===2){let X=N[1].length;h=1/Math.pow(10,X)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=null,B=Number.MAX_VALUE;for(let X=1;X<=13;X++)for(let J=1;J<=13;J++){let pt,_t,At,ht=X/J,It=Math.sin(Math.PI*ht);if(Math.abs(It)>1e-10?(At=R/It,_t=Math.round(At),pt=Math.abs(1-At/_t)):(At=1,_t=1,pt=Math.abs(R-It)),pt<23*h){let Lt=F(_t,X,J);Lt<B&&(B=Lt,$=[`${_t} * sin( ${X}/${J} * pi )`,p,_t,X,J])}}return $}function Z(R){let h,N=R.toString().split(".");if(N.length===2){let Lt=N[1].length;h=1/Math.pow(10,Lt)}else return[""+Math.floor(R),i,Math.floor(R),1,2];console.log(`precision: ${h}`);let $=Number.MAX_VALUE,B=0,X=null,J=!0,pt=O(R);pt!=null&&(B=F(pt),B<$?(J&&console.log(`better explanation by approxRadicals: ${pt} complexity: ${B}`),$=B,X=pt):J&&console.log(`subpar explanation by approxRadicals: ${pt} complexity: ${B}`));let _t=C(R);_t!=null&&(B=F(_t),B<$?(J&&console.log(`better explanation by approxLogs: ${_t} complexity: ${B}`),$=B,X=_t):J&&console.log(`subpar explanation by approxLogs: ${_t} complexity: ${B}`));let At=H(R);At!=null&&(B=F(At),B<$?(J&&console.log(`better explanation by approxRationalsOfPowersOfE: ${At} complexity: ${B}`),$=B,X=At):J&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${At} complexity: ${B}`));let ht=U(R);ht!=null&&(B=F(ht),B<$?(J&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${ht} complexity: ${B}`),$=B,X=ht):J&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${ht} complexity: ${B}`));let It=v(R);return It!=null&&(B=F(It),B<$?(J&&console.log(`better explanation by approxTrigonometric: ${It} complexity: ${B}`),$=B,X=It):J&&console.log(`subpar explanation by approxTrigonometric: ${It} complexity: ${B}`)),X}r.approxAll=Z;function F(R,h,N){let $=0;if(R instanceof Array){switch(R[1]){case p:$=4;break;case u:$=Math.pow(4,Math.abs(R[3]))*Math.abs(R[2]);break;case A:$=Math.pow(3,Math.abs(R[3]))*Math.abs(R[2]);break;default:$=0}$+=Math.abs(R[2])*(Math.abs(R[3])+Math.abs(R[4]))}else $+=Math.abs(R)*(Math.abs(h)+Math.abs(N));return R[2]===1?$-=1:$+=1,R[3]===1?$-=1:$+=1,R[4]===1?$-=1:$+=1,$<0&&($=0),$}function Q(){for(let h of[2,3,5,6,7,8,10])for(let N of[2,3,5,6,7,8,10]){if(h===N)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${h} ) / ${N}`);let $=h/N,B=Math.sqrt(h)/N,X=O(B),J=X[2]*Math.sqrt(X[3])/X[4];Math.abs(B-J)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${h} ) / ${N} . obtained: ${X}`)}for(let h of[2,3,5,6,7,8,10])for(let N of[2,3,5,6,7,8,10]){if(h===N)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${h} ) / ${N}`);let $=h/N,B=Math.sqrt(h)/N,X=B.toFixed(4),J=O(Number(X)),pt=J[2]*Math.sqrt(J[3])/J[4];Math.abs(B-pt)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${h} ) / ${N} . obtained: ${J}`)}for(let h of[2,3,5,6,7,8,10])for(let N of[2,3,5,6,7,8,10]){if(h===N)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${h} / ${N} )`);let $=h/N,B=Math.sqrt(h/N),X=O(B);if(X!=null){let J=X[2]*Math.sqrt(X[3]/X[4]);X[1]===_&&Math.abs(B-J)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${h} / ${N} ) . obtained: ${X}`)}}for(let h of[1,2,3,5,6,7,8,10])for(let N of[1,2,3,5,6,7,8,10]){if(h===1&&N===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${h} / ${N} )`);let $=h/N,B=Math.sqrt(h/N),X=B.toFixed(4),J=O(Number(X)),pt=J[2]*Math.sqrt(J[3]/J[4]);J[1]===_&&Math.abs(B-pt)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${h} / ${N} ) . obtained: ${J}`)}for(let h=1;h<=5;h++)for(let N=1;N<=5;N++){console.log(`testApproxAll testing: 1 * log(${h} ) / ${N}`);let $=h/N,B=Math.log(h)/N,X=Z(B),J=X[2]*Math.log(X[3])/X[4];Math.abs(B-J)>1e-15&&console.log(`fail testApproxAll: 1 * log(${h} ) / ${N} . obtained: ${X}`)}for(let h=1;h<=5;h++)for(let N=1;N<=5;N++){console.log(`testApproxAll testing with 4 digits: 1 * log(${h} ) / ${N}`);let $=h/N,B=Math.log(h)/N,X=B.toFixed(4),J=Z(Number(X)),pt=J[2]*Math.log(J[3])/J[4];Math.abs(B-pt)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${h} ) / ${N} . obtained: ${J}`)}for(let h=1;h<=5;h++)for(let N=1;N<=5;N++){console.log(`testApproxAll testing: 1 * log(${h} / ${N} )}`);let $=h/N,B=Math.log(h/N),X=Z(B),J=X[2]*Math.log(X[3]/X[4]);Math.abs(B-J)>1e-15&&console.log(`fail testApproxAll: 1 * log(${h} / ${N} ) . obtained: ${X}`)}for(let h=1;h<=5;h++)for(let N=1;N<=5;N++){console.log(`testApproxAll testing with 4 digits: 1 * log(${h} / ${N} )`);let $=h/N,B=Math.log(h/N),X=B.toFixed(4),J=Z(Number(X)),pt=J[2]*Math.log(J[3]/J[4]);Math.abs(B-pt)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${h} / ${N} ) . obtained: ${J}`)}for(let h=1;h<=2;h++)for(let N=1;N<=12;N++){console.log(`testApproxAll testing: 1 * (e ^ ${h} ) / ${N}`);let $=h/N,B=Math.pow(Math.E,h)/N,X=Z(B),J=X[2]*Math.pow(Math.E,X[3])/X[4];Math.abs(B-J)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${h} ) / ${N} . obtained: ${X}`)}for(let h=1;h<=2;h++)for(let N=1;N<=12;N++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${h} ) / ${N}`);let $=h/N,B=Math.pow(Math.E,h)/N,X=B.toFixed(4),J=H(Number(X)),pt=J[2]*Math.pow(Math.E,J[3])/J[4];Math.abs(B-pt)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${h} ) / ${N} . obtained: ${J}`)}for(let h=1;h<=2;h++)for(let N=1;N<=12;N++){console.log(`testApproxAll testing: 1 * pi ^ ${h} / ${N}`);let $=h/N,B=Math.pow(Math.PI,h)/N,X=Z(B),J=X[2]*Math.pow(Math.PI,X[3])/X[4];Math.abs(B-J)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${h} / ${N} ) . obtained: ${X}`)}for(let h=1;h<=2;h++)for(let N=1;N<=12;N++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${h} / ${N}`);let $=h/N,B=Math.pow(Math.PI,h)/N,X=B.toFixed(4),J=U(Number(X)),pt=J[2]*Math.pow(Math.PI,J[3])/J[4];Math.abs(B-pt)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${h} / ${N} ) . obtained: ${J}`)}for(let h=1;h<=4;h++)for(let N=1;N<=4;N++){console.log(`testApproxAll testing: 1 * sin( ${h}/${N} )}`);let $=h/N,B=Math.sin($),X=Z(B),J=X[3]/X[4],pt=X[2]*Math.sin(J);Math.abs(B-pt)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${h}/${N} ) . obtained: ${X}`)}for(let h=1;h<=4;h++)for(let N=1;N<=4;N++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${h}/${N} )`);let $=h/N,B=Math.sin($),X=B.toFixed(5),J=Z(Number(X));J==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${h}/${N} ) . obtained:  undefined `);let pt=J[3]/J[4],_t=J[2]*Math.sin(pt),At=Math.abs(B-_t);At>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${h}/${N} ) . obtained: ${J} error: ${At}`)}for(let h=1;h<=4;h++)for(let N=1;N<=4;N++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${h}/${N} )`);let $=h/N,B=Math.sin($),X=B.toFixed(4),J=Z(Number(X));J==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${h}/${N} ) . obtained:  undefined `);let pt=J[3]/J[4],_t=J[2]*Math.sin(pt),At=Math.abs(B-_t);At>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${h}/${N} ) . obtained: ${J} error: ${At}`)}let R=0;Z(R)[0]!=="0"&&console.log("fail testApproxAll: 0"),R=0,Z(R)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),R=0,Z(R)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),R=0,Z(R)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),R=0,Z(R)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),R=Math.sqrt(2),Z(R)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),R=1.41,Z(R)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),R=1.4,O(R)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),R=.6,C(R)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),R=.69,C(R)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),R=.7,C(R)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),R=1.09,C(R)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),R=1.09,Z(R)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),R=1.098,Z(R)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),R=1.1,Z(R)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),R=1.11,Z(R)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),R=Math.sqrt(3),Z(R)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),R=1,Z(R)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),R=3.141592,Z(R)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),R=31.41592,Z(R)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),R=314.1592,Z(R)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),R=3141592653589793e-8,Z(R)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),R=Math.sqrt(2),v(R)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),R=Math.sqrt(3),v(R)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),R=(Math.sqrt(6)-Math.sqrt(2))/4,Z(R)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),R=Math.sqrt(2-Math.sqrt(2))/2,Z(R)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),R=(Math.sqrt(6)+Math.sqrt(2))/4,Z(R)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),R=Math.sqrt(2+Math.sqrt(3))/2,Z(R)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),R=(Math.sqrt(5)-1)/4,Z(R)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),R=Math.sqrt(10-2*Math.sqrt(5))/4,Z(R)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),R=Math.sin(Math.PI/7),Z(R)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),R=Math.sin(Math.PI/9),Z(R)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),R=1836.15267,U(R)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let h=1;h<=13;h++)for(let N=1;N<=13;N++){console.log(`approxTrigonometric testing: 1 * sin( ${h}/${N} * pi )`);let $=h/N;R=Math.sin(Math.PI*$);let B=v(R),X=B[3]/B[4],J=B[2]*Math.sin(Math.PI*X);Math.abs(R-J)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${h}/${N} * pi ) . obtained: ${B}`)}for(let h=1;h<=13;h++)for(let N=1;N<=13;N++){if(h===5&&N===11||h===6&&N===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${h}/${N} * pi )`);let $=h/N,B=Math.sin(Math.PI*$),X=B.toFixed(4),J=v(Number(X)),pt=J[3]/J[4],_t=J[2]*Math.sin(Math.PI*pt),At=Math.abs(B-_t);At>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${h}/${N} * pi ) . obtained: ${J} error: ${At}`)}return console.log("testApprox done")}r.testApprox=Q}),ns=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_arccos=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St(),y=qt();function o(d){n.push(l(E.Eval(t.cadr(d))))}r.Eval_arccos=o;function l(d){if(t.car(d)===t.symbol(t.COS))return t.cadr(d);if(t.isdouble(d))return e.double(Math.acos(d.d));if(g.isoneoversqrttwo(d)||t.ismultiply(d)&&g.equalq(t.car(t.cdr(d)),1,2)&&t.car(t.car(t.cdr(t.cdr(d))))===t.symbol(t.POWER)&&g.equaln(t.car(t.cdr(t.car(t.cdr(t.cdr(d))))),2)&&g.equalq(t.car(t.cdr(t.cdr(t.car(t.cdr(t.cdr(d)))))),1,2))return t.defs.evaluatingAsFloats?e.double(Math.PI/4):y.multiply(e.rational(1,4),t.symbol(t.PI));if(g.isminusoneoversqrttwo(d)||t.ismultiply(d)&&g.equalq(t.car(t.cdr(d)),-1,2)&&t.car(t.car(t.cdr(t.cdr(d))))===t.symbol(t.POWER)&&g.equaln(t.car(t.cdr(t.car(t.cdr(t.cdr(d))))),2)&&g.equalq(t.car(t.cdr(t.cdr(t.car(t.cdr(t.cdr(d)))))),1,2))return t.defs.evaluatingAsFloats?e.double(Math.PI*3/4):y.multiply(e.rational(3,4),t.symbol(t.PI));if(g.isSqrtThreeOverTwo(d))return t.defs.evaluatingAsFloats?e.double(Math.PI/6):y.multiply(e.rational(1,6),t.symbol(t.PI));if(g.isMinusSqrtThreeOverTwo(d))return t.defs.evaluatingAsFloats?e.double(5*Math.PI/6):y.multiply(e.rational(5,6),t.symbol(t.PI));if(!t.isrational(d))return T.makeList(t.symbol(t.ARCCOS),d);switch(e.nativeInt(y.multiply(d,e.integer(2)))){case-2:return t.Constants.Pi();case-1:return t.defs.evaluatingAsFloats?e.double(Math.PI*2/3):y.multiply(e.rational(2,3),t.symbol(t.PI));case 0:return t.defs.evaluatingAsFloats?e.double(Math.PI/2):y.multiply(e.rational(1,2),t.symbol(t.PI));case 1:return t.defs.evaluatingAsFloats?e.double(Math.PI/3):y.multiply(e.rational(1,3),t.symbol(t.PI));case 2:return t.Constants.Zero();default:return T.makeList(t.symbol(t.ARCCOS),d)}}}),ss=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_arccosh=void 0;var t=xt(),n=zt(),e=Mt(),E=Nt(),g=Tt(),T=wt(),y=St();function o(d){e.push(l(g.Eval(t.cadr(d))))}r.Eval_arccosh=o;function l(d){if(t.car(d)===t.symbol(t.COSH))return t.cadr(d);if(t.isdouble(d)){let{d:s}=d;return s<1&&n.stop("arccosh function argument is less than 1.0"),s=Math.log(s+Math.sqrt(s*s-1)),E.double(s)}return T.isplusone(d)?t.Constants.zero:y.makeList(t.symbol(t.ARCCOSH),d)}}),os=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_arcsin=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St(),y=qt();function o(d){n.push(l(E.Eval(t.cadr(d))))}r.Eval_arcsin=o;function l(d){if(t.car(d)===t.symbol(t.SIN))return t.cadr(d);if(t.isdouble(d))return e.double(Math.asin(d.d));if(g.isoneoversqrttwo(d)||t.ismultiply(d)&&g.equalq(t.car(t.cdr(d)),1,2)&&t.car(t.car(t.cdr(t.cdr(d))))===t.symbol(t.POWER)&&g.equaln(t.car(t.cdr(t.car(t.cdr(t.cdr(d))))),2)&&g.equalq(t.car(t.cdr(t.cdr(t.car(t.cdr(t.cdr(d)))))),1,2))return y.multiply(e.rational(1,4),t.symbol(t.PI));if(g.isminusoneoversqrttwo(d)||t.ismultiply(d)&&g.equalq(t.car(t.cdr(d)),-1,2)&&t.car(t.car(t.cdr(t.cdr(d))))===t.symbol(t.POWER)&&g.equaln(t.car(t.cdr(t.car(t.cdr(t.cdr(d))))),2)&&g.equalq(t.car(t.cdr(t.cdr(t.car(t.cdr(t.cdr(d)))))),1,2))return t.defs.evaluatingAsFloats?e.double(-Math.PI/4):y.multiply(e.rational(-1,4),t.symbol(t.PI));if(g.isSqrtThreeOverTwo(d))return t.defs.evaluatingAsFloats?e.double(Math.PI/3):y.multiply(e.rational(1,3),t.symbol(t.PI));if(g.isMinusSqrtThreeOverTwo(d))return t.defs.evaluatingAsFloats?e.double(-Math.PI/3):y.multiply(e.rational(-1,3),t.symbol(t.PI));if(!t.isrational(d))return T.makeList(t.symbol(t.ARCSIN),d);switch(e.nativeInt(y.multiply(d,e.integer(2)))){case-2:return t.defs.evaluatingAsFloats?e.double(-Math.PI/2):y.multiply(e.rational(-1,2),t.symbol(t.PI));case-1:return t.defs.evaluatingAsFloats?e.double(-Math.PI/6):y.multiply(e.rational(-1,6),t.symbol(t.PI));case 0:return t.Constants.Zero();case 1:return t.defs.evaluatingAsFloats?e.double(Math.PI/6):y.multiply(e.rational(1,6),t.symbol(t.PI));case 2:return t.defs.evaluatingAsFloats?e.double(Math.PI/2):y.multiply(e.rational(1,2),t.symbol(t.PI));default:return T.makeList(t.symbol(t.ARCSIN),d)}}}),is=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_arcsinh=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St();function y(l){n.push(o(E.Eval(t.cadr(l))))}r.Eval_arcsinh=y;function o(l){if(t.car(l)===t.symbol(t.SINH))return t.cadr(l);if(t.isdouble(l)){let{d}=l;return d=Math.log(d+Math.sqrt(d*d+1)),e.double(d)}return g.isZeroAtomOrTensor(l)?t.Constants.zero:T.makeList(t.symbol(t.ARCSINH),l)}}),as=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_arctanh=void 0;var t=xt(),n=zt(),e=Mt(),E=Nt(),g=Tt(),T=wt(),y=St();function o(d){e.push(l(g.Eval(t.cadr(d))))}r.Eval_arctanh=o;function l(d){if(t.car(d)===t.symbol(t.TANH))return t.cadr(d);if(t.isdouble(d)){let{d:s}=d;return(s<-1||s>1)&&n.stop("arctanh function argument is not in the interval [-1,1]"),s=Math.log((1+s)/(1-s))/2,E.double(s)}return T.isZeroAtomOrTensor(d)?t.Constants.zero:y.makeList(t.symbol(t.ARCTANH),d)}}),We=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.besselj=r.Eval_besselj=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=kr(),T=Tt(),y=wt(),o=St(),l=qt(),d=ir(),s=pr(),i=Pr();function a(_){let b=p(T.Eval(t.cadr(_)),T.Eval(t.caddr(_)));n.push(b)}r.Eval_besselj=a;function p(_,b){return u(_,b)}r.besselj=p;function u(_,b){let A=E.nativeInt(b);if(t.isdouble(_)&&!isNaN(A)){let x=i.jn(A,_.d);return E.double(x)}if(y.isZeroAtomOrTensor(_)&&y.isZeroAtomOrTensor(b))return t.Constants.one;if(y.isZeroAtomOrTensor(_)&&!isNaN(A))return t.Constants.zero;if(b.k===t.NUM&&t.MEQUAL(b.q.b,2)){if(t.MEQUAL(b.q.a,1)){let M=t.defs.evaluatingAsFloats?E.double(2/Math.PI):l.divide(E.integer(2),t.symbol(t.PI));return l.multiply(d.power(l.divide(M,_),E.rational(1,2)),s.sine(_))}if(t.MEQUAL(b.q.a,-1)){let M=t.defs.evaluatingAsFloats?E.double(2/Math.PI):l.divide(E.integer(2),t.symbol(t.PI));return l.multiply(d.power(l.divide(M,_),E.rational(1,2)),g.cosine(_))}let x=E.integer(t.MSIGN(b.q.a));return e.subtract(l.multiply(l.multiply(l.divide(E.integer(2),_),e.subtract(b,x)),p(_,e.subtract(b,x))),p(_,e.subtract(b,l.multiply(E.integer(2),x))))}return y.isnegativeterm(_)?l.multiply(l.multiply(d.power(l.negate(_),b),d.power(_,l.negate(b))),o.makeList(t.symbol(t.BESSELJ),l.negate(_),b)):y.isnegativeterm(b)?l.multiply(d.power(t.Constants.negOne,b),o.makeList(t.symbol(t.BESSELJ),_,l.negate(b))):o.makeList(t.symbol(t.BESSELJ),_,b)}}),Je=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bessely=r.Eval_bessely=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St(),y=qt(),o=ir(),l=Pr();function d(a){let p=s(E.Eval(t.cadr(a)),E.Eval(t.caddr(a)));n.push(p)}r.Eval_bessely=d;function s(a,p){return i(a,p)}r.bessely=s;function i(a,p){let u=e.nativeInt(p);if(t.isdouble(a)&&!isNaN(u)){let _=l.yn(u,a.d);return e.double(_)}return g.isnegativeterm(p)?y.multiply(o.power(t.Constants.negOne,p),T.makeList(t.symbol(t.BESSELY),a,y.negate(p))):T.makeList(t.symbol(t.BESSELY),a,p)}}),ls=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_binomial=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Tt(),T=jr(),y=qt();function o(i){let a=g.Eval(t.cadr(i)),p=g.Eval(t.caddr(i)),u=l(a,p);n.push(u)}r.Eval_binomial=o;function l(i,a){return d(i,a)}function d(i,a){return s(i,a)?y.divide(y.divide(T.factorial(i),T.factorial(a)),T.factorial(E.subtract(i,a))):t.Constants.zero}function s(i,a){return t.isNumericAtom(i)&&e.lessp(i,t.Constants.zero)||t.isNumericAtom(a)&&e.lessp(a,t.Constants.zero)?!1:!(t.isNumericAtom(i)&&t.isNumericAtom(a)&&e.lessp(i,a))}}),us=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_ceiling=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Tt(),T=wt(),y=St(),o=Tr();function l(i){let a=d(g.Eval(t.cadr(i)));n.push(a)}r.Eval_ceiling=l;function d(i){return s(i)}function s(i){if(!t.isNumericAtom(i))return y.makeList(t.symbol(t.CEILING),i);if(t.isdouble(i))return E.double(Math.ceil(i.d));if(T.isinteger(i))return i;let a=new t.Num(o.mdiv(i.q.a,i.q.b));return T.isnegativenumber(i)||(a=e.add(a,t.Constants.one)),a}}),cs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_choose=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Tt(),T=jr(),y=qt();function o(s){let i=g.Eval(t.cadr(s)),a=g.Eval(t.caddr(s)),p=l(i,a);n.push(p)}r.Eval_choose=o;function l(s,i){return d(s,i)?y.divide(y.divide(T.factorial(s),T.factorial(i)),T.factorial(E.subtract(s,i))):t.Constants.zero}function d(s,i){return t.isNumericAtom(s)&&e.lessp(s,t.Constants.zero)||t.isNumericAtom(i)&&e.lessp(i,t.Constants.zero)?!1:!(t.isNumericAtom(s)&&t.isNumericAtom(i)&&e.lessp(s,i))}}),Ke=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.expcos=r.Eval_expcos=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=Tt(),y=qt();function o(d){let s=l(T.Eval(t.cadr(d)));n.push(s)}r.Eval_expcos=o;function l(d){return E.add(y.multiply(e.exponential(y.multiply(t.Constants.imaginaryunit,d)),g.rational(1,2)),y.multiply(e.exponential(y.multiply(y.negate(t.Constants.imaginaryunit),d)),g.rational(1,2)))}r.expcos=l}),Qe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.expsin=r.Eval_expsin=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=Tt(),y=qt();function o(d){let s=l(T.Eval(t.cadr(d)));n.push(s)}r.Eval_expsin=o;function l(d){return E.subtract(y.multiply(y.divide(e.exponential(y.multiply(t.Constants.imaginaryunit,d)),t.Constants.imaginaryunit),g.rational(1,2)),y.multiply(y.divide(e.exponential(y.multiply(y.negate(t.Constants.imaginaryunit),d)),t.Constants.imaginaryunit),g.rational(1,2)))}r.expsin=l}),ds=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_circexp=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=Tt(),y=Ke(),o=Qe(),l=qt(),d=or();function s(a){let p=i(T.Eval(t.cadr(a)));n.push(T.Eval(p))}r.Eval_circexp=s;function i(a){if(t.car(a)===t.symbol(t.COS))return y.expcos(t.cadr(a));if(t.car(a)===t.symbol(t.SIN))return o.expsin(t.cadr(a));if(t.car(a)===t.symbol(t.TAN)){a=t.cadr(a);let p=e.exponential(l.multiply(t.Constants.imaginaryunit,a)),u=e.exponential(l.negate(l.multiply(t.Constants.imaginaryunit,a)));return l.divide(l.multiply(E.subtract(u,p),t.Constants.imaginaryunit),E.add(p,u))}return t.car(a)===t.symbol(t.COSH)?(a=t.cadr(a),l.multiply(E.add(e.exponential(a),e.exponential(l.negate(a))),g.rational(1,2))):t.car(a)===t.symbol(t.SINH)?(a=t.cadr(a),l.multiply(E.subtract(e.exponential(a),e.exponential(l.negate(a))),g.rational(1,2))):t.car(a)===t.symbol(t.TANH)?(a=e.exponential(l.multiply(t.cadr(a),g.integer(2))),l.divide(E.subtract(a,t.Constants.one),E.add(a,t.Constants.one))):t.iscons(a)?a.map(i):(a.k===t.TENSOR&&(a=d.copy_tensor(a),a.tensor.elem=a.tensor.elem.map(i)),a)}}),de=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defn=r.init=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=St(),T=Ir(),y=Ur(),o=xt(),l=Kt(),d=0;function s(){if(d=0,o.reset_after_error(),o.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],d)return;d=1;for(let b=0;b<o.NSYM;b++)o.symtab[b]=new o.Sym(""),o.binding[b]=o.symtab[b],o.isSymbolReclaimable[b]=!1;let[u,_]=a()}r.init=s;var i=['version="'+t.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function a(){let u=o.symbol(o.NIL),_=o.symbol(o.NIL);l.std_symbol("abs",o.ABS),l.std_symbol("add",o.ADD),l.std_symbol("adj",o.ADJ),l.std_symbol("and",o.AND),l.std_symbol("approxratio",o.APPROXRATIO),l.std_symbol("arccos",o.ARCCOS),l.std_symbol("arccosh",o.ARCCOSH),l.std_symbol("arcsin",o.ARCSIN),l.std_symbol("arcsinh",o.ARCSINH),l.std_symbol("arctan",o.ARCTAN),l.std_symbol("arctanh",o.ARCTANH),l.std_symbol("arg",o.ARG),l.std_symbol("atomize",o.ATOMIZE),l.std_symbol("besselj",o.BESSELJ),l.std_symbol("bessely",o.BESSELY),l.std_symbol("binding",o.BINDING),l.std_symbol("binomial",o.BINOMIAL),l.std_symbol("ceiling",o.CEILING),l.std_symbol("check",o.CHECK),l.std_symbol("choose",o.CHOOSE),l.std_symbol("circexp",o.CIRCEXP),l.std_symbol("clear",o.CLEAR),l.std_symbol("clearall",o.CLEARALL),l.std_symbol("clearpatterns",o.CLEARPATTERNS),l.std_symbol("clock",o.CLOCK),l.std_symbol("coeff",o.COEFF),l.std_symbol("cofactor",o.COFACTOR),l.std_symbol("condense",o.CONDENSE),l.std_symbol("conj",o.CONJ),l.std_symbol("contract",o.CONTRACT),l.std_symbol("cos",o.COS),l.std_symbol("cosh",o.COSH),l.std_symbol("decomp",o.DECOMP),l.std_symbol("defint",o.DEFINT),l.std_symbol("deg",o.DEGREE),l.std_symbol("denominator",o.DENOMINATOR),l.std_symbol("det",o.DET),l.std_symbol("derivative",o.DERIVATIVE),l.std_symbol("dim",o.DIM),l.std_symbol("dirac",o.DIRAC),l.std_symbol("divisors",o.DIVISORS),l.std_symbol("do",o.DO),l.std_symbol("dot",o.DOT),l.std_symbol("draw",o.DRAW),l.std_symbol("dsolve",o.DSOLVE),l.std_symbol("erf",o.ERF),l.std_symbol("erfc",o.ERFC),l.std_symbol("eigen",o.EIGEN),l.std_symbol("eigenval",o.EIGENVAL),l.std_symbol("eigenvec",o.EIGENVEC),l.std_symbol("eval",o.EVAL),l.std_symbol("exp",o.EXP),l.std_symbol("expand",o.EXPAND),l.std_symbol("expcos",o.EXPCOS),l.std_symbol("expsin",o.EXPSIN),l.std_symbol("factor",o.FACTOR),l.std_symbol("factorial",o.FACTORIAL),l.std_symbol("factorpoly",o.FACTORPOLY),l.std_symbol("filter",o.FILTER),l.std_symbol("float",o.FLOATF),l.std_symbol("floor",o.FLOOR),l.std_symbol("for",o.FOR),l.std_symbol("function",o.FUNCTION),l.std_symbol("Gamma",o.GAMMA),l.std_symbol("gcd",o.GCD),l.std_symbol("hermite",o.HERMITE),l.std_symbol("hilbert",o.HILBERT),l.std_symbol("imag",o.IMAG),l.std_symbol("component",o.INDEX),l.std_symbol("inner",o.INNER),l.std_symbol("integral",o.INTEGRAL),l.std_symbol("inv",o.INV),l.std_symbol("invg",o.INVG),l.std_symbol("isinteger",o.ISINTEGER),l.std_symbol("isprime",o.ISPRIME),l.std_symbol("laguerre",o.LAGUERRE),l.std_symbol("lcm",o.LCM),l.std_symbol("leading",o.LEADING),l.std_symbol("legendre",o.LEGENDRE),l.std_symbol("log",o.LOG),l.std_symbol("lookup",o.LOOKUP),l.std_symbol("mod",o.MOD),l.std_symbol("multiply",o.MULTIPLY),l.std_symbol("not",o.NOT),l.std_symbol("nroots",o.NROOTS),l.std_symbol("number",o.NUMBER),l.std_symbol("numerator",o.NUMERATOR),l.std_symbol("operator",o.OPERATOR),l.std_symbol("or",o.OR),l.std_symbol("outer",o.OUTER),l.std_symbol("pattern",o.PATTERN),l.std_symbol("patternsinfo",o.PATTERNSINFO),l.std_symbol("polar",o.POLAR),l.std_symbol("power",o.POWER),l.std_symbol("prime",o.PRIME),l.std_symbol("print",o.PRINT),l.std_symbol("print2dascii",o.PRINT2DASCII),l.std_symbol("printcomputer",o.PRINTFULL),l.std_symbol("printlatex",o.PRINTLATEX),l.std_symbol("printlist",o.PRINTLIST),l.std_symbol("printhuman",o.PRINTPLAIN),l.std_symbol("printLeaveEAlone",o.PRINT_LEAVE_E_ALONE),l.std_symbol("printLeaveXAlone",o.PRINT_LEAVE_X_ALONE),l.std_symbol("product",o.PRODUCT),l.std_symbol("quote",o.QUOTE),l.std_symbol("quotient",o.QUOTIENT),l.std_symbol("rank",o.RANK),l.std_symbol("rationalize",o.RATIONALIZE),l.std_symbol("real",o.REAL),l.std_symbol("rect",o.YYRECT),l.std_symbol("roots",o.ROOTS),l.std_symbol("round",o.ROUND),l.std_symbol("equals",o.SETQ),l.std_symbol("sgn",o.SGN),l.std_symbol("silentpattern",o.SILENTPATTERN),l.std_symbol("simplify",o.SIMPLIFY),l.std_symbol("sin",o.SIN),l.std_symbol("sinh",o.SINH),l.std_symbol("shape",o.SHAPE),l.std_symbol("sqrt",o.SQRT),l.std_symbol("stop",o.STOP),l.std_symbol("subst",o.SUBST),l.std_symbol("sum",o.SUM),l.std_symbol("symbolsinfo",o.SYMBOLSINFO),l.std_symbol("tan",o.TAN),l.std_symbol("tanh",o.TANH),l.std_symbol("taylor",o.TAYLOR),l.std_symbol("test",o.TEST),l.std_symbol("testeq",o.TESTEQ),l.std_symbol("testge",o.TESTGE),l.std_symbol("testgt",o.TESTGT),l.std_symbol("testle",o.TESTLE),l.std_symbol("testlt",o.TESTLT),l.std_symbol("transpose",o.TRANSPOSE),l.std_symbol("unit",o.UNIT),l.std_symbol("zero",o.ZERO),l.std_symbol("nil",o.NIL),l.std_symbol("autoexpand",o.AUTOEXPAND),l.std_symbol("bake",o.BAKE),l.std_symbol("assumeRealVariables",o.ASSUME_REAL_VARIABLES),l.std_symbol("last",o.LAST),l.std_symbol("lastprint",o.LAST_PRINT),l.std_symbol("last2dasciiprint",o.LAST_2DASCII_PRINT),l.std_symbol("lastfullprint",o.LAST_FULL_PRINT),l.std_symbol("lastlatexprint",o.LAST_LATEX_PRINT),l.std_symbol("lastlistprint",o.LAST_LIST_PRINT),l.std_symbol("lastplainprint",o.LAST_PLAIN_PRINT),l.std_symbol("trace",o.TRACE),l.std_symbol("forceFixedPrintout",o.FORCE_FIXED_PRINTOUT),l.std_symbol("maxFixedPrintoutDigits",o.MAX_FIXED_PRINTOUT_DIGITS),l.std_symbol("~",o.YYE),l.std_symbol("$DRAWX",o.DRAWX),l.std_symbol("$METAA",o.METAA),l.std_symbol("$METAB",o.METAB),l.std_symbol("$METAX",o.METAX),l.std_symbol("$SECRETX",o.SECRETX),l.std_symbol("version",o.VERSION),l.std_symbol("pi",o.PI),l.std_symbol("a",o.SYMBOL_A),l.std_symbol("b",o.SYMBOL_B),l.std_symbol("c",o.SYMBOL_C),l.std_symbol("d",o.SYMBOL_D),l.std_symbol("i",o.SYMBOL_I),l.std_symbol("j",o.SYMBOL_J),l.std_symbol("n",o.SYMBOL_N),l.std_symbol("r",o.SYMBOL_R),l.std_symbol("s",o.SYMBOL_S),l.std_symbol("t",o.SYMBOL_T),l.std_symbol("x",o.SYMBOL_X),l.std_symbol("y",o.SYMBOL_Y),l.std_symbol("z",o.SYMBOL_Z),l.std_symbol("I",o.SYMBOL_IDENTITY_MATRIX),l.std_symbol("a_",o.SYMBOL_A_UNDERSCORE),l.std_symbol("b_",o.SYMBOL_B_UNDERSCORE),l.std_symbol("x_",o.SYMBOL_X_UNDERSCORE),l.std_symbol("$C1",o.C1),l.std_symbol("$C2",o.C2),l.std_symbol("$C3",o.C3),l.std_symbol("$C4",o.C4),l.std_symbol("$C5",o.C5),l.std_symbol("$C6",o.C6),p();let b=o.defs.codeGen;o.defs.codeGen=!1;for(let A=0;A<i.length;A++){let x=i[A];y.scan(x),o.DEBUG&&(console.log(`... evaling ${x}`),console.log("top of stack:"),console.log(T.print_list(n.top()))),E.Eval(n.pop())}return o.defs.codeGen=b,[u,_]}r.defn=a;function p(){let u=g.makeList(o.symbol(o.POWER),e.integer(-1),e.rational(1,2));o.DEBUG&&console.log(T.print_list(u)),o.Constants.imaginaryunit=u}}),tn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_patternsinfo=r.Eval_clearpatterns=r.do_clearPatterns=r.Eval_pattern=r.Eval_silentpattern=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Ht(),T=St(),y=Ir();function o(p){l(p),e.pop(),E.push_symbol(t.NIL)}r.Eval_silentpattern=o;function l(p){let u;t.iscons(t.cdr(p))||n.stop("pattern needs at least a template and a transformed version");let _=t.car(t.cdr(p)),b=t.car(t.cdr(t.cdr(p)));b===t.symbol(t.NIL)&&n.stop("pattern needs at least a template and a transformed version"),t.iscons(t.cdr(t.cdr(p)))?u=t.car(t.cdr(t.cdr(t.cdr(p)))):u=t.symbol(t.NIL),g.equal(_,b)&&n.stop("recursive pattern");let A="template: "+y.print_list(_);A+=" tests: "+y.print_list(u),t.DEBUG&&console.log(`pattern stringkey: ${A}`);let x=t.defs.userSimplificationsInStringForm.indexOf(A);x===-1?(t.defs.userSimplificationsInStringForm.push(A),t.defs.userSimplificationsInListForm.push(t.cdr(p))):(t.DEBUG&&console.log(`pattern already exists, replacing. ${t.cdr(p)}`),t.defs.userSimplificationsInStringForm[x]=A,t.defs.userSimplificationsInListForm[x]=t.cdr(p)),e.push(T.makeList(t.symbol(t.PATTERN),t.cdr(p)))}r.Eval_pattern=l;function d(){t.defs.userSimplificationsInListForm=[],t.defs.userSimplificationsInStringForm=[]}r.do_clearPatterns=d;function s(){d(),E.push_symbol(t.NIL)}r.Eval_clearpatterns=s;function i(){let p=a();p!==""?g.new_string(p):E.push_symbol(t.NIL)}r.Eval_patternsinfo=i;function a(){let p="";for(let u of Array.from(t.defs.userSimplificationsInListForm))p+=t.defs.userSimplificationsInListForm+`
`;return p}}),rn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_clear=r.clearRenamedVariablesToAvoidBindingToExternalScope=r.do_clearall=r.Eval_clearall=void 0;var t=xt(),n=de(),e=Pr(),E=zt(),g=Mt(),T=Kt(),y=tn();function o(){let[i,a]=l();g.push(t.symbol(t.NIL))}r.Eval_clearall=o;function l(){t.defs.test_flag||e.clear_term(),y.do_clearPatterns(),T.clear_symbols();let[i,a]=n.defn();return[t.defs.codeGen=!1,i,a]}r.do_clearall=l;function d(){for(let i=0;i<t.symtab.length;i++)t.symtab[i].printname.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&(t.symtab[i].k=t.SYM,t.symtab[i].printname="",t.binding[i]=t.symtab[i],t.isSymbolReclaimable[i]=!0)}r.clearRenamedVariablesToAvoidBindingToExternalScope=d;function s(i){let a;for(a=t.cdr(i);t.iscons(a);){let p=t.car(a);p.k!==t.SYM&&E.stop("symbol error");let u=t.symtab.indexOf(p);t.symtab[u].k=t.SYM,t.symtab[u].printname="",t.binding[u]=t.symtab[u],t.isSymbolReclaimable[u]=!0,a=t.cdr(a)}g.push(t.symbol(t.NIL))}r.Eval_clear=s}),fs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_contract=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ft(),T=Nt(),y=Tt(),o=wt();function l(s){let i=y.Eval(n.cadr(s)),a,p;n.cddr(s)===n.symbol(n.NIL)?(a=n.Constants.one,p=T.integer(2)):(a=y.Eval(n.caddr(s)),p=y.Eval(n.cadddr(s)));let u=d(i,a,p);E.push(u)}r.Eval_contract=l;function d(s,i,a){let p=[],u=[];if(!n.istensor(s))return o.isZeroAtomOrTensor(s)||e.stop("contract: tensor expected, 1st arg is not a tensor"),n.Constants.zero;let _=T.nativeInt(i),b=T.nativeInt(a),{ndim:A}=s.tensor;(_<1||_>A||b<1||b>A||_===b||s.tensor.dim[_-1]!==s.tensor.dim[b-1])&&e.stop("contract: index out of range"),_--,b--;let x=s.tensor.dim[_],M=1;for(let C=0;C<A;C++)C!==_&&C!==b&&(M*=s.tensor.dim[C]);i=t.alloc_tensor(M),i.tensor.ndim=A-2;let j=0;for(let C=0;C<A;C++)C!==_&&C!==b&&(i.tensor.dim[j++]=s.tensor.dim[C]);let q=s.tensor.elem,O=i.tensor.elem;for(let C=0;C<A;C++)p[C]=0,u[C]=s.tensor.dim[C];for(let C=0;C<M;C++){let et=n.Constants.zero;for(let lt=0;lt<x;lt++){p[_]=lt,p[b]=lt;let H=0;for(let U=0;U<A;U++)H=H*u[U]+p[U];et=g.add(et,q[H])}O[C]=et;for(let lt=A-1;lt>=0;lt--)if(!(lt===_||lt===b)){if(++p[lt]<u[lt])break;p[lt]=0}}return M===1?O[0]:i}}),en=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ycosh=r.Eval_cosh=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St();function y(l){let d=o(E.Eval(t.cadr(l)));n.push(d)}r.Eval_cosh=y;function o(l){if(t.car(l)===t.symbol(t.ARCCOSH))return t.cadr(l);if(t.isdouble(l)){let d=Math.cosh(l.d);return Math.abs(d)<1e-10&&(d=0),e.double(d)}return g.isZeroAtomOrTensor(l)?t.Constants.one:T.makeList(t.symbol(t.COSH),l)}r.ycosh=o}),ps=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_function_reference=r.define_user_function=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Tt(),T=St();function y(l){let d=t.caadr(l),s=t.cdadr(l),i=t.caddr(l);t.issymbol(d)||n.stop("function name?"),t.car(i)===t.symbol(t.EVAL)&&(i=g.Eval(t.cadr(i))),i=T.makeList(t.symbol(t.FUNCTION),i,s),E.set_binding(d,i),E.push_symbol(t.NIL)}r.define_user_function=y;function o(l){e.push(l)}r.Eval_function_reference=o}),nn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dirac=r.Eval_dirac=void 0;var t=xt(),n=Mt(),e=Tt(),E=wt(),g=St(),T=Tr(),y=qt();function o(s){let i=l(e.Eval(t.cadr(s)));n.push(i)}r.Eval_dirac=o;function l(s){return d(s)}r.dirac=l;function d(s){return t.isdouble(s)?s.d===0?t.Constants.one:t.Constants.zero:t.isrational(s)?t.MZERO(T.mmul(s.q.a,s.q.b))?t.Constants.one:t.Constants.zero:t.ispower(s)?g.makeList(t.symbol(t.DIRAC),t.cadr(s)):E.isnegativeterm(s)?g.makeList(t.symbol(t.DIRAC),y.negate(s)):((E.isnegativeterm(s)||t.isadd(s)&&E.isnegativeterm(t.cadr(s)))&&(s=y.negate(s)),g.makeList(t.symbol(t.DIRAC),s))}}),sn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hermite=void 0;var t=xt(),n=Ft(),e=Nt(),E=Tt(),g=St(),T=qt(),y=_r();function o(s,i){return l(s,i)}r.hermite=o;function l(s,i){let a=e.nativeInt(i);return a<0||isNaN(a)?g.makeList(t.symbol(t.HERMITE),s,i):t.issymbol(s)?d(a,s):E.Eval(y.subst(d(a,t.symbol(t.SECRETX)),t.symbol(t.SECRETX),s))}function d(s,i){let a=t.Constants.zero,p=t.Constants.one;for(let u=0;u<s;u++){let _=a;a=p,p=T.multiply(n.subtract(T.multiply(i,a),T.multiply(e.integer(u),_)),e.integer(2))}return p}}),on=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.logarithm=r.Eval_log=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Lr(),T=Tt(),y=wt(),o=St(),l=qt(),d=qr();function s(a){let p=i(T.Eval(t.cadr(a)));n.push(p)}r.Eval_log=s;function i(a){return a===t.symbol(t.E)?t.Constants.one:y.equaln(a,1)?t.Constants.zero:y.isnegativenumber(a)?e.add(i(l.negate(a)),l.multiply(t.Constants.imaginaryunit,t.Constants.Pi())):t.isdouble(a)?E.double(Math.log(a.d)):y.isfraction(a)?e.subtract(i(d.numerator(a)),i(g.denominator(a))):t.ispower(a)?l.multiply(t.caddr(a),i(t.cadr(a))):t.ismultiply(a)?a.tail().map(i).reduce(e.add,t.Constants.zero):o.makeList(t.symbol(t.LOG),a)}r.logarithm=i}),an=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sgn=r.Eval_sgn=void 0;var t=xt(),n=Mt(),e=Nr(),E=Tt(),g=wt(),T=St(),y=Tr(),o=qt(),l=ir();function d(i){let a=s(E.Eval(t.cadr(i)));n.push(a)}r.Eval_sgn=d;function s(i){return t.isdouble(i)?i.d>0||i.d===0?t.Constants.one:t.Constants.negOne:t.isrational(i)?t.MSIGN(y.mmul(i.q.a,i.q.b))===-1?t.Constants.negOne:t.MZERO(y.mmul(i.q.a,i.q.b))?t.Constants.zero:t.Constants.one:g.iscomplexnumber(i)?o.multiply(l.power(t.Constants.negOne,e.absval(i)),i):g.isnegativeterm(i)?o.multiply(T.makeList(t.symbol(t.SGN),o.negate(i)),t.Constants.negOne):T.makeList(t.symbol(t.SGN),i)}r.sgn=s}),ln=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ysinh=r.Eval_sinh=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St();function y(l){let d=o(E.Eval(t.cadr(l)));n.push(d)}r.Eval_sinh=y;function o(l){if(t.car(l)===t.symbol(t.ARCSINH))return t.cadr(l);if(t.isdouble(l)){let d=Math.sinh(l.d);return Math.abs(d)<1e-10&&(d=0),e.double(d)}return g.isZeroAtomOrTensor(l)?t.Constants.zero:T.makeList(t.symbol(t.SINH),l)}r.ysinh=o}),Zr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.derivative=r.Eval_derivative=void 0;var t=xt(),n=fr(),e=zt(),E=Mt(),g=Ht(),T=Ft(),y=We(),o=Je(),l=Nt(),d=kr(),s=en(),i=nn(),a=Tt(),p=Er(),u=sn(),_=fe(),b=wt(),A=St(),x=on(),M=qt(),j=ir(),q=an(),O=Gr(),C=pr(),et=ln(),lt=_r(),H=or();function U(W){W=t.cdr(W);let f=a.Eval(t.car(W));W=t.cdr(W);let L,V,G=a.Eval(t.car(W));for(G===t.symbol(t.NIL)?(L=p.guess(f),V=t.symbol(t.NIL)):t.isNumericAtom(G)?(L=p.guess(f),V=G):(L=G,W=t.cdr(W),V=a.Eval(t.car(W)));;){let st;t.isNumericAtom(V)?(st=l.nativeInt(V),isNaN(st)&&e.stop("nth derivative: check n")):st=1;let tt=f;if(st>=0)for(let Y=0;Y<st;Y++)tt=v(tt,L);else{st=-st;for(let Y=0;Y<st;Y++)tt=_.integral(tt,L)}if(f=tt,V===t.symbol(t.NIL))break;if(t.isNumericAtom(V)){if(W=t.cdr(W),V=a.Eval(t.car(W)),V===t.symbol(t.NIL))break;t.isNumericAtom(V)||(L=V,W=t.cdr(W),V=a.Eval(t.car(W)))}else L=V,W=t.cdr(W),V=a.Eval(t.car(W))}E.push(f)}r.Eval_derivative=U;function v(W,f){return t.isNumericAtom(f)&&e.stop("undefined function"),t.istensor(W)?t.istensor(f)?H.d_tensor_tensor(W,f):H.d_tensor_scalar(W,f):t.istensor(f)?H.d_scalar_tensor(W,f):S(W,f)}r.derivative=v;function S(W,f){if(t.issymbol(f))return D(W,f);let L=lt.subst(W,f,t.symbol(t.SECRETX));return lt.subst(v(L,t.symbol(t.SECRETX)),t.symbol(t.SECRETX),f)}function D(W,f){if(g.equal(W,f))return t.Constants.one;if(!t.iscons(W))return t.Constants.zero;if(t.isadd(W))return Z(W,f);switch(t.car(W)){case t.symbol(t.MULTIPLY):return F(W,f);case t.symbol(t.POWER):return Q(W,f);case t.symbol(t.DERIVATIVE):return h(W,f);case t.symbol(t.LOG):return R(W,f);case t.symbol(t.SIN):return $(W,f);case t.symbol(t.COS):return B(W,f);case t.symbol(t.TAN):return X(W,f);case t.symbol(t.ARCSIN):return J(W,f);case t.symbol(t.ARCCOS):return pt(W,f);case t.symbol(t.ARCTAN):return _t(W,f);case t.symbol(t.SINH):return At(W,f);case t.symbol(t.COSH):return ht(W,f);case t.symbol(t.TANH):return It(W,f);case t.symbol(t.ARCSINH):return Lt(W,f);case t.symbol(t.ARCCOSH):return Yt(W,f);case t.symbol(t.ARCTANH):return Bt(W,f);case t.symbol(t.ABS):return Zt(W,f);case t.symbol(t.SGN):return ft(W,f);case t.symbol(t.HERMITE):return gt(W,f);case t.symbol(t.ERF):return Pt(W,f);case t.symbol(t.ERFC):return kt(W,f);case t.symbol(t.BESSELJ):return rr(W,f);case t.symbol(t.BESSELY):return w(W,f);default:}return t.car(W)===t.symbol(t.INTEGRAL)&&t.caddr(W)===f?rt(W):N(W,f)}function Z(W,f){let L=t.iscons(W)?W.tail().map(V=>v(V,f)):[];return T.add_all(L)}function F(W,f){let L=g.length(W)-1,V=[];for(let G=0;G<L;G++){let st=[],tt=t.cdr(W);for(let Y=0;Y<L;Y++){let ct=t.car(tt);G===Y&&(ct=v(ct,f)),st.push(ct),tt=t.cdr(tt)}V.push(M.multiply_all(st))}return T.add_all(V)}function Q(W,f){let L=M.divide(t.caddr(W),t.cadr(W)),V=v(t.cadr(W),f),G=x.logarithm(t.cadr(W)),st=v(t.caddr(W),f);return M.multiply(T.add(M.multiply(L,V),M.multiply(G,st)),W)}function R(W,f){let L=v(t.cadr(W),f);return M.divide(L,t.cadr(W))}function h(W,f){let L=v(t.cadr(W),f);return t.car(L)===t.symbol(t.DERIVATIVE)?g.lessp(t.caddr(L),t.caddr(W))?A.makeList(t.symbol(t.DERIVATIVE),A.makeList(t.symbol(t.DERIVATIVE),t.cadr(L),t.caddr(L)),t.caddr(W)):A.makeList(t.symbol(t.DERIVATIVE),A.makeList(t.symbol(t.DERIVATIVE),t.cadr(L),t.caddr(W)),t.caddr(L)):v(L,t.caddr(W))}function N(W,f){let L=t.cdr(W);return L===t.symbol(t.NIL)||n.Find(L,f)?A.makeList(t.symbol(t.DERIVATIVE),W,f):t.Constants.zero}function $(W,f){let L=v(t.cadr(W),f);return M.multiply(L,d.cosine(t.cadr(W)))}function B(W,f){let L=v(t.cadr(W),f);return M.negate(M.multiply(L,C.sine(t.cadr(W))))}function X(W,f){let L=v(t.cadr(W),f);return M.multiply(L,j.power(d.cosine(t.cadr(W)),l.integer(-2)))}function J(W,f){let L=v(t.cadr(W),f);return M.multiply(L,j.power(T.subtract(t.Constants.one,j.power(t.cadr(W),l.integer(2))),l.rational(-1,2)))}function pt(W,f){let L=v(t.cadr(W),f);return M.negate(M.multiply(L,j.power(T.subtract(t.Constants.one,j.power(t.cadr(W),l.integer(2))),l.rational(-1,2))))}function _t(W,f){let L=v(t.cadr(W),f);return O.simplify(M.multiply(L,M.inverse(T.add(t.Constants.one,j.power(t.cadr(W),l.integer(2))))))}function At(W,f){let L=v(t.cadr(W),f);return M.multiply(L,s.ycosh(t.cadr(W)))}function ht(W,f){let L=v(t.cadr(W),f);return M.multiply(L,et.ysinh(t.cadr(W)))}function It(W,f){let L=v(t.cadr(W),f);return M.multiply(L,j.power(s.ycosh(t.cadr(W)),l.integer(-2)))}function Lt(W,f){let L=v(t.cadr(W),f);return M.multiply(L,j.power(T.add(j.power(t.cadr(W),l.integer(2)),t.Constants.one),l.rational(-1,2)))}function Yt(W,f){let L=v(t.cadr(W),f);return M.multiply(L,j.power(T.add(j.power(t.cadr(W),l.integer(2)),t.Constants.negOne),l.rational(-1,2)))}function Bt(W,f){let L=v(t.cadr(W),f);return M.multiply(L,M.inverse(T.subtract(t.Constants.one,j.power(t.cadr(W),l.integer(2)))))}function Zt(W,f){let L=v(t.cadr(W),f);return M.multiply(L,q.sgn(t.cadr(W)))}function ft(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(L,i.dirac(t.cadr(W))),l.integer(2))}function gt(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(L,M.multiply(l.integer(2),t.caddr(W))),u.hermite(t.cadr(W),T.add(t.caddr(W),t.Constants.negOne)))}function Pt(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(M.multiply(g.exponential(M.multiply(j.power(t.cadr(W),l.integer(2)),t.Constants.negOne)),j.power(t.Constants.Pi(),l.rational(-1,2))),l.integer(2)),L)}function kt(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(M.multiply(g.exponential(M.multiply(j.power(t.cadr(W),l.integer(2)),t.Constants.negOne)),j.power(t.Constants.Pi(),l.rational(-1,2))),l.integer(-2)),L)}function rr(W,f){return b.isZeroAtomOrTensor(t.caddr(W))?nt(W,f):Ot(W,f)}function nt(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(L,y.besselj(t.cadr(W),t.Constants.one)),t.Constants.negOne)}function Ot(W,f){let L=v(t.cadr(W),f);return M.multiply(L,T.add(y.besselj(t.cadr(W),T.add(t.caddr(W),t.Constants.negOne)),M.multiply(M.divide(M.multiply(t.caddr(W),t.Constants.negOne),t.cadr(W)),y.besselj(t.cadr(W),t.caddr(W)))))}function w(W,f){return b.isZeroAtomOrTensor(t.caddr(W))?vt(W,f):P(W,f)}function vt(W,f){let L=v(t.cadr(W),f);return M.multiply(M.multiply(L,y.besselj(t.cadr(W),t.Constants.one)),t.Constants.negOne)}function P(W,f){let L=v(t.cadr(W),f);return M.multiply(L,T.add(o.bessely(t.cadr(W),T.add(t.caddr(W),t.Constants.negOne)),M.multiply(M.divide(M.multiply(t.caddr(W),t.Constants.negOne),t.cadr(W)),o.bessely(t.cadr(W),t.caddr(W)))))}function rt(W){return t.cadr(W)}}),ms=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.partition=void 0;var t=xt(),n=fr(),e=qt();function E(g,T){let y=t.Constants.one,o=y;if(g=t.cdr(g),!t.iscons(g))return[y,o];for(let l of g)n.Find(l,T)?o=e.multiply(o,l):y=e.multiply(y,l);return[y,o]}r.partition=E}),fe=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.make_hashed_itab=r.integral=r.Eval_integral=void 0;var t=xt(),n=fr(),e=zt(),E=Mt(),g=Kt(),T=Ht(),y=Ft(),o=Nt(),l=Zr(),d=Tt(),s=Er(),i=wt(),a=St(),p=qt(),u=ms(),_=Ur(),b=Gr(),A=Ze(),x=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function M(F){let Q=0;F=t.cdr(F);let R=d.Eval(t.car(F));F=t.cdr(F);let h=d.Eval(t.car(F)),N,$;for(h===t.symbol(t.NIL)?($=s.guess(R),N=t.symbol(t.NIL)):t.isNumericAtom(h)?($=s.guess(R),N=h):($=h,F=t.cdr(F),N=d.Eval(t.car(F)));;){t.isNumericAtom(N)?(Q=o.nativeInt(N),isNaN(Q)&&e.stop("nth integral: check n")):Q=1;let B=R;if(Q>=0)for(let X=0;X<Q;X++)B=j(B,$);else{Q=-Q;for(let X=0;X<Q;X++)B=l.derivative(B,$)}if(R=B,N===t.symbol(t.NIL))break;if(t.isNumericAtom(N)){if(F=t.cdr(F),N=d.Eval(t.car(F)),N===t.symbol(t.NIL))break;t.isNumericAtom(N)||($=N,F=t.cdr(F),N=d.Eval(t.car(F)))}else $=N,F=t.cdr(F),N=d.Eval(t.car(F))}E.push(R)}r.Eval_integral=M;function j(F,Q){let R;return t.isadd(F)?R=q(F,Q):t.ismultiply(F)?R=O(F,Q):R=C(F,Q),n.Find(R,t.symbol(t.INTEGRAL))&&e.stop("integral: sorry, could not find a solution"),d.Eval(b.simplify(R))}r.integral=j;function q(F,Q){F=t.cdr(F);let R=j(t.car(F),Q);return t.iscons(F)&&(R=F.tail().reduce((h,N)=>y.add(h,j(N,Q)),R)),R}function O(F,Q){let[R,h]=u.partition(F,Q);return p.multiply(R,C(h,Q))}function C(F,Q){let R=lt(F,Q).toFixed(6),h=Z[R];if(!h)return a.makeList(t.symbol(t.INTEGRAL),F,Q);let[N,$]=A.transform(F,Q,h,!1);return N===t.symbol(t.NIL)?a.makeList(t.symbol(t.INTEGRAL),F,Q):N}var et={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function lt(F,Q){if(t.issymbol(F))return T.equal(F,Q)?et.x:et.constant;if(t.iscons(F))switch(g.symnum(t.car(F))){case t.ADD:return U(t.cdr(F),Q);case t.MULTIPLY:return v(t.cdr(F),Q);case t.POWER:return S(t.cadr(F),t.caddr(F),Q);case t.EXP:return S(t.symbol(t.E),t.cadr(F),Q);case t.SQRT:o.push_double(.5);var R=E.pop();return S(t.cadr(F),R,Q);default:return H(F,Q)}return et.constant}function H(F,Q){if(!n.Find(t.cadr(F),Q))return et.constant;let R=t.car(F),h=lt(t.cadr(F),Q),N=et[R.printname];if(!N)throw new Error("Unsupported function "+R.printname);return Math.pow(N,h)}function U(F,Q){let R={};for(;t.iscons(F);){let N=t.car(F);F=t.cdr(F);let $=0;n.Find(N,Q)?$=lt(N,Q):$=et.constant,R[$.toFixed(6)]=!0}let h=0;for(let N of Object.keys(R||{})){let $=R[N];h=h+Number(N)}return h}function v(F,Q){let R=1;return t.iscons(F)&&[...F].forEach(h=>{n.Find(h,Q)&&(R=R*lt(h,Q))}),R}function S(F,Q,R){let h=et.constant,N=et.constexp;if(n.Find(F,R)&&(h=lt(F,R)),n.Find(Q,R))N=lt(Q,R);else{if(h===et.constant)return et.constant;i.isminusone(Q)?N=-1:i.isoneovertwo(Q)?N=.5:i.isminusoneovertwo(Q)?N=-.5:i.equalq(Q,2,1)?N=2:i.equalq(Q,-2,1)&&(N=-2)}return Math.pow(h,N)}function D(){let F={};for(let Q of Array.from(x)){_.scan_meta(Q);let R=E.pop(),h=t.cadr(R),N=lt(h,t.symbol(t.METAX)).toFixed(6);F[N]||(F[N]=[]),F[N].push(Q)}return console.log(`hashed_itab = ${JSON.stringify(F,null,2)}`),F}r.make_hashed_itab=D;var Z={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}}),bs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_defint=void 0;var t=xt(),n=Mt(),e=Ft(),E=Tt(),g=fe(),T=_r();function y(o){let l=E.Eval(t.cadr(o));for(o=t.cddr(o);t.iscons(o);){let d=E.Eval(t.car(o));o=t.cdr(o);let s=E.Eval(t.car(o));o=t.cdr(o);let i=E.Eval(t.car(o));o=t.cdr(o),l=g.integral(l,d);let a=E.Eval(T.subst(l,d,i)),p=E.Eval(T.subst(l,d,s));l=e.subtract(a,p)}n.push(l)}r.Eval_defint=y}),Ae=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.degree=r.Eval_degree=void 0;var t=xt(),n=Mt(),e=Ht(),E=Tt(),g=Er(),T=wt();function y(d){d=E.Eval(t.caddr(d));let s=E.Eval(t.cadr(d)),i=d===t.symbol(t.NIL)?g.guess(s):d;n.push(o(s,i))}r.Eval_degree=y;function o(d,s){return l(d,s,t.Constants.zero)}r.degree=o;function l(d,s,i){return e.equal(d,s)?T.isZeroAtomOrTensor(i)&&(i=t.Constants.one):t.ispower(d)?e.equal(t.cadr(d),s)&&t.isNumericAtom(t.caddr(d))&&e.lessp(i,t.caddr(d))&&(i=t.caddr(d)):t.iscons(d)&&(i=d.tail().reduce((a,p)=>l(p,s,a),i)),i}}),gs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_eigenvec=r.Eval_eigenval=r.Eval_eigen=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Nt(),T=Tt(),y=Sr(),o=St(),l=Ir(),d=or(),s=0,i=[],a=[];function p(C){let{arg:et}=x(C);et||n.stop("eigen: argument is not a square matrix");let[lt,H]=j(t.EIGEN,et);C=E.usr_symbol("D"),E.set_binding(C,lt),C=E.usr_symbol("Q"),E.set_binding(C,H),e.push(t.symbol(t.NIL))}r.Eval_eigen=p;function u(C){let et=_(C);e.push(et)}r.Eval_eigenval=u;function _(C){let{arg:et,invalid:lt}=x(C);if(lt)return o.makeList(t.symbol(t.EIGENVAL),lt);let[H,U]=j(t.EIGENVAL,et);return H}function b(C){let et=A(C);e.push(et)}r.Eval_eigenvec=b;function A(C){let{arg:et,invalid:lt}=x(C);if(lt)return o.makeList(t.symbol(t.EIGENVEC),lt);let[H,U]=j(t.EIGENVEC,et);return U}function x(C){if(C=T.Eval(y.yyfloat(T.Eval(t.cadr(C)))),!t.istensor(C))return{invalid:C};(C.tensor.ndim!==2||C.tensor.dim[0]!==C.tensor.dim[1])&&n.stop("eigen: argument is not a square matrix"),s=C.tensor.dim[0],M(C)||n.stop("eigen: matrix is not numerical");for(let et=0;et<s-1;et++)for(let lt=et+1;lt<s;lt++){let H=C.tensor.elem[s*et+lt],U=C.tensor.elem[s*lt+et];Math.abs(H.d-U.d)>1e-10&&n.stop("eigen: matrix is not symmetrical")}return{arg:C}}function M(C){for(let et=0;et<s;et++)for(let lt=0;lt<s;lt++)if(!t.isdouble(C.tensor.elem[s*et+lt]))return!1;return!0}function j(C,et){for(let v=0;v<s*s;v++)i[v]=0;for(let v=0;v<s*s;v++)a[v]=0;for(let v=0;v<s;v++){i[s*v+v]=et.tensor.elem[s*v+v].d;for(let S=v+1;S<s;S++)i[s*v+S]=et.tensor.elem[s*v+S].d,i[s*S+v]=et.tensor.elem[s*v+S].d}for(let v=0;v<s;v++){a[s*v+v]=1;for(let S=v+1;S<s;S++)a[s*v+S]=0,a[s*S+v]=0}let lt=0;for(lt=0;lt<100&&q()!==0;lt++);lt===100&&l.print_str(`
note: eigen did not converge
`);let H;if(C===t.EIGEN||C===t.EIGENVAL){H=d.copy_tensor(et);for(let v=0;v<s;v++)for(let S=0;S<s;S++)H.tensor.elem[s*v+S]=g.double(i[s*v+S])}let U;if(C===t.EIGEN||C===t.EIGENVEC){U=d.copy_tensor(et);for(let v=0;v<s;v++)for(let S=0;S<s;S++)U.tensor.elem[s*v+S]=g.double(a[s*v+S])}return[H,U]}function q(){let C=0;for(let et=0;et<s-1;et++)for(let lt=et+1;lt<s;lt++)i[s*et+lt]!==0&&(O(et,lt),C++);return C}function O(C,et){let lt=.5*(i[s*C+C]-i[s*et+et])/i[s*C+et],H=1/(Math.abs(lt)+Math.sqrt(lt*lt+1));lt<0&&(H=-H);let U=1/Math.sqrt(H*H+1),v=H*U;for(let S=0;S<s;S++){let D=i[s*C+S],Z=i[s*et+S];i[s*C+S]=U*D+v*Z,i[s*et+S]=U*Z-v*D}for(let S=0;S<s;S++){let D=i[s*S+C],Z=i[s*S+et];i[s*S+C]=U*D+v*Z,i[s*S+et]=U*Z-v*D}for(let S=0;S<s;S++){let D=a[s*C+S],Z=a[s*et+S];a[s*C+S]=U*D+v*Z,a[s*et+S]=U*Z-v*D}i[s*C+et]=0,i[s*et+C]=0}}),un=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.erfc=r.Eval_erfc=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St();function y(d){let s=o(E.Eval(t.cadr(d)));n.push(s)}r.Eval_erfc=y;function o(d){if(t.isdouble(d)){let s=l(d.d);return e.double(s)}return g.isZeroAtomOrTensor(d)?t.Constants.one:T.makeList(t.symbol(t.ERFC),d)}function l(d){if(d===0)return 1;let s=Math.abs(d),i=1/(1+.5*s),a=i*Math.exp(-s*s-1.26551223+i*(1.00002368+i*(.37409196+i*(.09678418+i*(-.18628806+i*(.27886807+i*(-1.13520398+i*(1.48851587+i*(-.82215223+i*.17087277)))))))));return d>=0?a:2-a}r.erfc=l}),ys=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_erf=void 0;var t=xt(),n=Mt(),e=Nt(),E=un(),g=Tt(),T=wt(),y=St(),o=qt();function l(s){let i=d(g.Eval(t.cadr(s)));n.push(i)}r.Eval_erf=l;function d(s){return t.isdouble(s)?e.double(1-E.erfc(s.d)):T.isZeroAtomOrTensor(s)?t.Constants.zero:T.isnegativeterm(s)?o.negate(y.makeList(t.symbol(t.ERF),o.negate(s))):y.makeList(t.symbol(t.ERF),s)}}),vs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.factors=void 0;var t=xt();function n(E){let g=[];return t.isadd(E)?E.tail().forEach(T=>g.push(...e(T))):g.push(...e(E)),g}r.factors=n;function e(E){return t.ismultiply(E)?E.tail():[E]}}),hs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_expand=void 0;var t=lr(),n=xt(),e=fr(),E=Mt(),g=Ht(),T=Ft(),y=Nt(),o=Ae(),l=Lr(),d=Tt(),s=Wr(),i=vs(),a=oe(),p=Er(),u=Br(),_=ce(),b=wt(),A=qt(),x=qr(),M=ir(),j=he(),q=or();function O(F){let Q=d.Eval(n.cadr(F)),R=d.Eval(n.caddr(F)),h=R===n.symbol(n.NIL)?p.guess(Q):R,N=Q;E.push(C(N,h))}r.Eval_expand=O;function C(F,Q){if(n.istensor(F))return et(F,Q);if(n.isadd(F))return F.tail().reduce((X,J)=>T.add(X,C(J,Q)),n.Constants.zero);let R=x.numerator(F),h=l.denominator(F);if([h,R]=lt(h,R,Q),(b.isone(R)||b.isone(h))&&(!b.ispolyexpandedform(h,Q)||b.isone(h)))return F;let N=j.divpoly(R,h,Q);if(R=T.subtract(R,A.multiply(h,N)),b.isZeroAtomOrTensor(R))return N;h=s.factorpoly(h,Q);let $=H(h,Q);R=S(R,$,Q),h=D(h,$,Q);let B;if(n.istensor($)){let X=n.doexpand(_.inv,$);B=u.inner(u.inner(X,R),h)}else{let X=n.doexpand(A.divide,R,$);B=A.multiply(X,h)}return T.add(B,N)}function et(F,Q){return F=q.copy_tensor(F),F.tensor.elem=F.tensor.elem.map(R=>C(R,Q)),F}function lt(F,Q,R){let h=[...i.factors(F),...i.factors(Q)],N=0;for(let $=0;$<h.length;$++){let B=h[$];if(!n.ispower(B)||n.cadr(B)!==R)continue;let X=y.nativeInt(n.caddr(B));isNaN(X)||X<N&&(N=X)}return N===0?[F,Q]:(F=A.multiply(F,M.power(R,y.integer(-N))),Q=A.multiply(Q,M.power(R,y.integer(-N))),[F,Q])}function H(F,Q){let R=[];n.ismultiply(F)?F.tail().forEach($=>R.push(...U(F,$,Q))):R.push(...U(F,F,Q));let h=R.length;if(h===1)return R[0];let N=t.alloc_tensor(h*h);N.tensor.ndim=2,N.tensor.dim[0]=h,N.tensor.dim[1]=h;for(let $=0;$<h;$++)for(let B=0;B<h;B++){let X=M.power(Q,y.integer($)),J=n.doexpand(A.divide,R[B],X);N.tensor.elem[h*$+B]=a.filter(J,Q)}return N}function U(F,Q,R){let h,N=0;if(!e.Find(Q,R))return[];let $=n.doexpand(v,F,Q);n.ispower(Q)?(N=y.nativeInt(n.caddr(Q)),h=n.cadr(Q)):(N=1,h=Q);let B=[],X=y.nativeInt(o.degree(h,R));for(let J=0;J<N;J++)for(let pt=0;pt<X;pt++){let _t=M.power(h,y.integer(J)),At=n.doexpand(A.multiply,$,_t);_t=M.power(R,y.integer(pt));let ht=n.doexpand(A.multiply,At,_t);B.push(ht)}return B}function v(F,Q){let R=n.Constants.one;if(n.ismultiply(F)){let h=[];F.tail().forEach(N=>{g.equal(N,Q)||h.push(d.Eval(N))}),R=A.multiply_all(h)}return R}function S(F,Q,R){if(!n.istensor(Q))return F;let h=Q.tensor.dim[0],N=t.alloc_tensor(h);N.tensor.ndim=1,N.tensor.dim[0]=h;for(let $=0;$<h;$++){let B=M.power(R,y.integer($)),X=n.doexpand(A.divide,F,B);N.tensor.elem[$]=a.filter(X,R)}return N}function D(F,Q,R){if(!n.istensor(Q))return A.reciprocate(F);let h=[];n.ismultiply(F)?F.tail().forEach(B=>{h.push(...Z(B,R))}):h=Z(F,R);let N=h.length,$=t.alloc_tensor(N);return $.tensor.ndim=1,$.tensor.dim[0]=N,$.tensor.elem=h,$}function Z(F,Q){let R=1;if(!e.Find(F,Q))return[];n.ispower(F)&&(R=y.nativeInt(n.caddr(F)),F=n.cadr(F));let h=[],N=y.nativeInt(o.degree(F,Q));for(let $=R;$>0;$--)for(let B=0;B<N;B++)h.push(A.multiply(A.reciprocate(M.power(F,y.integer($))),M.power(Q,y.integer(B))));return h}}),xs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_floor=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Tt(),T=wt(),y=St(),o=Tr();function l(i){let a=d(g.Eval(t.cadr(i)));n.push(a)}r.Eval_floor=l;function d(i){return s(i)}function s(i){if(!t.isNumericAtom(i))return y.makeList(t.symbol(t.FLOOR),i);if(t.isdouble(i))return E.double(Math.floor(i.d));if(T.isinteger(i))return i;let a=new t.Num(o.mdiv(i.q.a,i.q.b));return T.isnegativenumber(i)&&(a=e.add(a,t.Constants.negOne)),a}}),_s=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_for=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Nt(),T=Tt();function y(o){let l=t.caddr(o);t.issymbol(l)||n.stop("for: 2nd arg should be the variable to loop over");let d=T.evaluate_integer(t.cadddr(o));if(isNaN(d)){e.push(o);return}let s=T.evaluate_integer(t.caddddr(o));if(isNaN(s)){e.push(o);return}let i=E.get_binding(l);for(let a=d;a<=s;a++)E.set_binding(l,g.integer(a)),T.Eval(t.cadr(o));E.set_binding(l,i),E.push_symbol(t.NIL)}r.Eval_for=y}),Es=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_gamma=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Tt(),T=wt(),y=St(),o=qt(),l=ir(),d=pr();function s(u){let _=i(g.Eval(t.cadr(u)));n.push(_)}r.Eval_gamma=s;function i(u){return a(u)}function a(u){return t.isrational(u)&&t.MEQUAL(u.q.a,1)&&t.MEQUAL(u.q.b,2)?l.power(t.Constants.Pi(),E.rational(1,2)):t.isrational(u)&&t.MEQUAL(u.q.a,3)&&t.MEQUAL(u.q.b,2)?o.multiply(l.power(t.Constants.Pi(),E.rational(1,2)),E.rational(1,2)):T.isnegativeterm(u)?o.divide(o.multiply(t.Constants.Pi(),t.Constants.negOne),o.multiply(o.multiply(d.sine(o.multiply(t.Constants.Pi(),u)),u),i(o.negate(u)))):t.isadd(u)?p(u):y.makeList(t.symbol(t.GAMMA),u)}function p(u){let _=t.cdr(u);return t.isrational(t.car(_))&&t.MEQUAL(t.car(_).q.a,1)&&t.MEQUAL(t.car(_).q.b,1)?o.multiply(t.cadr(_),i(t.cadr(_))):t.isrational(t.car(_))&&t.MEQUAL(t.car(_).q.a,-1)&&t.MEQUAL(t.car(_).q.b,1)?o.divide(i(t.cadr(_)),e.add(t.cadr(_),t.Constants.negOne)):y.makeList(t.symbol(t.GAMMA),u)}}),As=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hilbert=void 0;var t=xt(),n=Ht(),e=Nt(),E=St(),g=qt();function T(y){let o=e.nativeInt(y);if(o<2)return E.makeList(t.symbol(t.HILBERT),y);let l=n.zero_matrix(o,o);for(let d=0;d<o;d++)for(let s=0;s<o;s++)l.tensor.elem[d*o+s]=g.inverse(e.integer(d+s+1));return l}r.hilbert=T}),Os=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_isprime=void 0;var t=xt(),n=Mt(),e=Tt(),E=wt(),g=Ge();function T(o){let l=y(e.Eval(t.cadr(o)));n.push(l)}r.Eval_isprime=T;function y(o){return E.isnonnegativeinteger(o)&&g.mprime(o.q.a)?t.Constants.one:t.Constants.zero}}),Ms=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_laguerre=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Tt(),T=St(),y=qt(),o=_r();function l(i){let a=g.Eval(t.cadr(i)),p=g.Eval(t.caddr(i)),u=g.Eval(t.cadddr(i)),_=u===t.symbol(t.NIL)?t.Constants.zero:u;n.push(d(a,p,_))}r.Eval_laguerre=l;function d(i,a,p){let u=E.nativeInt(a);return u<0||isNaN(u)?T.makeList(t.symbol(t.LAGUERRE),i,a,p):t.issymbol(i)?s(u,i,p):g.Eval(o.subst(s(u,t.symbol(t.SECRETX),p),t.symbol(t.SECRETX),i))}function s(i,a,p){let u=t.Constants.zero,_=t.Constants.one;for(let b=0;b<i;b++){let A=y.divide(e.subtract(y.multiply(e.add(e.subtract(E.integer(2*b+1),a),p),_),y.multiply(e.add(E.integer(b),p),u)),E.integer(b+1));u=_,_=A}return _}}),Ts=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_leading=void 0;var t=xt(),n=Mt(),e=Ae(),E=Tt(),g=oe(),T=Er(),y=qt(),o=ir();function l(s){let i=E.Eval(t.cadr(s));s=E.Eval(t.caddr(s));let a=s===t.symbol(t.NIL)?T.guess(i):s;n.push(d(i,a))}r.Eval_leading=l;function d(s,i){let a=e.degree(s,i);return g.filter(y.divide(s,o.power(i,a)),i)}}),Ns=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_legendre=void 0;var t=xt(),n=Mt(),e=Ht(),E=Ft(),g=Nt(),T=kr(),y=Zr(),o=Tt(),l=St(),d=qt(),s=ir(),i=pr(),a=_r();function p(x){let M=o.Eval(t.cadr(x)),j=o.Eval(t.caddr(x)),q=o.Eval(t.cadddr(x)),O=q===t.symbol(t.NIL)?t.Constants.zero:q;n.push(u(M,j,O))}r.Eval_legendre=p;function u(x,M,j){return _(x,M,j)}function _(x,M,j){let q=g.nativeInt(M),O=g.nativeInt(j);if(q<0||isNaN(q)||O<0||isNaN(O))return l.makeList(t.symbol(t.LEGENDRE),x,M,j);let C;if(t.issymbol(x))C=b(q,O,x);else{let et=b(q,O,t.symbol(t.SECRETX));C=o.Eval(a.subst(et,t.symbol(t.SECRETX),x))}return C=A(C,O,x)||C,C}function b(x,M,j){let q=t.Constants.zero,O=t.Constants.one;for(let C=0;C<x;C++){let et=d.divide(E.subtract(d.multiply(d.multiply(g.integer(2*C+1),j),O),d.multiply(g.integer(C),q)),g.integer(C+1));q=O,O=et}for(let C=0;C<M;C++)O=y.derivative(O,j);return O}function A(x,M,j){if(M===0)return;let q=E.subtract(t.Constants.one,e.square(j));t.car(j)===t.symbol(t.COS)?q=e.square(i.sine(t.cadr(j))):t.car(j)===t.symbol(t.SIN)&&(q=e.square(T.cosine(t.cadr(j))));let O=d.multiply(x,s.power(q,d.multiply(g.integer(M),g.rational(1,2))));return M%2&&(O=d.negate(O)),O}}),Is=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_lookup=void 0;var t=xt(),n=Mt(),e=Kt();function E(g){g=t.cadr(g),!t.iscons(g)&&t.cadr(g).k===t.SYM&&(g=e.get_binding(g)),n.push(g)}r.Eval_lookup=E}),Ls=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_mod=void 0;var t=xt(),n=zt(),e=Mt(),E=Nt(),g=Tt(),T=wt(),y=St(),o=Tr();function l(s){let i=g.Eval(t.caddr(s)),a=g.Eval(t.cadr(s));e.push(d(a,i))}r.Eval_mod=l;function d(s,i){if(T.isZeroAtomOrTensor(i)&&n.stop("mod function: divide by zero"),!t.isNumericAtom(s)||!t.isNumericAtom(i))return y.makeList(t.symbol(t.MOD),s,i);if(t.isdouble(s)){let a=E.nativeInt(s);isNaN(a)&&n.stop("mod function: cannot convert float value to integer"),s=E.integer(a)}if(t.isdouble(i)){let a=E.nativeInt(i);isNaN(a)&&n.stop("mod function: cannot convert float value to integer"),i=E.integer(a)}return(!T.isinteger(s)||!T.isinteger(i))&&n.stop("mod function: integer arguments expected"),new t.Num(o.mmod(s.q.a,i.q.a))}}),Ss=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_nroots=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ht(),T=Ft(),y=Nt(),o=Xr(),l=Tt(),d=Sr(),s=Er(),i=ue(),a=wt(),p=qt(),u=Kr(),_=101,b=1e-6,A=1e-9;function x(h){return Math.sqrt(h.r*h.r+h.i*h.i)}function M(){return 4*Math.random()-2}var j=class{constructor(){this.r=0,this.i=0}},q=new j,O=new j,C=new j,et=new j,lt=new j,H=new j,U=new j,v=new j,S=[];for(let h=0;h<_;h++)S[h]=new j;function D(h){let N=l.Eval(n.caddr(h));h=l.Eval(n.cadr(h)),N=N===n.symbol(n.NIL)?s.guess(h):N,a.ispolyexpandedform(h,N)||e.stop("nroots: polynomial?");let $=n.defs.tos,B=o.coeff(h,N),X=B.length;X>_&&e.stop("nroots: degree?");for(let J=0;J<X;J++)h=l.Eval(d.yyfloat(u.real(B[J]))),N=l.Eval(d.yyfloat(i.imag(B[J]))),(!n.isdouble(h)||!n.isdouble(N))&&e.stop("nroots: coefficients?"),S[J].r=h.d,S[J].i=N.d;Z(X);for(let J=X;J>1;J--)F(J),Math.abs(q.r)<b&&(q.r=0),Math.abs(q.i)<b&&(q.i=0),E.push(T.add(y.double(q.r),p.multiply(y.double(q.i),n.Constants.imaginaryunit))),R(J);X=n.defs.tos-$,X>1&&(g.sort_stack(X),h=t.alloc_tensor(X),h.tensor.ndim=1,h.tensor.dim[0]=X,h.tensor.elem=n.defs.stack.slice($,$+X),E.moveTos($),E.push(h))}r.Eval_nroots=D;function Z(h){et.r=S[h-1].r,et.i=S[h-1].i;let N=et.r*et.r+et.i*et.i;for(let $=0;$<h-1;$++)S[$].r=(S[$].r*et.r+S[$].i*et.i)/N,S[$].i=(S[$].i*et.r-S[$].r*et.i)/N;S[h-1].r=1,S[h-1].i=0}function F(h){if(x(S[0])<b){q.r=0,q.i=0;return}for(let N=0;N<100;N++){q.r=M(),q.i=M(),Q(h),O.r=q.r,O.i=q.i,H.r=lt.r,H.i=lt.i,q.r=M(),q.i=M();for(let $=0;$<1e3;$++){Q(h);let B=x(lt);if(n.DEBUG&&console.log(`nrabs: ${B}`),B<A)return;x(lt)<x(H)&&(C.r=q.r,C.i=q.i,q.r=O.r,q.i=O.i,O.r=C.r,O.i=C.i,C.r=lt.r,C.i=lt.i,lt.r=H.r,lt.i=H.i,H.r=C.r,H.i=C.i),U.r=O.r-q.r,U.i=O.i-q.i,v.r=H.r-lt.r,v.i=H.i-lt.i;let X=v.r*v.r+v.i*v.i;if(X===0)break;et.r=(U.r*v.r+U.i*v.i)/X,et.i=(U.i*v.r-U.r*v.i)/X,q.r=O.r-(et.r*H.r-et.i*H.i),q.i=O.i-(et.r*H.i+et.i*H.r)}}e.stop("nroots: convergence error")}function Q(h){C.r=q.r,C.i=q.i,lt.r=S[0].r+S[1].r*C.r-S[1].i*C.i,lt.i=S[0].i+S[1].r*C.i+S[1].i*C.r;for(let N=2;N<h;N++){let $=q.r*C.r-q.i*C.i;C.i=q.r*C.i+q.i*C.r,C.r=$,lt.r+=S[N].r*C.r-S[N].i*C.i,lt.i+=S[N].r*C.i+S[N].i*C.r}}function R(h){for(let N=h-1;N>0;N--)S[N-1].r+=S[N].r*q.r-S[N].i*q.i,S[N-1].i+=S[N].i*q.r+S[N].r*q.i;x(S[0])>b&&e.stop("nroots: residual error");for(let N=0;N<h-1;N++)S[N].r=S[N+1].r,S[N].i=S[N+1].i}}),Rs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_outer=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Tt(),T=qt(),y=or();function o(s){s=n.cdr(s);let i=g.Eval(n.car(s)),a=n.iscons(s)?s.tail().reduce((p,u)=>l(p,g.Eval(u)),i):i;E.push(a)}r.Eval_outer=o;function l(s,i){return n.istensor(s)&&n.istensor(i)?d(s,i):n.istensor(s)?y.tensor_times_scalar(s,i):n.istensor(i)?y.scalar_times_tensor(s,i):T.multiply(s,i)}function d(s,i){let a=s.tensor.ndim+i.tensor.ndim;a>n.MAXDIM&&e.stop("outer: rank of result exceeds maximum");let p=s.tensor.nelem*i.tensor.nelem,u=t.alloc_tensor(p);u.tensor.ndim=a,u.tensor.dim=[...s.tensor.dim,...i.tensor.dim];let _=0;for(let b=0;b<s.tensor.nelem;b++)for(let A=0;A<i.tensor.nelem;A++)u.tensor.elem[_++]=T.multiply(s.tensor.elem[b],i.tensor.elem[A]);return u}}),Cs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_prime=void 0;var t=xt(),n=zt(),e=Mt(),E=Nt(),g=Tt();function T(o){let l=y(g.Eval(t.cadr(o)));e.push(l)}r.Eval_prime=T;function y(o){let l=E.nativeInt(o);return(l<1||l>t.MAXPRIMETAB)&&n.stop("prime: Argument out of range."),l=t.primetab[l-1],E.integer(l)}}),qs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_product=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Nt(),T=Tt(),y=qt();function o(l){let d=t.cadr(l),s=t.caddr(l);t.issymbol(s)||n.stop("sum: 2nd arg?");let i=T.evaluate_integer(t.cadddr(l));if(isNaN(i)){e.push(l);return}let a=T.evaluate_integer(t.caddddr(l));if(isNaN(a)){e.push(l);return}let p=E.get_binding(s),u=t.Constants.one;for(let _=i;_<=a;_++){E.set_binding(s,g.integer(_));let b=T.Eval(d);u=y.multiply(u,b),t.DEBUG&&(console.log(`product - factor 1: ${b}`),console.log(`product - factor 2: ${u}`),console.log(`product - result: ${e.top()}`))}e.push(u),E.set_binding(s,p)}r.Eval_product=o}),ws=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_round=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=Sr(),T=wt(),y=St();function o(d){let s=l(E.Eval(t.cadr(d)));n.push(s)}r.Eval_round=o;function l(d){return t.isNumericAtom(d)?t.isdouble(d)?e.double(Math.round(d.d)):T.isinteger(d)?d:(d=g.yyfloat(d),e.integer(Math.round(d.d))):y.makeList(t.symbol(t.ROUND),d)}}),Ps=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_shape=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Nt(),T=Tt(),y=wt();function o(d){let s=l(T.Eval(n.cadr(d)));E.push(s)}r.Eval_shape=o;function l(d){if(!n.istensor(d))return y.isZeroAtomOrTensor(d)||e.stop("transpose: tensor expected, 1st arg is not a tensor"),n.Constants.zero;let{ndim:s}=d.tensor,i=t.alloc_tensor(s);i.tensor.ndim=1,i.tensor.dim[0]=s;for(let a=0;a<s;a++)i.tensor.elem[a]=g.integer(d.tensor.dim[a]);return i}}),Ds=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_sum=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Ft(),T=Nt(),y=Tt();function o(d){let s=l(d);e.push(s)}r.Eval_sum=o;function l(d){let s=t.cadr(d),i=t.caddr(d);t.issymbol(i)||n.stop("sum: 2nd arg?");let a=y.evaluate_integer(t.cadddr(d));if(isNaN(a))return d;let p=y.evaluate_integer(t.caddddr(d));if(isNaN(p))return d;let u=E.get_binding(i),_=t.Constants.zero;for(let b=a;b<=p;b++)E.set_binding(i,T.integer(b)),_=g.add(_,y.Eval(s));return E.set_binding(i,u),_}}),$s=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_tan=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St(),y=qt(),o=ir();function l(s){let i=d(E.Eval(t.cadr(s)));n.push(i)}r.Eval_tan=l;function d(s){if(t.car(s)===t.symbol(t.ARCTAN))return t.cadr(s);if(t.isdouble(s)){let a=Math.tan(s.d);return Math.abs(a)<1e-10&&(a=0),e.double(a)}if(g.isnegative(s))return y.negate(d(y.negate(s)));let i=e.nativeInt(y.divide(y.multiply(s,e.integer(180)),t.Constants.Pi()));if(i<0||isNaN(i))return T.makeList(t.symbol(t.TAN),s);switch(i%360){case 0:case 180:return t.Constants.zero;case 30:case 210:return y.multiply(e.rational(1,3),o.power(e.integer(3),e.rational(1,2)));case 150:case 330:return y.multiply(e.rational(-1,3),o.power(e.integer(3),e.rational(1,2)));case 45:case 225:return t.Constants.one;case 135:case 315:return t.Constants.negOne;case 60:case 240:return o.power(e.integer(3),e.rational(1,2));case 120:case 300:return y.negate(o.power(e.integer(3),e.rational(1,2)));default:return T.makeList(t.symbol(t.TAN),s)}}}),ks=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_tanh=void 0;var t=xt(),n=Mt(),e=Nt(),E=Tt(),g=wt(),T=St();function y(l){let d=o(E.Eval(t.cadr(l)));n.push(d)}r.Eval_tanh=y;function o(l){if(t.car(l)===t.symbol(t.ARCTANH))return t.cadr(l);if(t.isdouble(l)){let d=Math.tanh(l.d);return Math.abs(d)<1e-10&&(d=0),e.double(d)}return g.isZeroAtomOrTensor(l)?t.Constants.zero:T.makeList(t.symbol(t.TANH),l)}}),Us=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_taylor=void 0;var t=xt(),n=Mt(),e=Ft(),E=Nt(),g=Zr(),T=Tt(),y=jr(),o=Er(),l=wt(),d=St(),s=qt(),i=_r();function a(u){u=t.cdr(u);let _=T.Eval(t.car(u));u=t.cdr(u);let b=T.Eval(t.car(u)),A=b===t.symbol(t.NIL)?o.guess(n.top()):b;u=t.cdr(u),b=T.Eval(t.car(u));let x=b===t.symbol(t.NIL)?E.integer(24):b;u=t.cdr(u),b=T.Eval(t.car(u));let M=b===t.symbol(t.NIL)?t.Constants.zero:b;n.push(p(_,A,x,M))}r.Eval_taylor=a;function p(u,_,b,A){let x=E.nativeInt(b);if(isNaN(x))return d.makeList(t.symbol(t.TAYLOR),u,_,b,A);let M=t.Constants.one,j=T.Eval(i.subst(u,_,A));for(let q=1;q<=x&&(u=g.derivative(u,_),!l.isZeroAtomOrTensor(u));q++){M=s.multiply(M,e.subtract(_,A));let O=T.Eval(i.subst(u,_,A));j=e.add(j,s.divide(s.multiply(O,M),y.factorial(E.integer(q))))}return j}}),Bs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_or=r.Eval_and=r.Eval_not=r.Eval_testlt=r.Eval_testle=r.Eval_testgt=r.Eval_testge=r.Eval_testeq=r.Eval_test=void 0;var t=xt(),n=Mt(),e=Ft(),E=Tt(),g=Sr(),T=wt(),y=Gr();function o(x){n.push(l(x))}r.Eval_test=o;function l(x){let M=x;for(x=t.cdr(x);t.iscons(x);){if(t.cdr(x)===t.symbol(t.NIL))return E.Eval(t.car(x));let j=T.isZeroLikeOrNonZeroLikeOrUndetermined(t.car(x));if(j==null)return M;if(j)return E.Eval(t.cadr(x));x=t.cddr(x)}return t.Constants.zero}function d(x){let M=x,j=e.subtract(E.Eval(t.cadr(x)),E.Eval(t.caddr(x))),q=T.isZeroLikeOrNonZeroLikeOrUndetermined(j);if(q){n.push(t.Constants.zero);return}else if(q!=null&&!q){n.push(t.Constants.one);return}let O=y.simplify(E.Eval(t.cadr(x))),C=y.simplify(E.Eval(t.caddr(x)));if(j=e.subtract(O,C),q=T.isZeroLikeOrNonZeroLikeOrUndetermined(j),q){n.push(t.Constants.zero);return}else if(q!=null&&!q){n.push(t.Constants.one);return}n.push(M)}r.Eval_testeq=d;function s(x){let M=x,j=A(x);if(j==null){n.push(M);return}j>=0?n.push(t.Constants.one):n.push(t.Constants.zero)}r.Eval_testge=s;function i(x){let M=x,j=A(x);if(j==null){n.push(M);return}j>0?n.push(t.Constants.one):n.push(t.Constants.zero)}r.Eval_testgt=i;function a(x){let M=x,j=A(x);if(j==null){n.push(M);return}j<=0?n.push(t.Constants.one):n.push(t.Constants.zero)}r.Eval_testle=a;function p(x){let M=x,j=A(x);if(j==null){n.push(M);return}j<0?n.push(t.Constants.one):n.push(t.Constants.zero)}r.Eval_testlt=p;function u(x){let M=x,j=T.isZeroLikeOrNonZeroLikeOrUndetermined(t.cadr(x));j==null?n.push(M):j?n.push(t.Constants.zero):n.push(t.Constants.one)}r.Eval_not=u;function _(x){let M=x,j=t.cdr(M),q=!1;for(;t.iscons(j);){let O=T.isZeroLikeOrNonZeroLikeOrUndetermined(t.car(j));if(O==null)q=!0,j=t.cdr(j);else if(O)j=t.cdr(j);else if(!O){n.push(t.Constants.zero);return}}q?n.push(M):n.push(t.Constants.one)}r.Eval_and=_;function b(x){let M=x,j=t.cdr(M),q=!1;for(;t.iscons(j);){let O=T.isZeroLikeOrNonZeroLikeOrUndetermined(t.car(j));if(O==null)q=!0,j=t.cdr(j);else if(O){n.push(t.Constants.one);return}else O||(j=t.cdr(j))}q?n.push(M):n.push(t.Constants.zero)}r.Eval_or=b;function A(x){let M=0,j=y.simplify(E.Eval(t.cadr(x))),q=y.simplify(E.Eval(t.caddr(x)));if(x=e.subtract(j,q),x.k!==t.NUM&&x.k!==t.DOUBLE&&(x=E.Eval(g.yyfloat(x))),T.isZeroAtomOrTensor(x))return 0;switch(x.k){case t.NUM:t.MSIGN(x.q.a)===-1?M=-1:M=1;break;case t.DOUBLE:x.d<0?M=-1:M=1;break;default:M=null}return M}}),Gs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_user_function=void 0;var t=xt(),n=zt(),e=Mt(),E=Kt(),g=Zr(),T=Tt(),y=St(),o=or();function l(i){if(t.DEBUG&&console.log(`Eval_user_function evaluating: ${t.car(i)}`),t.car(i)===t.symbol(t.SYMBOL_D)&&E.get_binding(t.symbol(t.SYMBOL_D))===t.symbol(t.SYMBOL_D)){g.Eval_derivative(i);return}let a=T.Eval(t.car(i));t.isNumericAtom(a)?n.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):t.istensor(a)?n.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):t.isstr(a)&&n.stop("expected function, found string instead.");let p=t.car(t.cdr(a)),u=t.car(t.cdr(t.cdr(a))),_=t.cdr(i);if(t.car(a)!==t.symbol(t.FUNCTION)||a===t.car(i)){let M=t.defs.tos;for(e.push(a),i=_;t.iscons(i);)e.push(T.Eval(t.car(i))),i=t.cdr(i);y.list(t.defs.tos-M);return}i=u;let b=_,A=t.defs.tos;for(;t.iscons(i)&&t.iscons(b);)e.push(t.car(i)),e.push(t.car(b)),i=t.cdr(i),b=t.cdr(b);y.list(t.defs.tos-A);let x=e.pop();e.push(p),t.iscons(x)&&(e.push(x),d()),e.push(T.Eval(e.pop()))}r.Eval_user_function=l;function d(){let i=0,a=e.pop(),p=e.pop();if(t.istensor(p))return i=s(p,a),i;if(t.iscons(p)){let _=t.defs.tos;for(t.car(p)===t.car(a)?e.push(y.makeList(t.symbol(t.EVAL),t.car(t.cdr(a)))):e.push(t.car(p)),p=t.cdr(p);t.iscons(p);)e.push(t.car(p)),e.push(a),i+=d(),p=t.cdr(p);return y.list(t.defs.tos-_),i}if(!t.issymbol(p))return e.push(p),0;let u=a;for(;t.iscons(u);){if(p===t.car(u))return e.push(t.cadr(u)),1;u=t.cddr(u)}return u=E.get_binding(p),e.push(u),p!==u&&(e.push(a),i=d(),i===0&&(e.pop(),e.push(p))),i}function s(i,a){let p=0;return i=o.copy_tensor(i),i.tensor.elem=i.tensor.elem.map(u=>(e.push(u),e.push(a),p+=d(),e.pop())),o.check_tensor_dimensions(i),e.push(i),p}}),Fs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_zero=void 0;var t=lr(),n=xt(),e=Mt(),E=Tt();function g(y){e.push(T(y))}r.Eval_zero=g;function T(y){let o=Array(n.MAXDIM).fill(0),l=1,d=0;if(n.iscons(y))for(let s of y.tail()){let i=E.evaluate_integer(s);if(i<1||isNaN(i))return n.Constants.zero;l*=i,o[d++]=i}if(d===0)return n.Constants.zero;y=t.alloc_tensor(l),y.tensor.ndim=d;for(let s=0;s<d;s++)y.tensor.dim[s]=o[s];return y}}),Tt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Eval_predicate=r.Eval=r.evaluate_integer=void 0;var t=Vr(),n=lr(),e=xt(),E=zt(),g=Mt(),T=Kt(),y=Ht(),o=Nr(),l=Ft(),d=Ye(),s=Ve(),i=ns(),a=ss(),p=os(),u=is(),_=Fe(),b=as(),A=Qr(),x=We(),M=Je(),j=Nt(),q=ls(),O=us(),C=cs(),et=ds(),lt=rn(),H=xe(),U=Xr(),v=je(),S=ie(),D=zr(),Z=fs(),F=kr(),Q=en(),R=ze(),h=ps(),N=bs(),$=Ae(),B=Lr(),X=Zr(),J=Ee(),pt=nn(),_t=ke(),At=gs(),ht=ys(),It=un(),Lt=hs(),Yt=Ke(),Bt=Qe(),Zt=le(),ft=jr(),gt=Wr(),Pt=oe(),kt=Sr(),rr=xs(),nt=_s(),Ot=Es(),w=Yr(),vt=sn(),P=As(),rt=ue(),W=Br(),f=fe(),L=ce(),V=wt(),G=Os(),st=Ms(),tt=$e(),Y=Ts(),ct=Ns(),yt=St(),Ct=on(),Xt=Is(),Ut=Ls(),Gt=qt(),Qt=Ss(),er=qr(),I=Rs(),k=tn(),bt=_e(),at=ir(),jt=Cs(),Vt=Ir(),mr=qs(),sr=he(),br=ae(),Vs=Kr(),Ws=wr(),Js=Xe(),Ks=ws(),Qs=an(),to=Ps(),ro=Gr(),eo=pr(),no=ln(),dn=_r(),so=Ds(),oo=$s(),io=ks(),ao=Us(),fn=or(),Rr=Bs(),lo=He(),pn=Gs(),uo=Fs();function Oe(z){return j.nativeInt(Jt(z))}r.evaluate_integer=Oe;function Jt(z){let $t;E.check_esc_flag(),z==null&&e.breakpoint,!e.defs.evaluatingAsFloats&&V.isfloating(z)&&($t=!0,e.defs.evaluatingAsFloats=!0);let tr;switch(z.k){case e.CONS:fo(z),tr=g.pop();break;case e.NUM:tr=e.defs.evaluatingAsFloats?j.double(j.convert_rational_to_double(z)):z;break;case e.DOUBLE:case e.STR:tr=z;break;case e.TENSOR:fn.Eval_tensor(z),tr=g.pop();break;case e.SYM:co(z),tr=g.pop();break;default:E.stop("atom?")}return $t&&(e.defs.evaluatingAsFloats=!1),tr}r.Eval=Jt;function co(z){if(e.iskeyword(z)){g.push(Jt(yt.makeList(z,e.symbol(e.LAST))));return}else if(z===e.symbol(e.PI)&&e.defs.evaluatingAsFloats){g.push(e.Constants.piAsDouble);return}let $t=T.get_binding(z);if(e.DEBUG&&console.log(`looked up: ${z} which contains: ${$t}`),g.push($t),z!==$t){let tr=e.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(z);if(tr!==-1){let ur="";for(let Fr=tr;Fr<e.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;Fr++)ur+=e.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[Fr].printname+" -> ";ur+=z.printname,E.stop("recursive evaluation of symbols: "+ur);return}e.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(z),g.push(Jt(g.pop())),e.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}}function fo(z){let $t=e.car(z);if(e.car($t)===e.symbol(e.EVAL)){pn.Eval_user_function(z);return}switch(e.issymbol($t)||E.stop("cons?"),T.symnum($t)){case e.ABS:return o.Eval_abs(z);case e.ADD:return l.Eval_add(z);case e.ADJ:return d.Eval_adj(z);case e.AND:return Rr.Eval_and(z);case e.ARCCOS:return i.Eval_arccos(z);case e.ARCCOSH:return a.Eval_arccosh(z);case e.ARCSIN:return p.Eval_arcsin(z);case e.ARCSINH:return u.Eval_arcsinh(z);case e.ARCTAN:return _.Eval_arctan(z);case e.ARCTANH:return b.Eval_arctanh(z);case e.ARG:return A.Eval_arg(z);case e.BESSELJ:return x.Eval_besselj(z);case e.BESSELY:return M.Eval_bessely(z);case e.BINDING:return po(z);case e.BINOMIAL:return q.Eval_binomial(z);case e.CEILING:return O.Eval_ceiling(z);case e.CHECK:return mo(z);case e.CHOOSE:return C.Eval_choose(z);case e.CIRCEXP:return et.Eval_circexp(z);case e.CLEAR:return lt.Eval_clear(z);case e.CLEARALL:return lt.Eval_clearall();case e.CLEARPATTERNS:return k.Eval_clearpatterns();case e.CLOCK:return H.Eval_clock(z);case e.COEFF:return U.Eval_coeff(z);case e.COFACTOR:return v.Eval_cofactor(z);case e.CONDENSE:return S.Eval_condense(z);case e.CONJ:return D.Eval_conj(z);case e.CONTRACT:return Z.Eval_contract(z);case e.COS:return F.Eval_cos(z);case e.COSH:return Q.Eval_cosh(z);case e.DECOMP:return R.Eval_decomp(z);case e.DEGREE:return $.Eval_degree(z);case e.DEFINT:return N.Eval_defint(z);case e.DENOMINATOR:return B.Eval_denominator(z);case e.DERIVATIVE:return X.Eval_derivative(z);case e.DET:return bo(z);case e.DIM:return go(z);case e.DIRAC:return pt.Eval_dirac(z);case e.DIVISORS:return yo(z);case e.DO:return vo(z);case e.DOT:return W.Eval_inner(z);case e.EIGEN:return At.Eval_eigen(z);case e.EIGENVAL:return At.Eval_eigenval(z);case e.EIGENVEC:return At.Eval_eigenvec(z);case e.ERF:return ht.Eval_erf(z);case e.ERFC:return It.Eval_erfc(z);case e.EVAL:return ho(z);case e.EXP:return xo(z);case e.EXPAND:return Lt.Eval_expand(z);case e.EXPCOS:return Yt.Eval_expcos(z);case e.EXPSIN:return Bt.Eval_expsin(z);case e.FACTOR:return Zt.Eval_factor(z);case e.FACTORIAL:return _o(z);case e.FACTORPOLY:return Eo(z);case e.FILTER:return Pt.Eval_filter(z);case e.FLOATF:return kt.Eval_float(z);case e.APPROXRATIO:return s.Eval_approxratio(z);case e.FLOOR:return rr.Eval_floor(z);case e.FOR:return nt.Eval_for(z);case e.FUNCTION:return h.Eval_function_reference(z);case e.GAMMA:return Ot.Eval_gamma(z);case e.GCD:return w.Eval_gcd(z);case e.HERMITE:return Ao(z);case e.HILBERT:return Oo(z);case e.IMAG:return rt.Eval_imag(z);case e.INDEX:return Mo(z);case e.INNER:return W.Eval_inner(z);case e.INTEGRAL:return f.Eval_integral(z);case e.INV:return No(z);case e.INVG:return Io(z);case e.ISINTEGER:return Lo(z);case e.ISPRIME:return G.Eval_isprime(z);case e.LAGUERRE:return st.Eval_laguerre(z);case e.LCM:return tt.Eval_lcm(z);case e.LEADING:return Y.Eval_leading(z);case e.LEGENDRE:return ct.Eval_legendre(z);case e.LOG:return Ct.Eval_log(z);case e.LOOKUP:return Xt.Eval_lookup(z);case e.MOD:return Ut.Eval_mod(z);case e.MULTIPLY:return Gt.Eval_multiply(z);case e.NOT:return Rr.Eval_not(z);case e.NROOTS:return Qt.Eval_nroots(z);case e.NUMBER:return Ro(z);case e.NUMERATOR:return er.Eval_numerator(z);case e.OPERATOR:return Co(z);case e.OR:return Rr.Eval_or(z);case e.OUTER:return I.Eval_outer(z);case e.PATTERN:return k.Eval_pattern(z);case e.PATTERNSINFO:return k.Eval_patternsinfo();case e.POLAR:return bt.Eval_polar(z);case e.POWER:return at.Eval_power(z);case e.PRIME:return jt.Eval_prime(z);case e.PRINT:return Vt.Eval_print(z);case e.PRINT2DASCII:return Vt.Eval_print2dascii(z);case e.PRINTFULL:return Vt.Eval_printcomputer(z);case e.PRINTLATEX:return Vt.Eval_printlatex(z);case e.PRINTLIST:return Vt.Eval_printlist(z);case e.PRINTPLAIN:return Vt.Eval_printhuman(z);case e.PRODUCT:return mr.Eval_product(z);case e.QUOTE:return qo(z);case e.QUOTIENT:return sr.Eval_quotient(z);case e.RANK:return wo(z);case e.RATIONALIZE:return br.Eval_rationalize(z);case e.REAL:return Vs.Eval_real(z);case e.ROUND:return Ks.Eval_round(z);case e.YYRECT:return Ws.Eval_rect(z);case e.ROOTS:return Js.Eval_roots(z);case e.SETQ:return Po(z);case e.SGN:return Qs.Eval_sgn(z);case e.SILENTPATTERN:return k.Eval_silentpattern(z);case e.SIMPLIFY:return ro.Eval_simplify(z);case e.SIN:return eo.Eval_sin(z);case e.SINH:return no.Eval_sinh(z);case e.SHAPE:return to.Eval_shape(z);case e.SQRT:return $o(z);case e.STOP:return ko();case e.SUBST:return Uo(z);case e.SUM:return so.Eval_sum(z);case e.SYMBOLSINFO:return T.Eval_symbolsinfo();case e.TAN:return oo.Eval_tan(z);case e.TANH:return io.Eval_tanh(z);case e.TAYLOR:return ao.Eval_taylor(z);case e.TEST:return Rr.Eval_test(z);case e.TESTEQ:return Rr.Eval_testeq(z);case e.TESTGE:return Rr.Eval_testge(z);case e.TESTGT:return Rr.Eval_testgt(z);case e.TESTLE:return Rr.Eval_testle(z);case e.TESTLT:return Rr.Eval_testlt(z);case e.TRANSPOSE:return lo.Eval_transpose(z);case e.UNIT:return Bo(z);case e.ZERO:return uo.Eval_zero(z);default:return pn.Eval_user_function(z)}}function po(z){g.push(T.get_binding(e.cadr(z)))}function mo(z){let $t=V.isZeroLikeOrNonZeroLikeOrUndetermined(e.cadr(z));$t==null?g.push(z):j.push_integer(Number($t))}function bo(z){let $t=Jt(e.cadr(z));g.push(J.det($t))}function go(z){let $t=Jt(e.cadr(z)),tr=e.iscons(e.cddr(z))?Oe(e.caddr(z)):1;e.istensor($t)?tr<1||tr>$t.tensor.ndim?g.push(z):j.push_integer($t.tensor.dim[tr-1]):g.push(e.Constants.one)}function yo(z){g.push(_t.divisors(Jt(e.cadr(z))))}function vo(z){for(g.push(e.car(z)),z=e.cdr(z);e.iscons(z);)g.pop(),g.push(Jt(e.car(z))),z=e.cdr(z)}function ho(z){let $t=Jt(e.cadr(z));for(z=e.cddr(z);e.iscons(z);)$t=dn.subst($t,Jt(e.car(z)),Jt(e.cadr(z))),z=e.cddr(z);g.push(Jt($t))}function xo(z){g.push(y.exponential(Jt(e.cadr(z))))}function _o(z){g.push(ft.factorial(Jt(e.cadr(z))))}function Eo(z){z=e.cdr(z);let $t=Jt(e.car(z));z=e.cdr(z);let tr=Jt(e.car(z)),ur=gt.factorpoly($t,tr);e.iscons(z)&&(ur=z.tail().reduce((Fr,Fo)=>gt.factorpoly(Fr,Jt(Fo)),ur)),g.push(ur)}function Ao(z){let $t=Jt(e.caddr(z)),tr=Jt(e.cadr(z));g.push(vt.hermite(tr,$t))}function Oo(z){g.push(P.hilbert(Jt(e.cadr(z))))}function Mo(z){let $t=To(z);g.push($t)}function To(z){let $t=z;z=e.cdr(z);let tr=Jt(e.car(z));if(e.isNumericAtom(tr)&&E.stop("trying to access a scalar as a tensor"),!e.istensor(tr))return $t;let ur=[tr];for(z=e.cdr(z);e.iscons(z);){if(ur.push(Jt(e.car(z))),!V.isintegerorintegerfloat(ur[ur.length-1]))return $t;z=e.cdr(z)}return t.index_function(ur)}function No(z){let $t=Jt(e.cadr(z));g.push(L.inv($t))}function Io(z){let $t=Jt(e.cadr(z));g.push(L.invg($t))}function Lo(z){z=Jt(e.cadr(z));let $t=So(z);g.push($t)}function So(z){return e.isrational(z)?V.isinteger(z)?e.Constants.one:e.Constants.zero:e.isdouble(z)?Math.floor(z.d)===z.d?e.Constants.one:e.Constants.zero:yt.makeList(e.symbol(e.ISINTEGER),z)}function Ro(z){z=Jt(e.cadr(z));let $t=z.k===e.NUM||z.k===e.DOUBLE?e.Constants.one:e.Constants.zero;g.push($t)}function Co(z){let $t=e.iscons(z)?z.tail().map(Jt):[],tr=yt.makeList(e.symbol(e.OPERATOR),...$t);g.push(tr)}function qo(z){g.push(e.cadr(z))}function wo(z){z=Jt(e.cadr(z));let $t=e.istensor(z)?j.integer(z.tensor.ndim):e.Constants.zero;g.push($t)}function Po(z){if(e.caadr(z)===e.symbol(e.INDEX)){Do(z);return}if(e.iscons(e.cadr(z))){h.define_user_function(z);return}e.issymbol(e.cadr(z))||E.stop("symbol assignment: error in symbol");let $t=Jt(e.caddr(z));T.set_binding(e.cadr(z),$t),g.push(e.symbol(e.NIL))}function Do(z){let $t=e.cadadr(z);console.log(`p4: ${$t}`),e.issymbol($t)||E.stop("indexed assignment: expected a symbol name");let tr=e.defs.tos;g.push(Jt(e.caddr(z)));let ur=e.cdadr(z);e.iscons(ur)&&g.push_all([...ur].map(Jt)),t.set_component(e.defs.tos-tr);let Fr=g.pop();T.set_binding($t,Fr),g.push(e.symbol(e.NIL))}function $o(z){let $t=Jt(e.cadr(z));g.push(at.power($t,j.rational(1,2)))}function ko(){E.stop("user stop")}function Uo(z){let $t=Jt(e.cadr(z)),tr=Jt(e.caddr(z)),ur=Jt(e.cadddr(z));g.push(Jt(dn.subst(ur,tr,$t)))}function Bo(z){let $t=Oe(e.cadr(z));if(isNaN($t)){g.push(z);return}if($t<1){g.push(z);return}z=n.alloc_tensor($t*$t),z.tensor.ndim=2,z.tensor.dim[0]=$t,z.tensor.dim[1]=$t;for(let tr=0;tr<$t;tr++)z.tensor.elem[$t*tr+tr]=e.Constants.one;fn.check_tensor_dimensions(z),g.push(z)}function Go(z){return e.car(z)===e.symbol(e.SETQ)&&(z=yt.makeList(e.symbol(e.TESTEQ),e.cadr(z),e.caddr(z))),Jt(z)}r.Eval_predicate=Go}),Ft=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subtract=r.add_all=r.add=r.Eval_add=void 0;var t=xt(),n=zt(),e=Mt(),E=Ht(),g=Nt(),T=Tt(),y=wt(),o=St(),l=qt(),d=Ir(),s=or(),i=0;function a(q){let O=[];q=t.cdr(q);for(let C of q){let et=T.Eval(C);A(O,et)}e.push(p(O))}r.Eval_add=a;function p(q){if(t.DEBUG)for(let O of q)console.log(d.print_list(O));for(let O=0;O<10&&!(q.length<2||(i=0,q.sort(_),i===0));O++)b(q);switch(q.length){case 0:return t.Constants.Zero();case 1:return q[0];default:return q.unshift(t.symbol(t.ADD)),o.makeList(...q)}}var u=0;function _(q,O){if(u++,t.isNumericAtom(q)&&t.isNumericAtom(O))return i=1,0;if(t.istensor(q)&&t.istensor(O)){if(q.tensor.ndim<O.tensor.ndim)return-1;if(q.tensor.ndim>O.tensor.ndim)return 1;for(let et=0;et<q.tensor.ndim;et++){if(q.tensor.dim[et]<O.tensor.dim[et])return-1;if(q.tensor.dim[et]>O.tensor.dim[et])return 1}return i=1,0}t.ismultiply(q)&&(q=t.cdr(q),t.isNumericAtom(t.car(q))&&(q=t.cdr(q),t.cdr(q)===t.symbol(t.NIL)&&(q=t.car(q)))),t.ismultiply(O)&&(O=t.cdr(O),t.isNumericAtom(t.car(O))&&(O=t.cdr(O),t.cdr(O)===t.symbol(t.NIL)&&(O=t.car(O))));let C=E.cmp_expr(q,O);return C===0&&(i=1),C}function b(q){let O=0;for(;O<q.length-1;){n.check_esc_flag();let C,et,lt=q[O],H=q[O+1];if(t.istensor(lt)&&t.istensor(H)){C=s.tensor_plus_tensor(lt,H),C!==t.symbol(t.NIL)&&(q.splice(O,2,C),O--),O++;continue}if(t.istensor(lt)||t.istensor(H)){O++;continue}if(t.isNumericAtom(lt)&&t.isNumericAtom(H)){C=g.add_numbers(lt,H),y.isZeroAtomOrTensor(C)?q.splice(O,2):q.splice(O,2,C),O--,O++;continue}if(t.isNumericAtom(lt)||t.isNumericAtom(H)){O++;continue}C=t.Constants.One(),et=t.Constants.One();let U=0;if(t.ismultiply(lt)&&(lt=t.cdr(lt),U=1,t.isNumericAtom(t.car(lt))&&(C=t.car(lt),lt=t.cdr(lt),t.cdr(lt)===t.symbol(t.NIL)&&(lt=t.car(lt),U=0))),t.ismultiply(H)&&(H=t.cdr(H),t.isNumericAtom(t.car(H))&&(et=t.car(H),H=t.cdr(H),t.cdr(H)===t.symbol(t.NIL)&&(H=t.car(H)))),!E.equal(lt,H)){O++;continue}if(C=g.add_numbers(C,et),y.isZeroAtomOrTensor(C)){q.splice(O,2),O--,O++;continue}let v=U?new t.Cons(t.symbol(t.MULTIPLY),lt):lt;q.splice(O,2,l.multiply(C,v)),O--,O++}}function A(q,O){t.isadd(O)?q.push(...O.tail()):y.isZeroAtom(O)||q.push(O)}function x(q,O){let C=[];return A(C,q),A(C,O),p(C)}r.add=x;function M(q){let O=[];for(let C of q)A(O,C);return p(O)}r.add_all=M;function j(q,O){return x(q,l.negate(O))}r.subtract=j}),or=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.copy_tensor=r.power_tensor=r.compare_tensors=r.d_tensor_scalar=r.d_scalar_tensor=r.d_tensor_tensor=r.is_square_matrix=r.check_tensor_dimensions=r.scalar_times_tensor=r.tensor_times_scalar=r.tensor_plus_tensor=r.Eval_tensor=void 0;var t=lr(),n=xt(),e=zt(),E=Mt(),g=Ht(),T=Ft(),y=Nt(),o=Zr(),l=Tt(),d=Br(),s=ce(),i=wt(),a=St(),p=qt();function u(v){x(v);let{nelem:S,ndim:D}=v.tensor,Z=t.alloc_tensor(S);Z.tensor.ndim=D,Z.tensor.dim=Array.from(v.tensor.dim),x(Z),Z.tensor.elem=v.tensor.elem.map(F=>l.Eval(F)),x(v),x(Z),E.push(H(Z))}r.Eval_tensor=u;function _(v,S){if(v.tensor.ndim!==S.tensor.ndim||v.tensor.dim.some((N,$)=>N!==S.tensor.dim[$]))return n.symbol(n.NIL);let{nelem:D,ndim:Z}=v.tensor,F=t.alloc_tensor(D);F.tensor.ndim=Z,F.tensor.dim=Array.from(v.tensor.dim);let Q=v.tensor.elem,R=S.tensor.elem,h=F.tensor.elem;for(let N=0;N<D;N++)h[N]=T.add(Q[N],R[N]);return F}r.tensor_plus_tensor=_;function b(v,S){let{ndim:D,nelem:Z}=v.tensor,F=t.alloc_tensor(Z);return F.tensor.ndim=D,F.tensor.dim=Array.from(v.tensor.dim),F.tensor.elem=v.tensor.elem.map(Q=>p.multiply(Q,S)),F}r.tensor_times_scalar=b;function A(v,S){let{ndim:D,nelem:Z}=S.tensor,F=t.alloc_tensor(Z);return F.tensor.ndim=D,F.tensor.dim=Array.from(S.tensor.dim),F.tensor.elem=S.tensor.elem.map(Q=>p.multiply(v,Q)),F}r.scalar_times_tensor=A;function x(v){if(v.tensor.nelem!==v.tensor.elem.length)return console.log("something wrong in tensor dimensions"),n.breakpoint}r.check_tensor_dimensions=x;function M(v){return n.istensor(v)&&v.tensor.ndim===2&&v.tensor.dim[0]===v.tensor.dim[1]}r.is_square_matrix=M;function j(v,S){let{ndim:D,nelem:Z}=v.tensor;if(D+1>=n.MAXDIM)return a.makeList(n.symbol(n.DERIVATIVE),v,S);let F=t.alloc_tensor(Z*S.tensor.nelem);F.tensor.ndim=D+1,F.tensor.dim=[...v.tensor.dim,S.tensor.dim[0]];let Q=v.tensor.elem,R=S.tensor.elem,h=F.tensor.elem;for(let N=0;N<Z;N++)for(let $=0;$<S.tensor.nelem;$++)h[N*S.tensor.nelem+$]=o.derivative(Q[N],R[$]);return F}r.d_tensor_tensor=j;function q(v,S){let D=t.alloc_tensor(S.tensor.nelem);return D.tensor.ndim=1,D.tensor.dim[0]=S.tensor.dim[0],D.tensor.elem=S.tensor.elem.map(Z=>o.derivative(v,Z)),D}r.d_scalar_tensor=q;function O(v,S){let D=t.alloc_tensor(v.tensor.nelem);return D.tensor.ndim=v.tensor.ndim,D.tensor.dim=[...v.tensor.dim],D.tensor.elem=v.tensor.elem.map(Z=>o.derivative(Z,S)),D}r.d_tensor_scalar=O;function C(v,S){if(v.tensor.ndim<S.tensor.ndim)return-1;if(v.tensor.ndim>S.tensor.ndim)return 1;for(let D=0;D<v.tensor.ndim;D++){if(v.tensor.dim[D]<S.tensor.dim[D])return-1;if(v.tensor.dim[D]>S.tensor.dim[D])return 1}for(let D=0;D<v.tensor.nelem;D++)if(!g.equal(v.tensor.elem[D],S.tensor.elem[D]))return g.lessp(v.tensor.elem[D],S.tensor.elem[D])?-1:1;return 0}r.compare_tensors=C;function et(v,S){let D=v.tensor.ndim-1;if(v.tensor.dim[0]!==v.tensor.dim[D])return a.makeList(n.symbol(n.POWER),v,S);let Z=y.nativeInt(S);if(isNaN(Z))return a.makeList(n.symbol(n.POWER),v,S);if(Z===0){v.tensor.ndim!==2&&e.stop("power(tensor,0) with tensor rank not equal to 2"),Z=v.tensor.dim[0],v=t.alloc_tensor(Z*Z),v.tensor.ndim=2,v.tensor.dim[0]=Z,v.tensor.dim[1]=Z;for(let R=0;R<Z;R++)v.tensor.elem[Z*R+R]=n.Constants.one;return x(v),v}let F=v;Z<0&&(Z=-Z,F=s.inv(F));let Q=F;for(let R=1;R<Z&&(Q=d.inner(Q,F),!i.isZeroAtomOrTensor(Q));R++);return Q}r.power_tensor=et;function lt(v){let S=t.alloc_tensor(v.tensor.nelem);return S.tensor.ndim=v.tensor.ndim,S.tensor.dim=[...v.tensor.dim],S.tensor.elem=[...v.tensor.elem],x(v),x(S),S}r.copy_tensor=lt;function H(v){if(!n.istensor(v))return v;let S=v.tensor.elem[0];if(v.tensor.elem.some(Q=>!U(S,Q))&&e.stop("Cannot promote tensor due to inconsistent tensor components."),!n.istensor(S))return v;let D=v.tensor.ndim+S.tensor.ndim;D>n.MAXDIM&&e.stop("tensor rank > "+n.MAXDIM);let Z=v.tensor.nelem*S.tensor.nelem,F=t.alloc_tensor(Z);return F.tensor.ndim=D,F.tensor.dim=[...v.tensor.dim,...S.tensor.dim],F.tensor.elem=[].concat(...v.tensor.elem.map(Q=>Q.tensor.elem)),x(S),x(F),F}function U(v,S){if(!n.istensor(v)&&!n.istensor(S))return!0;if(!n.istensor(v)||!n.istensor(S)||v.tensor.ndim!==S.tensor.ndim)return!1;for(let D=0;D<v.tensor.ndim;D++)if(v.tensor.dim[D]!==S.tensor.dim[D])return!1;return!0}}),lr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.alloc_tensor=void 0;var t=or(),n=xt();function e(E){let g=new n.Tensor;for(let T=0;T<E;T++)g.tensor.elem[T]=n.Constants.zero;return t.check_tensor_dimensions(g),g}r.alloc_tensor=e}),Ht=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sort=r.sort_stack=r.square=r.exponential=r.yyexpand=r.length=r.cmp_expr=r.sign=r.lessp=r.equal=r.zero_matrix=r.new_string=void 0;var t=lr(),n=xt(),e=Pr(),E=Mt(),g=Kt(),T=Nt(),y=Tt(),o=ir(),l=or();function d(q){E.push(new n.Str(q.toString()))}r.new_string=d;function s(q,O){let C=t.alloc_tensor(q*O);return C.ndim=2,C.dim[0]=q,C.dim[1]=O,C}r.zero_matrix=s;function i(q,O){return u(q,O)===0}r.equal=i;function a(q,O){return u(q,O)<0}r.lessp=a;function p(q){return q<0?-1:q>0?1:0}r.sign=p;function u(q,O){let C=0;if(q===O)return 0;if(q===n.symbol(n.NIL))return-1;if(O===n.symbol(n.NIL))return 1;if(n.isNumericAtom(q)&&n.isNumericAtom(O))return p(T.compare_numbers(q,O));if(n.isNumericAtom(q))return-1;if(n.isNumericAtom(O))return 1;if(n.isstr(q)&&n.isstr(O))return p(e.strcmp(q.str,O.str));if(n.isstr(q))return-1;if(n.isstr(O))return 1;if(n.issymbol(q)&&n.issymbol(O))return p(e.strcmp(g.get_printname(q),g.get_printname(O)));if(n.issymbol(q))return-1;if(n.issymbol(O))return 1;if(n.istensor(q)&&n.istensor(O))return l.compare_tensors(q,O);if(n.istensor(q))return-1;if(n.istensor(O))return 1;for(;n.iscons(q)&&n.iscons(O);){if(C=u(n.car(q),n.car(O)),C!==0)return C;q=n.cdr(q),O=n.cdr(O)}return n.iscons(O)?-1:n.iscons(q)?1:0}r.cmp_expr=u;function _(q){return n.iscons(q)?[...q].length:0}r.length=_;function b(q){return n.doexpand(y.Eval,q)}r.yyexpand=b;function A(q){return o.power(n.symbol(n.E),q)}r.exponential=A;function x(q){return o.power(q,T.integer(2))}r.square=x;function M(q){let O=n.defs.tos-q,C=n.defs.stack.slice(O,O+q);C.sort(u),n.defs.stack=n.defs.stack.slice(0,O).concat(C).concat(n.defs.stack.slice(O+q))}r.sort_stack=M;function j(q){q.sort(u)}r.sort=j}),fr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findPossibleExponentialForm=r.findPossibleClockForm=r.Find=void 0;var t=wt(),n=Ht(),e=xt();function E(y,o){if(n.equal(y,o))return!0;if(e.istensor(y)){for(let l=0;l<y.tensor.nelem;l++)if(E(y.tensor.elem[l],o))return!0;return!1}return e.iscons(y)?[...y].some(l=>E(l,o)):!1}r.Find=E;function g(y,o){if(t.isimaginaryunit(y))return!1;if(e.ispower(y)&&!t.isinteger(e.caddr(o))&&E(e.cadr(y),e.Constants.imaginaryunit)||e.ispower(y)&&t.equaln(e.cadr(y),-1)&&!t.isinteger(e.caddr(o)))return!0;if(e.istensor(y)){for(let l=0;l<y.tensor.nelem;l++)if(g(y.tensor.elem[l],o))return!0;return!1}return e.iscons(y)?[...y].some(l=>g(l,o)):!1}r.findPossibleClockForm=g;function T(y){if(e.ispower(y)&&e.cadr(y)===e.symbol(e.E))return E(e.caddr(y),e.Constants.imaginaryunit);if(e.istensor(y)){for(let o=0;o<y.tensor.nelem;o++)if(T(y.tensor.elem[o]))return!0;return!1}return e.iscons(y)?[...y].some(T):!1}r.findPossibleExponentialForm=T}),wt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isnpi=r.isquarterturn=r.isimaginaryunit=r.isfloating=r.isMinusSqrtThreeOverTwo=r.isSqrtThreeOverTwo=r.isminusoneoversqrttwo=r.isoneoversqrttwo=r.isminusoneovertwo=r.isoneovertwo=r.equalq=r.equaln=r.isfraction=r.isoneover=r.isNumberOneOverSomething=r.isintegerfactor=r.issymbolic=r.isnegative=r.iseveninteger=r.iscomplexnumber=r.iscomplexnumberdouble=r.isimaginarynumber=r.isnegativeterm=r.ispolyexpandedform=r.isunivarpolyfactoredorexpandedform=r.isposint=r.isnonnegativeinteger=r.isintegerorintegerfloat=r.isinteger=r.isone=r.isminusone=r.isplusone=r.isplustwo=r.ispositivenumber=r.isnegativenumber=r.isZeroLikeOrNonZeroLikeOrUndetermined=r.isZeroAtomOrTensor=r.isZeroAtom=void 0;var t=xt(),n=fr(),e=Ht(),E=Nr(),g=Nt(),T=Tt(),y=Sr(),o=Er(),l=qt(),d=!1;function s(P){switch(P.k){case t.NUM:if(t.MZERO(P.q.a))return!0;break;case t.DOUBLE:if(P.d===0)return!0;break}return!1}r.isZeroAtom=s;function i(P){return t.istensor(P)?P.tensor.elem.every(rt=>a(rt)):!1}function a(P){return s(P)||i(P)}r.isZeroAtomOrTensor=a;function p(P){let rt=T.Eval_predicate(P);if(a(rt))return!1;if(t.isNumericAtomOrTensor(rt))return!0;if(rt=y.zzfloat(rt),a(rt))return!1;if(t.isNumericAtomOrTensor(rt))return!0;if(n.Find(rt,t.Constants.imaginaryunit)){if(rt=T.Eval_predicate(E.absValFloat(rt)),a(rt))return!1;if(t.isNumericAtomOrTensor(rt))return!0}return null}r.isZeroLikeOrNonZeroLikeOrUndetermined=p;function u(P){switch(P.k){case t.NUM:if(t.MSIGN(P.q.a)===-1)return!0;break;case t.DOUBLE:if(P.d<0)return!0;break}return!1}r.isnegativenumber=u;function _(P){switch(P.k){case t.NUM:if(t.MSIGN(P.q.a)===1)return!0;break;case t.DOUBLE:if(P.d>0)return!0;break}return!1}r.ispositivenumber=_;function b(P){switch(P.k){case t.NUM:if(t.MEQUAL(P.q.a,2)&&t.MEQUAL(P.q.b,1))return!0;break;case t.DOUBLE:if(P.d===2)return!0;break}return!1}r.isplustwo=b;function A(P){switch(P.k){case t.NUM:if(t.MEQUAL(P.q.a,1)&&t.MEQUAL(P.q.b,1))return!0;break;case t.DOUBLE:if(P.d===1)return!0;break}return!1}r.isplusone=A;function x(P){switch(P.k){case t.NUM:if(t.MEQUAL(P.q.a,-1)&&t.MEQUAL(P.q.b,1))return!0;break;case t.DOUBLE:if(P.d===-1)return!0;break}return!1}r.isminusone=x;function M(P){return A(P)||x(P)}r.isone=M;function j(P){return P.k===t.NUM&&t.MEQUAL(P.q.b,1)}r.isinteger=j;function q(P){return P.k===t.DOUBLE?P.d===Math.round(P.d):j(P)}r.isintegerorintegerfloat=q;function O(P){return t.isrational(P)&&t.MEQUAL(P.q.b,1)&&t.MSIGN(P.q.a)===1}r.isnonnegativeinteger=O;function C(P){return j(P)&&t.MSIGN(P.q.a)===1}r.isposint=C;function et(P,rt){if(rt==null&&(rt=o.guess(P)),H(P,rt)&&lt(n.Find(P,t.symbol(t.SYMBOL_X)),n.Find(P,t.symbol(t.SYMBOL_Y)),n.Find(P,t.symbol(t.SYMBOL_Z)))===1)return rt}r.isunivarpolyfactoredorexpandedform=et;function lt(...P){return P.reduce((rt,W)=>rt+Number(W),0)}function H(P,rt){return U(P,rt)}function U(P,rt){return t.ismultiply(P)?P.tail().every(W=>{let f=v(W,rt);return t.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${W}`),f&&console.log(`... tested negative:${W}`)),f}):v(P,rt)}function v(P,rt){return t.ispower(P)?(t.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(C(t.caddr(P)),t.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+D(t.cadr(P),rt)):void 0)),C(t.caddr(P))&&D(t.cadr(P),rt)):(t.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${P}`),D(P,rt))}function S(P,rt){return n.Find(P,rt)?D(P,rt):!1}r.ispolyexpandedform=S;function D(P,rt){return t.isadd(P)?P.tail().every(W=>Z(W,rt)):Z(P,rt)}function Z(P,rt){return t.ismultiply(P)?P.tail().every(W=>F(W,rt)):F(P,rt)}function F(P,rt){return e.equal(P,rt)?!0:t.ispower(P)&&e.equal(t.cadr(P),rt)?C(t.caddr(P)):!n.Find(P,rt)}function Q(P){return u(P)||t.ismultiply(P)&&u(t.cadr(P))}r.isnegativeterm=Q;function R(P){return t.ispower(P)&&t.isrational(t.car(t.cdr(t.cdr(P))))&&u(t.car(t.cdr(P)))?(d&&console.log(`hasNegativeRationalExponent: ${P} has imaginary component`),!0):(d&&console.log(`hasNegativeRationalExponent: ${P} has NO imaginary component`),!1)}function h(P){return t.ismultiply(P)&&e.length(P)===3&&t.isdouble(t.cadr(P))&&R(t.caddr(P))||e.equal(P,t.Constants.imaginaryunit)}function N(P){return t.ismultiply(P)&&e.length(P)===3&&t.isNumericAtom(t.cadr(P))&&e.equal(t.caddr(P),t.Constants.imaginaryunit)||e.equal(P,t.Constants.imaginaryunit)||R(t.caddr(P))?(d&&console.log(`isimaginarynumber: ${P} is imaginary number`),!0):(d&&console.log(`isimaginarynumber: ${P} isn't an imaginary number`),!1)}r.isimaginarynumber=N;function $(P){return t.isadd(P)&&e.length(P)===3&&t.isdouble(t.cadr(P))&&h(t.caddr(P))||h(P)}r.iscomplexnumberdouble=$;function B(P){return d&&t.breakpoint,t.isadd(P)&&e.length(P)===3&&t.isNumericAtom(t.cadr(P))&&N(t.caddr(P))||N(P)?(t.DEBUG&&console.log(`iscomplexnumber: ${P} is imaginary number`),!0):(t.DEBUG&&console.log(`iscomplexnumber: ${P} is imaginary number`),!1)}r.iscomplexnumber=B;function X(P){return j(P)&&P.q.a.isEven()}r.iseveninteger=X;function J(P){return t.isadd(P)&&Q(t.cadr(P))||Q(P)}r.isnegative=J;function pt(P){return t.issymbol(P)?!0:t.iscons(P)?[...P].some(pt):!1}r.issymbolic=pt;function _t(P){return j(P)||t.ispower(P)&&j(t.cadr(P))&&j(t.caddr(P))}r.isintegerfactor=_t;function At(P){return It(P)&&t.MEQUAL(P.q.a.abs(),1)}r.isNumberOneOverSomething=At;function ht(P){return t.ispower(P)&&x(t.caddr(P))}r.isoneover=ht;function It(P){return P.k===t.NUM&&!t.MEQUAL(P.q.b,1)}r.isfraction=It;function Lt(P,rt){switch(P.k){case t.NUM:return t.MEQUAL(P.q.a,rt)&&t.MEQUAL(P.q.b,1);case t.DOUBLE:return P.d===rt;default:return!1}}r.equaln=Lt;function Yt(P,rt,W){switch(P.k){case t.NUM:return t.MEQUAL(P.q.a,rt)&&t.MEQUAL(P.q.b,W);case t.DOUBLE:return P.d===rt/W;default:return!1}}r.equalq=Yt;function Bt(P){return Yt(P,1,2)}r.isoneovertwo=Bt;function Zt(P){return Yt(P,-1,2)}r.isminusoneovertwo=Zt;function ft(P){return t.ispower(P)&&Lt(t.cadr(P),2)&&Yt(t.caddr(P),-1,2)}r.isoneoversqrttwo=ft;function gt(P){return t.ismultiply(P)&&Lt(t.cadr(P),-1)&&ft(t.caddr(P))&&e.length(P)===3}r.isminusoneoversqrttwo=gt;function Pt(P){return t.ismultiply(P)&&Bt(t.cadr(P))&&rr(t.caddr(P))&&e.length(P)===3}r.isSqrtThreeOverTwo=Pt;function kt(P){return t.ismultiply(P)&&Zt(t.cadr(P))&&rr(t.caddr(P))&&e.length(P)===3}r.isMinusSqrtThreeOverTwo=kt;function rr(P){return t.ispower(P)&&Lt(t.cadr(P),3)&&Bt(t.caddr(P))}function nt(P){return P.k===t.DOUBLE||P===t.symbol(t.FLOATF)?!0:t.iscons(P)?[...P].some(nt):!1}r.isfloating=nt;function Ot(P){return e.equal(P,t.Constants.imaginaryunit)}r.isimaginaryunit=Ot;function w(P){let rt=0;if(!t.ismultiply(P))return 0;if(e.equal(t.cadr(P),t.Constants.imaginaryunit))return t.caddr(P)!==t.symbol(t.PI)||e.length(P)!==3?0:2;if(!t.isNumericAtom(t.cadr(P))||!e.equal(t.caddr(P),t.Constants.imaginaryunit)||t.cadddr(P)!==t.symbol(t.PI)||e.length(P)!==4)return 0;let W=g.nativeInt(l.multiply(t.cadr(P),g.integer(2)));if(isNaN(W))return 0;switch(W<1&&(rt=1,W=-W),W%4){case 0:W=1;break;case 1:W=rt?4:3;break;case 2:W=2;break;case 3:W=rt?3:4}return W}r.isquarterturn=w;function vt(P){let rt=0;return P===t.symbol(t.PI)?2:!t.ismultiply(P)||!t.isNumericAtom(t.cadr(P))||t.caddr(P)!==t.symbol(t.PI)||e.length(P)!==3||(rt=g.nativeInt(l.multiply(t.cadr(P),g.integer(2))),isNaN(rt))?0:(rt<0?rt=4- -rt%4:rt=1+(rt-1)%4,rt)}r.isnpi=vt}),Pr=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.yn=r.jn=r.append=r.__range__=r.isalnumorunderscore=r.isalpha=r.isdigit=r.isspace=r.clear_term=r.doubleToReasonableString=r.strcmp=void 0;var t=zt(),n=Nt(),e=wt(),E=xt(),g=Kt(),T=St();function y(x,M){return x===M?0:x>M?1:-1}r.strcmp=y;function o(x){let M;if(E.defs.codeGen||E.defs.fullDoubleOutput)return""+x;if(e.isZeroAtomOrTensor(g.get_binding(E.symbol(E.FORCE_FIXED_PRINTOUT))))M=""+x,E.defs.printMode===E.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(M)?M=M.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):M=M.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(M)?M=M.replace(/e(.*)/gm,"*10^($1)"):M=M.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let j=n.nativeInt(g.get_binding(E.symbol(E.MAX_FIXED_PRINTOUT_DIGITS)));M=""+x.toFixed(j),M=M.replace(/(\.\d*?[1-9])0+$/gm,"$1"),M=M.replace(/\.0+$/gm,""),M.indexOf(".")===-1&&(M+=".0"),parseFloat(M)!==x&&(M=x.toFixed(j)+"...")}return M}r.doubleToReasonableString=o;function l(){}r.clear_term=l;function d(x){return x==null?!1:x===" "||x==="	"||x===`
`||x==="\v"||x==="\f"||x==="\r"}r.isspace=d;function s(x){return x==null?!1:/^\d+$/.test(x)}r.isdigit=s;function i(x){return x==null?!1:x.search(/[^A-Za-z]/)===-1}r.isalpha=i;function a(x){return x==null?!1:x.search(/[^A-Za-z_]/)===-1}function p(x){return x==null?!1:a(x)||s(x)}r.isalnumorunderscore=p;function u(x,M,j){let q=[],O=x<M,C=j?O?M+1:M-1:M;for(let et=x;O?et<C:et>C;O?et++:et--)q.push(et);return q}r.__range__=u;function _(x,M){let j=[];return E.iscons(x)&&j.push(...x),E.iscons(M)&&j.push(...M),T.makeList(...j)}r.append=_;function b(x,M){t.stop("Not implemented")}r.jn=b;function A(x,M){t.stop("Not implemented")}r.yn=A}),js=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.qadd=void 0;var t=xt(),n=Nt(),e=Be(),E=Jr(),g=Tr();function T(y,o){let l=g.mmul(y.q.a,o.q.b),d=g.mmul(y.q.b,o.q.a),s=e.madd(l,d);if(t.MZERO(s))return t.Constants.zero;let i=g.mmul(y.q.b,o.q.b),a=E.mgcd(s,i);a=n.makeSignSameAs(a,i);let p=g.mdiv(s,a),u=g.mdiv(i,a);return new t.Num(p,u)}r.qadd=T}),Ys=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.qdiv=void 0;var t=xt(),n=zt(),e=Nt(),E=Jr(),g=Tr();function T(y,o){if(t.MZERO(o.q.a)&&n.stop("divide by zero"),t.MZERO(y.q.a))return t.Constants.zero;let l=g.mmul(y.q.a,o.q.b),d=g.mmul(y.q.b,o.q.a),s=E.mgcd(l,d);return s=e.makeSignSameAs(s,d),new t.Num(g.mdiv(l,s),g.mdiv(d,s))}r.qdiv=T}),Xs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.qmul=void 0;var t=xt(),n=Nt(),e=Jr(),E=Tr();function g(T,y){if(t.MZERO(T.q.a)||t.MZERO(y.q.a))return t.Constants.zero;let o=E.mmul(T.q.a,y.q.a),l=E.mmul(T.q.b,y.q.b),d=e.mgcd(o,l);return d=n.makeSignSameAs(d,l),new t.Num(E.mdiv(o,d),E.mdiv(l,d))}r.qmul=g}),Nt=it(r=>{"use strict";var t=r&&r.__importDefault||function(ft){return ft&&ft.__esModule?ft:{default:ft}};Object.defineProperty(r,"__esModule",{value:!0}),r.bignum_factorial=r.bignum_float=r.pop_number=r.nativeDouble=r.pop_double=r.gcd_numbers=r.print_number=r.bignum_scan_float=r.bignum_scan_integer=r.nativeInt=r.pop_integer=r.rational=r.push_rational=r.double=r.push_double=r.integer=r.push_integer=r.convert_rational_to_double=r.bignum_power_number=r.mp_denominator=r.mp_numerator=r.bignum_truncate=r.negate_number=r.compare_numbers=r.invert_number=r.divide_numbers=r.multiply_numbers=r.add_numbers=r.makePositive=r.makeSignSameAs=r.setSignTo=r.isSmall=r.mint=void 0;var n=t(dr()),e=xt(),E=Cr(),g=Pr(),T=zt(),y=Mt(),o=wt(),l=Jr(),d=Tr(),s=ve(),i=qt(),a=js(),p=Ys(),u=Xs();function _(ft){return n.default(ft)}r.mint=_;function b(ft){return ft.geq(Number.MIN_SAFE_INTEGER)&&ft.leq(Number.MAX_SAFE_INTEGER)}r.isSmall=b;function A(ft,gt){if(ft.isPositive()){if(gt<0)return ft.multiply(n.default(-1))}else if(gt>0)return ft.multiply(n.default(-1));return ft}r.setSignTo=A;function x(ft,gt){if(ft.isPositive()){if(gt.isNegative())return ft.multiply(n.default(-1))}else if(gt.isPositive())return ft.multiply(n.default(-1));return ft}r.makeSignSameAs=x;function M(ft){return ft.isNegative()?ft.multiply(n.default(-1)):ft}r.makePositive=M;function j(ft,gt){if(e.isrational(ft)&&e.isrational(gt))return a.qadd(ft,gt);let Pt=e.isdouble(ft)?ft.d:Z(ft),kt=e.isdouble(gt)?gt.d:Z(gt);return h(Pt+kt)}r.add_numbers=j;function q(ft,gt){if(e.isrational(ft)&&e.isrational(gt))return u.qmul(ft,gt);let Pt=e.isdouble(ft)?ft.d:Z(ft),kt=e.isdouble(gt)?gt.d:Z(gt);return new e.Double(Pt*kt)}r.multiply_numbers=q;function O(ft,gt){if(e.isrational(ft)&&e.isrational(gt))return p.qdiv(ft,gt);o.isZeroAtomOrTensor(gt)&&T.stop("divide by zero");let Pt=e.isdouble(ft)?ft.d:Z(ft),kt=e.isdouble(gt)?gt.d:Z(gt);return new e.Double(Pt/kt)}r.divide_numbers=O;function C(ft){if(o.isZeroAtomOrTensor(ft)&&T.stop("divide by zero"),e.isdouble(ft))return new e.Double(1/ft.d);let gt=n.default(ft.q.a),Pt=n.default(ft.q.b);return Pt=x(Pt,gt),gt=A(gt,1),new e.Num(Pt,gt)}r.invert_number=C;function et(ft,gt){let Pt=d.mmul(ft.q.a,gt.q.b),kt=d.mmul(ft.q.b,gt.q.a);return E.mcmp(Pt,kt)}function lt(ft,gt){if(e.isrational(ft)&&e.isrational(gt))return et(ft,gt);let Pt=e.isdouble(ft)?ft.d:Z(ft),kt=e.isdouble(gt)?gt.d:Z(gt);return Pt<kt?-1:Pt>kt?1:0}r.compare_numbers=lt;function H(ft){if(o.isZeroAtomOrTensor(ft))return ft;switch(ft.k){case e.NUM:return new e.Num(n.default(ft.q.a.multiply(n.default.minusOne)),n.default(ft.q.b));case e.DOUBLE:return new e.Double(-ft.d);default:T.stop("bug caught in mp_negate_number")}}r.negate_number=H;function U(ft){let gt=d.mdiv(ft.q.a,ft.q.b);return new e.Num(gt)}r.bignum_truncate=U;function v(ft){return e.isrational(ft)?new e.Num(n.default(ft.q.a)):e.Constants.one}r.mp_numerator=v;function S(ft){return e.isrational(ft)?new e.Num(n.default(ft.q.b)):e.Constants.one}r.mp_denominator=S;function D(ft,gt){let Pt=s.mpow(ft.q.a,Math.abs(gt)),kt=s.mpow(ft.q.b,Math.abs(gt));if(gt<0){let rr=Pt;Pt=kt,kt=rr,Pt=x(Pt,kt),kt=A(kt,1)}return new e.Num(Pt,kt)}r.bignum_power_number=D;function Z(ft){ft.q==null&&e.breakpoint;let gt=ft.q.a.divmod(ft.q.b);return gt.quotient.toJSNumber()+gt.remainder.toJSNumber()/ft.q.b.toJSNumber()}r.convert_rational_to_double=Z;function F(ft){e.DEBUG&&console.log(`pushing integer ${ft}`),y.push(Q(ft))}r.push_integer=F;function Q(ft){return new e.Num(n.default(ft))}r.integer=Q;function R(ft){y.push(h(ft))}r.push_double=R;function h(ft){return new e.Double(ft)}r.double=h;function N(ft,gt){y.push($(ft,gt))}r.push_rational=N;function $(ft,gt){return new e.Num(n.default(ft),n.default(gt))}r.rational=$;function B(){let ft=y.pop();return X(ft)}r.pop_integer=B;function X(ft){let gt=NaN;switch(ft.k){case e.NUM:o.isinteger(ft)&&b(ft.q.a)&&(gt=ft.q.a.toJSNumber());break;case e.DOUBLE:e.DEBUG&&console.log("popping integer but double is found"),Math.floor(ft.d)===ft.d&&(e.DEBUG&&console.log("...although it's an integer"),gt=ft.d);break}return gt}r.nativeInt=X;function J(ft){let gt=0,Pt=ft[gt];(Pt==="+"||Pt==="-")&&gt++;let kt=n.default(ft.substring(gt)),rr=new e.Num(kt);Pt==="-"&&(rr=i.negate(rr)),y.push(rr)}r.bignum_scan_integer=J;function pt(ft){R(parseFloat(ft))}r.bignum_scan_float=pt;function _t(ft,gt){let Pt="",kt="",rr="";switch(ft.k){case e.NUM:var nt=ft.q.a.toString();gt||nt[0]==="-"&&(nt=nt.substring(1)),e.defs.printMode===e.PRINTMODE_LATEX&&o.isfraction(ft)&&(nt="\\frac{"+nt+"}{"),Pt+=nt,o.isfraction(ft)&&(e.defs.printMode!==e.PRINTMODE_LATEX&&(Pt+="/"),kt=ft.q.b.toString(),e.defs.printMode===e.PRINTMODE_LATEX&&(kt+="}"),Pt+=kt);break;case e.DOUBLE:nt=g.doubleToReasonableString(ft.d),gt||nt[0]==="-"&&(nt=nt.substring(1)),Pt+=nt;break}return Pt}r.print_number=_t;function At(ft,gt){let Pt=l.mgcd(ft.q.a,gt.q.a),kt=l.mgcd(ft.q.b,gt.q.b);return new e.Num(A(Pt,1),kt)}r.gcd_numbers=At;function ht(){let ft=y.pop();return It(ft)}r.pop_double=ht;function It(ft){let gt=0;switch(ft.k){case e.NUM:gt=Z(ft);break;case e.DOUBLE:({d:gt}=ft);break;default:gt=0}return gt}r.nativeDouble=It;function Lt(){let ft=y.pop();return e.isNumericAtom(ft)||T.stop("not a number"),ft}r.pop_number=Lt;function Yt(ft){let gt=Z(ft);return new e.Double(gt)}r.bignum_float=Yt;function Bt(ft){return new e.Num(Zt(ft))}r.bignum_factorial=Bt;function Zt(ft){let gt;if(ft===0||ft===1)return gt=n.default(1),gt;gt=n.default(2);let Pt=n.default(0);if(3<=ft)for(let kt=3;kt<=ft;kt++)Pt=n.default(kt),gt=d.mmul(gt,Pt);return gt}}),cn=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.polyform=r.bake=void 0;var t=xt(),n=Nt(),e=Xr(),E=wt(),g=St();function T(s){return t.doexpand(y,s)}r.bake=T;function y(s){let i=E.ispolyexpandedform(s,t.symbol(t.SYMBOL_S)),a=E.ispolyexpandedform(s,t.symbol(t.SYMBOL_T)),p=E.ispolyexpandedform(s,t.symbol(t.SYMBOL_X)),u=E.ispolyexpandedform(s,t.symbol(t.SYMBOL_Y)),_=E.ispolyexpandedform(s,t.symbol(t.SYMBOL_Z)),b;return i&&!a&&!p&&!u&&!_?b=l(s,t.symbol(t.SYMBOL_S)):!i&&a&&!p&&!u&&!_?b=l(s,t.symbol(t.SYMBOL_T)):!i&&!a&&p&&!u&&!_?b=l(s,t.symbol(t.SYMBOL_X)):!i&&!a&&!p&&u&&!_?b=l(s,t.symbol(t.SYMBOL_Y)):!i&&!a&&!p&&!u&&_?b=l(s,t.symbol(t.SYMBOL_Z)):t.iscons(s)&&t.car(s)!==t.symbol(t.FOR)?b=g.makeList(t.car(s),...s.tail().map(T)):b=s,b}function o(s,i){return E.ispolyexpandedform(s,i)?l(s,i):t.iscons(s)?g.makeList(t.car(s),...s.tail().map(a=>o(a,i))):s}r.polyform=o;function l(s,i){let a=e.coeff(s,i),p=[];for(let u=a.length-1;u>=0;u--){let _=a[u];p.push(...d(u,_,i))}return p.length>1?new t.Cons(t.symbol(t.ADD),g.makeList(...p)):p[0]}function d(s,i,a){if(E.isZeroAtomOrTensor(i))return[];if(s===0)return t.isadd(i)?i.tail():[i];let p=[];return t.ismultiply(i)?p.push(...i.tail()):E.equaln(i,1)||p.push(i),s===1?p.push(a):p.push(g.makeList(t.symbol(t.POWER),a,n.integer(s))),p.length>1?[g.makeList(t.symbol(t.MULTIPLY),...p)]:p}}),zt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.computeResultsAndJavaScriptFromAlgebra=r.computeDependenciesFromAlgebra=r.check_esc_flag=r.top_level_eval=r.check_stack=r.run=r.findDependenciesInScript=r.stop=void 0;var t=Mt(),n=cn(),e=rn(),E=Tt(),g=wt(),T=Ir(),y=Ue(),o=Ur(),l=Gr(),d=_r(),s=xt(),i=de(),a=Kt();function p(H){s.defs.errorMessage+="Stop: ",s.defs.errorMessage+=H;let U=s.defs.errorMessage;throw s.defs.errorMessage="",t.moveTos(0),new Error(U)}r.stop=p;function u(H,U=!1){s.DEBUG&&console.log(`stringToBeParsed: ${H}`);let v=new Date().getTime(),S=!0;s.defs.codeGen=!0,s.defs.symbolsDependencies={},s.defs.symbolsHavingReassignments=[],s.defs.symbolsInExpressionsWithoutAssignments=[],s.defs.patternHasBeenFound=!1;let D=0,Z="",F="",Q=0,R={affectsVariables:[],affectedBy:[]},h=H;for(;;){try{s.defs.errorMessage="",q(),s.DEBUG&&console.log("findDependenciesInScript: scanning"),Q=o.scan(H.substring(D)),s.DEBUG&&console.log("scanned"),t.pop(),q()}catch(pt){s.PRINTOUTRESULT&&console.log(pt),s.defs.errorMessage=pt+"",s.reset_after_error();break}if(Q===0)break;D+=Q}let N="";s.DEBUG&&console.log("all local dependencies ----------------"),N+="All local dependencies: ";for(let pt in s.defs.symbolsDependencies){let _t=s.defs.symbolsDependencies[pt];s.DEBUG&&console.log(`variable ${pt} depends on: `),R.affectsVariables.push(pt),N+=" variable "+pt+" depends on: ";for(let At of Array.from(_t))s.DEBUG&&console.log(`    ${At}`),At[0]!=="'"&&R.affectedBy.push(At),N+=At+", ";N+="; "}N+=". ",s.DEBUG&&console.log("Symbols with reassignments ----------------"),N+="Symbols with reassignments: ";for(let pt of Array.from(s.defs.symbolsHavingReassignments))R.affectedBy.indexOf(pt)===-1&&(R.affectedBy.push(pt),N+=pt+", ");N+=". ",s.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),N+="Symbols in expressions without assignments: ";for(let pt of Array.from(s.defs.symbolsInExpressionsWithoutAssignments))R.affectedBy.indexOf(pt)===-1&&(R.affectedBy.push(pt),N+=pt+", ");N+=". ",R.affectedBy.push("PATTERN_DEPENDENCY"),s.defs.patternHasBeenFound&&(R.affectsVariables.push("PATTERN_DEPENDENCY"),N+=" - PATTERN_DEPENDENCY inserted - "),s.DEBUG&&console.log("All dependencies recursively ----------------"),N+="All dependencies recursively: ";let $=["",""],B="",X="";if(s.defs.errorMessage===""&&!U){try{Z="",F="",$=j(H,!0),Z="",F=""}catch(pt){let _t=pt;s.PRINTOUTRESULT&&console.log(_t),s.defs.errorMessage=_t.toString(),i.init()}if(s.defs.errorMessage==="")for(let pt in s.defs.symbolsDependencies){s.defs.codeGen=!0,s.DEBUG&&console.log("  variable "+pt+" is: "+a.get_binding(a.usr_symbol(pt)).toString()),s.defs.codeGen=!1,s.DEBUG&&console.log(`  variable ${pt} depends on: `),N+=" variable "+pt+" depends on: ";var J=[];let _t=[],At=[];_(pt,J,[],_t,[],At);for(let Lt of Array.from(_t))s.DEBUG&&console.log(`    --> cycle through ${Lt}`);for(let Lt of Array.from(J))s.DEBUG&&console.log(`    ${Lt}`),N+=Lt+", ";N+="; ";for(let Lt of Array.from(At))N+=" "+Lt+", ";s.DEBUG&&console.log(`  code generation:${pt} is: ${a.get_binding(a.usr_symbol(pt))}`),t.push(a.get_binding(a.usr_symbol(pt)));let ht=[],It=[];for(let Lt of Array.from(J))if(Lt[0]==="'"){let Yt=Lt.substring(1),Bt=a.usr_symbol(Yt),Zt=a.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+Yt);ht.push(Bt),It.push(Zt),t.push(d.subst(t.pop(),Bt,Zt)),s.DEBUG&&console.log(`after substitution: ${t.top()}`)}try{t.push(l.simplifyForCodeGeneration(t.pop()))}catch(Lt){s.PRINTOUTRESULT&&console.log(Lt),s.defs.errorMessage=Lt+"",i.init()}for(let Lt=0;Lt<ht.length;Lt++)t.push(d.subst(t.pop(),It[Lt],ht[Lt]));if(e.clearRenamedVariablesToAvoidBindingToExternalScope(),s.defs.errorMessage===""){let Lt=t.pop(),Yt=[];a.collectUserSymbols(Lt,Yt),Z="",F="",s.defs.codeGen=!0;let Bt=Lt.toString();s.defs.codeGen=!1;let Zt=s.defs.printMode;s.defs.printMode=s.PRINTMODE_LATEX;let ft=Lt.toString();if(s.defs.printMode=Zt,_t.indexOf(pt)!==-1)B+="// "+pt+" is part of a cyclic dependency, no code generated.",X+="#"+pt+" is part of a cyclic dependency, no code generated.";else if(Yt=Yt.filter(gt=>s.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(gt+"")===-1),Yt=Yt.filter(gt=>J.indexOf(gt+"")!==-1||J.indexOf("'"+gt)!==-1),Yt.length!==0){let gt="(";for(let Pt of Array.from(Yt))Pt.printname!==pt&&(gt+=Pt.printname+", ");gt=gt.replace(/, $/gm,""),gt+=")",B+=pt+" = function "+gt+" { return ( "+Bt+" ); }",X+=pt+gt+" = "+ft}else B+=pt+" = "+Bt+";",X+=pt+" = "+ft;B+=`
`,X+=`
`,s.DEBUG&&console.log(`    ${B}`)}}}return B=B.replace(/\n$/gm,""),X=X.replace(/\n$/gm,""),s.defs.symbolsDependencies={},s.defs.symbolsHavingReassignments=[],s.defs.patternHasBeenFound=!1,s.defs.symbolsInExpressionsWithoutAssignments=[],s.DEBUG&&console.log(`testable string: ${N}`),M&&console.log(`findDependenciesInScript time for: ${h} : ${new Date().getTime()-v}ms`),[N,$[0],B,X,$[1],s.defs.errorMessage,R]}r.findDependenciesInScript=u;function _(H,U,v,S,D,Z){if(v.push(H),s.defs.symbolsDependencies[D[D.length-1]]!=null&&s.defs.symbolsDependencies[D[D.length-1]].indexOf("'"+H)!==-1){s.DEBUG&&console.log("can't keep following the chain of "+H+" because it's actually a variable bound to a parameter"),U.indexOf("'"+H)===-1&&U.indexOf(H)===-1&&U.push(H);return}if(D.push(H),s.defs.symbolsDependencies[H]==null)U.indexOf(H)===-1&&U.push(H);else for(let F of Array.from(s.defs.symbolsDependencies[H]))if(D.indexOf(F)!==-1){s.DEBUG&&console.log("  found cycle:");let Q="";for(let R of Array.from(D))S.indexOf(R)===-1&&S.push(R),s.DEBUG&&console.log(R+" --> "),Q+=R+" --> ";s.DEBUG&&console.log(` ... then ${F} again`),Q+=" ... then "+F+" again",Z.push(Q),S.indexOf(F)===-1&&S.push(F)}else _(F,U,v,S,D,Z),D.pop()}var b="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function A(H){return H=H.replace(/\n/g,""),H=H.replace(/_/g,"} \\_ \\text{"),H=H.replace(new RegExp(String.fromCharCode(s.transpose_unicode),"g"),"}{}^{T}\\text{"),H=H.replace(new RegExp(String.fromCharCode(s.dotprod_unicode),"g"),"}\\cdot \\text{"),H=H.replace("Stop:","}  \\quad \\text{Stop:"),H=H.replace("->","}  \\rightarrow \\text{"),H=H.replace("?","}\\enspace "+b+" \\enspace  \\text{"),H="$$\\text{"+H.replace(/\n/g,"")+"}$$",H}function x(H){return H=H.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(s.dotprod_unicode)),H=H.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(s.dotprod_unicode)),H=H.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(s.dotprod_unicode)),H=H.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(s.dotprod_unicode)),H=H.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(s.dotprod_unicode)),H}var M=!1;function j(H,U=!1){let v,S,D,Z=new Date().getTime();H=x(H),s.defs.inited||(s.defs.inited=!0,i.init());let F=0,Q=0,R="",h="",N,$;for(;;){try{s.defs.errorMessage="",q(),F=o.scan(H.substring(Q)),v=t.pop(),q()}catch(X){s.PRINTOUTRESULT&&console.log(X),R+=X.message,U&&(h+=A(X.message)),s.reset_after_error();break}if(F===0)break;Q+=F,t.push(v);let B=!1;try{s.defs.stringsEmittedByUserPrintouts="",O(),S=t.pop(),q(),s.isstr(S)&&(s.DEBUG&&console.log(S.str),s.DEBUG&&console.log(`
`)),S===s.symbol(s.NIL)?($=s.defs.stringsEmittedByUserPrintouts,U&&(N="$$"+s.defs.stringsEmittedByUserPrintouts+"$$")):($=T.print_expr(S),$+=`
`,U&&(N="$$"+T.collectLatexStringFromReturnValue(S)+"$$",s.DEBUG&&console.log(`collectedLatexResult: ${N}`))),R+=$,U&&(h+=N),s.PRINTOUTRESULT&&(s.DEBUG&&console.log("printline"),s.DEBUG&&console.log($)),s.PRINTOUTRESULT&&(s.DEBUG&&console.log("display:"),y.print2dascii(S)),U&&(h+=`
`)}catch(X){B=!0,$=X.message,U&&(N=A(X.message)),s.PRINTOUTRESULT&&console.log($),R+=$,$!==""&&(R+=`
`),U&&(h+=N,h+=`
`),i.init()}}if(R[R.length-1]===`
`&&(R=R.substring(0,R.length-1)),U&&h[h.length-1]===`
`&&(h=h.substring(0,h.length-1)),U?(s.DEBUG&&console.log(`allReturnedLatexStrings: ${h}`),D=[R,h]):D=R,M){let B="run time on: "+H+" : "+(new Date().getTime()-Z)+"ms";console.log(B)}return R="",h="",D}r.run=j;function q(){s.defs.tos!==0&&(s.breakpoint,p("stack error")),s.defs.frame!==s.TOS&&(s.breakpoint,p("frame error")),s.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(s.breakpoint,p("symbols evaluation still ongoing?")),s.defs.evaluatingAsFloats&&(s.breakpoint,p("numeric evaluation still ongoing?")),s.defs.evaluatingPolar&&(s.breakpoint,p("evaluation of polar still ongoing?"))}r.check_stack=q;function O(){s.DEBUG&&console.log("#### top level eval"),s.defs.trigmode=0;let H=s.symbol(s.AUTOEXPAND);s.defs.expanding=!g.isZeroAtomOrTensor(a.get_binding(H));let U=t.top();t.push(E.Eval(t.pop()));let v=t.top();if(v!==s.symbol(s.NIL)){if(a.set_binding(s.symbol(s.LAST),v),!g.isZeroAtomOrTensor(a.get_binding(s.symbol(s.BAKE)))){let S=n.bake(t.pop());v=S,t.push(S)}(U===s.symbol(s.SYMBOL_I)||U===s.symbol(s.SYMBOL_J))&&g.isimaginaryunit(v)||(g.isimaginaryunit(a.get_binding(s.symbol(s.SYMBOL_J)))?t.push(d.subst(t.pop(),s.Constants.imaginaryunit,s.symbol(s.SYMBOL_J))):g.isimaginaryunit(a.get_binding(s.symbol(s.SYMBOL_I)))&&t.push(d.subst(t.pop(),s.Constants.imaginaryunit,s.symbol(s.SYMBOL_I))))}}r.top_level_eval=O;function C(){s.defs.esc_flag&&p("esc key")}r.check_esc_flag=C;function et(H){let U,v;s.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let S=H,D=!0;if(s.defs.called_from_Algebra_block=!0,H=x(H),!D){s.defs.userSimplificationsInListForm=[];let Z="";for(let F of Array.from(s.defs.userSimplificationsInListForm))Z+="silentpattern("+s.car(F)+","+s.car(s.cdr(F))+","+s.car(s.cdr(s.cdr(F)))+`)
`;[U,v]=e.do_clearall(),H=Z+H,s.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+H)}if(s.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let Z of Array.from(s.defs.userSimplificationsInListForm))console.log(s.car(Z)+","+s.cdr(Z)+")");console.log("...end of list --------------- ")}return s.defs.called_from_Algebra_block=!1,u(H,!0)[6]}r.computeDependenciesFromAlgebra=et;function lt(H){let U,v,S,D,Z,F,Q,R,h,N=H,$=!0;s.defs.called_from_Algebra_block=!0;let B=new Date().getTime();M&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+H+" at: "+new Date),H=x(H);let X=H;if(s.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(Z of Array.from(s.defs.userSimplificationsInListForm))console.log(s.car(Z)+","+s.cdr(Z)+")");console.log("...end of list --------------- ")}if(!$){s.defs.userSimplificationsInListForm=[];let J="";for(Z of Array.from(s.defs.userSimplificationsInListForm))J+="silentpattern("+s.car(Z)+","+s.car(s.cdr(Z))+","+s.car(s.cdr(s.cdr(Z)))+`)
`;[U,v]=e.do_clearall(),H=J+H,s.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+H)}return[h,R,S,Q,F,s.defs.errorMessage,D]=u(H),s.defs.called_from_Algebra_block=!1,(Q!==""||s.defs.errorMessage!=="")&&(R+=`
`+Q,s.defs.errorMessage!==""&&(R+=`
`+s.defs.errorMessage),R=R.replace(/\n/g,`

`),F+=`
$$`+Q+"$$",s.defs.errorMessage!==""&&(F+=A(s.defs.errorMessage)),F=F.replace(/\n/g,`

`)),F=F.replace(/\n*/,""),F=F.replace(/\$\$\$\$\n*/g,""),S=S.replace(/Math\./g,""),S=S.replace(/\n/g,`

`),M&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+X+" : "+(new Date().getTime()-B)+"ms"),{code:S,result:F,latexResult:F,dependencyInfo:D}}r.computeResultsAndJavaScriptFromAlgebra=lt}),Mt=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dupl=r.swap=r.restore=r.save=r.pop_n_items=r.pop=r.top=r.moveTos=r.push_all=r.push=void 0;var t=zt(),n=xt(),e=0;function E(p){return p==null&&n.breakpoint,p===n.symbol(n.NIL)&&(e++,n.DEBUG&&console.log(`pushing symbol(NIL) #${e}`)),n.defs.tos>=n.defs.frame&&t.stop("stack overflow"),n.defs.stack[n.defs.tos++]=p}r.push=E;function g(p){for(;p.length>0;)E(p.shift())}r.push_all=g;function T(p){if(n.defs.tos<=p){n.defs.tos=p;return}for(;n.defs.tos>p;)n.defs.stack[n.defs.tos]=null,n.defs.tos--}r.moveTos=T;function y(){return n.defs.stack[n.defs.tos-1]}r.top=y;function o(){n.defs.tos===0&&(n.breakpoint,t.stop("stack underflow")),y()==null&&n.breakpoint;let p=n.defs.stack[--n.defs.tos];return n.defs.stack[n.defs.tos]=null,p}r.pop=o;function l(p){let u=[];for(let _=0;_<p;_++)u.push(o());return u}r.pop_n_items=l;function d(){let p,u,_,b,A,x,M,j,q,O;n.defs.frame-=10,n.defs.frame<n.defs.tos&&(n.breakpoint,t.stop("frame overflow, circular reference?")),n.defs.stack[n.defs.frame+0]=p,n.defs.stack[n.defs.frame+1]=u,n.defs.stack[n.defs.frame+2]=_,n.defs.stack[n.defs.frame+3]=b,n.defs.stack[n.defs.frame+4]=A,n.defs.stack[n.defs.frame+5]=x,n.defs.stack[n.defs.frame+6]=M,n.defs.stack[n.defs.frame+7]=j,n.defs.stack[n.defs.frame+8]=q,n.defs.stack[n.defs.frame+9]=O}r.save=d;function s(){let p,u,_,b,A,x,M,j,q,O;return n.defs.frame>n.TOS-10&&t.stop("frame underflow"),p=n.defs.stack[n.defs.frame+0],u=n.defs.stack[n.defs.frame+1],_=n.defs.stack[n.defs.frame+2],b=n.defs.stack[n.defs.frame+3],A=n.defs.stack[n.defs.frame+4],x=n.defs.stack[n.defs.frame+5],M=n.defs.stack[n.defs.frame+6],j=n.defs.stack[n.defs.frame+7],q=n.defs.stack[n.defs.frame+8],O=n.defs.stack[n.defs.frame+9],n.defs.frame+=10}r.restore=s;function i(){let p=o(),u=o();E(p),E(u)}r.swap=i;function a(){let p=o();return E(p),E(p)}r.dupl=a}),xt=it(r=>{"use strict";var t=r&&r.__importDefault||function(Y){return Y&&Y.__esModule?Y:{default:Y}};Object.defineProperty(r,"__esModule",{value:!0}),r.evalFloats=r.evalPolar=r.doexpand=r.noexpand=r.Constants=r.$=r.reset_after_error=r.MEQUAL=r.MZERO=r.MSIGN=r.isidentitymatrix=r.isinv=r.istranspose=r.isinnerordot=r.isfactorial=r.ispower=r.ismultiply=r.isadd=r.caddaddr=r.cdddaddr=r.caddadr=r.cddaddr=r.cadaddr=r.caddddr=r.cddddr=r.cadddr=r.cdaddr=r.caddar=r.cadadr=r.caaddr=r.cdddr=r.cddar=r.cdadr=r.cadar=r.caddr=r.caadr=r.cddr=r.cdar=r.cadr=r.caar=r.cdr=r.car=r.iskeyword=r.issymbol=r.isNumericAtomOrTensor=r.istensor=r.isstr=r.isNumericAtom=r.isdouble=r.isrational=r.iscons=r.symbol=r.dotprod_unicode=r.transpose_unicode=r.isSymbolReclaimable=r.binding=r.symtab=r.logbuf=r.mtotal=r.primetab=r.parse_time_simplifications=r.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=r.MAXDIM=r.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=r.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=r.MAXPRIMETAB=r.TOS=r.E=r.C6=r.C5=r.C4=r.C3=r.C2=r.C1=r.SYMBOL_X_UNDERSCORE=r.SYMBOL_B_UNDERSCORE=r.SYMBOL_A_UNDERSCORE=r.SYMBOL_IDENTITY_MATRIX=r.SYMBOL_Z=r.SYMBOL_Y=r.SYMBOL_X=r.SYMBOL_T=r.SYMBOL_S=r.SYMBOL_R=r.SYMBOL_N=r.SYMBOL_J=r.SYMBOL_I=r.SYMBOL_D=r.SYMBOL_C=r.SYMBOL_B=r.SYMBOL_A=r.PI=r.VERSION=r.SECRETX=r.METAX=r.METAB=r.METAA=r.DRAWX=r.YYE=r.MAX_FIXED_PRINTOUT_DIGITS=r.FORCE_FIXED_PRINTOUT=r.TRACE=r.ASSUME_REAL_VARIABLES=r.BAKE=r.AUTOEXPAND=r.LAST_PLAIN_PRINT=r.LAST_LIST_PRINT=r.LAST_LATEX_PRINT=r.LAST_FULL_PRINT=r.LAST_2DASCII_PRINT=r.LAST_PRINT=r.LAST=r.NIL=r.ZERO=r.UNIT=r.TRANSPOSE=r.TESTLT=r.TESTLE=r.TESTGT=r.TESTGE=r.TESTEQ=r.TEST=r.TAYLOR=r.TANH=r.TAN=r.SYMBOLSINFO=r.SUM=r.SUBST=r.STOP=r.SQRT=r.SHAPE=r.SINH=r.SIN=r.SIMPLIFY=r.SILENTPATTERN=r.SGN=r.SETQ=r.ROOTS=r.YYRECT=r.ROUND=r.REAL=r.RATIONALIZE=r.RANK=r.QUOTIENT=r.QUOTE=r.PRODUCT=r.PRINTPLAIN=r.PRINTLIST=r.PRINTLATEX=r.PRINTFULL=r.PRINT2DASCII=r.PRINT=r.PRINT_LEAVE_X_ALONE=r.PRINT_LEAVE_E_ALONE=r.PRIME=r.POWER=r.POLAR=r.PATTERNSINFO=r.PATTERN=r.OUTER=r.OR=r.OPERATOR=r.NUMERATOR=r.NUMBER=r.NROOTS=r.NOT=r.MULTIPLY=r.MOD=r.LOOKUP=r.LOG=r.LEGENDRE=r.LEADING=r.LCM=r.LAGUERRE=r.ISPRIME=r.ISINTEGER=r.INVG=r.INV=r.INTEGRAL=r.INNER=r.INDEX=r.IMAG=r.HILBERT=r.HERMITE=r.GCD=r.GAMMA=r.FUNCTION=r.FOR=r.FLOOR=r.FLOATF=r.FILTER=r.FACTORPOLY=r.FACTORIAL=r.FACTOR=r.EXPSIN=r.EXPCOS=r.EXPAND=r.EXP=r.EVAL=r.ERFC=r.ERF=r.EIGENVEC=r.EIGENVAL=r.EIGEN=r.DSOLVE=r.DRAW=r.DOT=r.DO=r.DIVISORS=r.DIRAC=r.DIM=r.DET=r.DERIVATIVE=r.DENOMINATOR=r.DEGREE=r.DEFINT=r.DECOMP=r.COSH=r.COS=r.CONTRACT=r.CONJ=r.CONDENSE=r.COFACTOR=r.COEFF=r.CLOCK=r.CLEARPATTERNS=r.CLEARALL=r.CLEAR=r.CIRCEXP=r.CHOOSE=r.CHECK=r.CEILING=r.BINOMIAL=r.BINDING=r.BESSELY=r.BESSELJ=r.ATOMIZE=r.ARG=r.ARCTANH=r.ARCTAN=r.ARCSINH=r.ARCSIN=r.ARCCOSH=r.ARCCOS=r.APPROXRATIO=r.AND=r.ADJ=r.ADD=r.ABS=r.SYM=r.TENSOR=r.STR=r.DOUBLE=r.NUM=r.CONS=r.Sym=r.Tensor=r.Str=r.Double=r.Num=r.Cons=r.BaseAtom=r.avoidCalculatingPowersIntoArctans=r.do_simplify_nested_radicals=r.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=r.defs=r.PRINTMODE_LIST=r.PRINTMODE_HUMAN=r.PRINTMODE_COMPUTER=r.PRINTMODE_2DASCII=r.PRINTMODE_LATEX=r.PRINTOUTRESULT=r.DEBUG=r.NSYM=r.version=r.breakpoint=void 0;var n=t(dr()),e=Mt(),E=Ir(),g=Kt();function T(){}r.breakpoint=T,r.version="1.3.1",r.NSYM=1e3,r.DEBUG=!1,r.PRINTOUTRESULT=!1,r.PRINTMODE_LATEX="PRINTMODE_LATEX",r.PRINTMODE_2DASCII="PRINTMODE_2DASCII",r.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER",r.PRINTMODE_HUMAN="PRINTMODE_HUMAN",r.PRINTMODE_LIST="PRINTMODE_LIST";var y=class{constructor(){this.printMode=r.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.tos=0,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.stack=[],this.frame=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};r.defs=new y,r.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0,r.do_simplify_nested_radicals=!0,r.avoidCalculatingPowersIntoArctans=!0;var o=class{toString(){return E.print_expr(this)}toLatexString(){return E.collectLatexStringFromReturnValue(this)}};r.BaseAtom=o;var l=class extends o{constructor(Y,ct){super(),this.k=r.CONS,this.cons={car:Y,cdr:ct}}*[Symbol.iterator](){let Y=this;for(;x(Y);)yield U(Y),Y=v(Y)}tail(){return x(this.cons.cdr)?[...this.cons.cdr]:[]}map(Y){let ct=U(this),yt=v(this);return x(yt)&&(yt=yt.map(Y)),new l(Y(ct),yt)}};r.Cons=l;var d=class extends o{constructor(Y,ct=n.default.one){super(),this.a=Y,this.b=ct,this.q=this,this.k=r.NUM}};r.Num=d;var s=class extends o{constructor(Y){super(),this.d=Y,this.k=r.DOUBLE}};r.Double=s;var i=class extends o{constructor(Y){super(),this.str=Y,this.k=r.STR}};r.Str=i;var a=class extends o{constructor(){super(...arguments),this.tensor=this,this.k=r.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};r.Tensor=a;var p=class extends o{constructor(Y){super(),this.printname=Y,this.k=r.SYM}};r.Sym=p,r.CONS=0,r.NUM=1,r.DOUBLE=2,r.STR=3,r.TENSOR=4,r.SYM=5;var u=0;r.ABS=u++,r.ADD=u++,r.ADJ=u++,r.AND=u++,r.APPROXRATIO=u++,r.ARCCOS=u++,r.ARCCOSH=u++,r.ARCSIN=u++,r.ARCSINH=u++,r.ARCTAN=u++,r.ARCTANH=u++,r.ARG=u++,r.ATOMIZE=u++,r.BESSELJ=u++,r.BESSELY=u++,r.BINDING=u++,r.BINOMIAL=u++,r.CEILING=u++,r.CHECK=u++,r.CHOOSE=u++,r.CIRCEXP=u++,r.CLEAR=u++,r.CLEARALL=u++,r.CLEARPATTERNS=u++,r.CLOCK=u++,r.COEFF=u++,r.COFACTOR=u++,r.CONDENSE=u++,r.CONJ=u++,r.CONTRACT=u++,r.COS=u++,r.COSH=u++,r.DECOMP=u++,r.DEFINT=u++,r.DEGREE=u++,r.DENOMINATOR=u++,r.DERIVATIVE=u++,r.DET=u++,r.DIM=u++,r.DIRAC=u++,r.DIVISORS=u++,r.DO=u++,r.DOT=u++,r.DRAW=u++,r.DSOLVE=u++,r.EIGEN=u++,r.EIGENVAL=u++,r.EIGENVEC=u++,r.ERF=u++,r.ERFC=u++,r.EVAL=u++,r.EXP=u++,r.EXPAND=u++,r.EXPCOS=u++,r.EXPSIN=u++,r.FACTOR=u++,r.FACTORIAL=u++,r.FACTORPOLY=u++,r.FILTER=u++,r.FLOATF=u++,r.FLOOR=u++,r.FOR=u++,r.FUNCTION=u++,r.GAMMA=u++,r.GCD=u++,r.HERMITE=u++,r.HILBERT=u++,r.IMAG=u++,r.INDEX=u++,r.INNER=u++,r.INTEGRAL=u++,r.INV=u++,r.INVG=u++,r.ISINTEGER=u++,r.ISPRIME=u++,r.LAGUERRE=u++,r.LCM=u++,r.LEADING=u++,r.LEGENDRE=u++,r.LOG=u++,r.LOOKUP=u++,r.MOD=u++,r.MULTIPLY=u++,r.NOT=u++,r.NROOTS=u++,r.NUMBER=u++,r.NUMERATOR=u++,r.OPERATOR=u++,r.OR=u++,r.OUTER=u++,r.PATTERN=u++,r.PATTERNSINFO=u++,r.POLAR=u++,r.POWER=u++,r.PRIME=u++,r.PRINT_LEAVE_E_ALONE=u++,r.PRINT_LEAVE_X_ALONE=u++,r.PRINT=u++,r.PRINT2DASCII=u++,r.PRINTFULL=u++,r.PRINTLATEX=u++,r.PRINTLIST=u++,r.PRINTPLAIN=u++,r.PRODUCT=u++,r.QUOTE=u++,r.QUOTIENT=u++,r.RANK=u++,r.RATIONALIZE=u++,r.REAL=u++,r.ROUND=u++,r.YYRECT=u++,r.ROOTS=u++,r.SETQ=u++,r.SGN=u++,r.SILENTPATTERN=u++,r.SIMPLIFY=u++,r.SIN=u++,r.SINH=u++,r.SHAPE=u++,r.SQRT=u++,r.STOP=u++,r.SUBST=u++,r.SUM=u++,r.SYMBOLSINFO=u++,r.TAN=u++,r.TANH=u++,r.TAYLOR=u++,r.TEST=u++,r.TESTEQ=u++,r.TESTGE=u++,r.TESTGT=u++,r.TESTLE=u++,r.TESTLT=u++,r.TRANSPOSE=u++,r.UNIT=u++,r.ZERO=u++,r.NIL=u++,r.LAST=u++,r.LAST_PRINT=u++,r.LAST_2DASCII_PRINT=u++,r.LAST_FULL_PRINT=u++,r.LAST_LATEX_PRINT=u++,r.LAST_LIST_PRINT=u++,r.LAST_PLAIN_PRINT=u++,r.AUTOEXPAND=u++,r.BAKE=u++,r.ASSUME_REAL_VARIABLES=u++,r.TRACE=u++,r.FORCE_FIXED_PRINTOUT=u++,r.MAX_FIXED_PRINTOUT_DIGITS=u++,r.YYE=u++,r.DRAWX=u++,r.METAA=u++,r.METAB=u++,r.METAX=u++,r.SECRETX=u++,r.VERSION=u++,r.PI=u++,r.SYMBOL_A=u++,r.SYMBOL_B=u++,r.SYMBOL_C=u++,r.SYMBOL_D=u++,r.SYMBOL_I=u++,r.SYMBOL_J=u++,r.SYMBOL_N=u++,r.SYMBOL_R=u++,r.SYMBOL_S=u++,r.SYMBOL_T=u++,r.SYMBOL_X=u++,r.SYMBOL_Y=u++,r.SYMBOL_Z=u++,r.SYMBOL_IDENTITY_MATRIX=u++,r.SYMBOL_A_UNDERSCORE=u++,r.SYMBOL_B_UNDERSCORE=u++,r.SYMBOL_X_UNDERSCORE=u++,r.C1=u++,r.C2=u++,r.C3=u++,r.C4=u++,r.C5=u++,r.C6=u++;var _=u++;r.E=r.YYE,r.TOS=1e5,r.MAXPRIMETAB=1e4,r.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5,r.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10,r.MAXDIM=24,r.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],r.parse_time_simplifications=!0,r.primetab=function(){let Y=[2],ct=3;for(;Y.length<r.MAXPRIMETAB;){let yt=0,Ct=Math.sqrt(ct);for(;yt<Y.length&&Y[yt]<=Ct;){if(ct%Y[yt]==0){yt=-1;break}yt++}yt!==-1&&Y.push(ct),ct+=2}return Y[r.MAXPRIMETAB]=0,Y}();var b=!1;r.mtotal=0,r.logbuf="",r.symtab=[],r.binding=[],r.isSymbolReclaimable=[],r.transpose_unicode=7488,r.dotprod_unicode=183;function A(Y){return r.symtab[Y]}r.symbol=A;function x(Y){return Y.k===r.CONS}r.iscons=x;function M(Y){return Y.k===r.NUM}r.isrational=M;function j(Y){return Y.k===r.DOUBLE}r.isdouble=j;function q(Y){return M(Y)||j(Y)}r.isNumericAtom=q;function O(Y){return Y.k===r.STR}r.isstr=O;function C(Y){return Y.k===r.TENSOR}r.istensor=C;function et(Y){if(q(Y)||Y===A(r.SYMBOL_IDENTITY_MATRIX))return!0;if(!C(Y))return!1;let ct=Y.tensor.nelem,yt=Y.tensor.elem;for(let Ct=0;Ct<ct;Ct++)if(!et(yt[Ct]))return!1;return!0}r.isNumericAtomOrTensor=et;function lt(Y){return Y.k===r.SYM}r.issymbol=lt;function H(Y){return lt(Y)&&g.symnum(Y)<r.NIL}r.iskeyword=H;function U(Y){return x(Y)?Y.cons.car:A(r.NIL)}r.car=U;function v(Y){return x(Y)?Y.cons.cdr:A(r.NIL)}r.cdr=v;function S(Y){return U(U(Y))}r.caar=S;function D(Y){return U(v(Y))}r.cadr=D;function Z(Y){return v(U(Y))}r.cdar=Z;function F(Y){return v(v(Y))}r.cddr=F;function Q(Y){return U(U(v(Y)))}r.caadr=Q;function R(Y){return U(v(v(Y)))}r.caddr=R;function h(Y){return U(v(U(Y)))}r.cadar=h;function N(Y){return v(U(v(Y)))}r.cdadr=N;function $(Y){return v(v(U(Y)))}r.cddar=$;function B(Y){return v(v(v(Y)))}r.cdddr=B;function X(Y){return U(U(v(v(Y))))}r.caaddr=X;function J(Y){return U(v(U(v(Y))))}r.cadadr=J;function pt(Y){return U(v(v(U(Y))))}r.caddar=pt;function _t(Y){return v(U(v(v(Y))))}r.cdaddr=_t;function At(Y){return U(v(v(v(Y))))}r.cadddr=At;function ht(Y){return v(v(v(v(Y))))}r.cddddr=ht;function It(Y){return U(v(v(v(v(Y)))))}r.caddddr=It;function Lt(Y){return U(v(U(v(v(Y)))))}r.cadaddr=Lt;function Yt(Y){return v(v(U(v(v(Y)))))}r.cddaddr=Yt;function Bt(Y){return U(v(v(U(v(Y)))))}r.caddadr=Bt;function Zt(Y){return v(v(v(U(v(v(Y))))))}r.cdddaddr=Zt;function ft(Y){return U(v(v(U(v(v(Y))))))}r.caddaddr=ft;function gt(Y){return U(Y)===A(r.ADD)}r.isadd=gt;function Pt(Y){return U(Y)===A(r.MULTIPLY)}r.ismultiply=Pt;function kt(Y){return U(Y)===A(r.POWER)}r.ispower=kt;function rr(Y){return U(Y)===A(r.FACTORIAL)}r.isfactorial=rr;function nt(Y){return U(Y)===A(r.INNER)||U(Y)===A(r.DOT)}r.isinnerordot=nt;function Ot(Y){return U(Y)===A(r.TRANSPOSE)}r.istranspose=Ot;function w(Y){return U(Y)===A(r.INV)}r.isinv=w;function vt(Y){return Y===A(r.SYMBOL_IDENTITY_MATRIX)}r.isidentitymatrix=vt;function P(Y){return Y.isPositive()?1:Y.isZero()?0:-1}r.MSIGN=P;function rt(Y){return Y.isZero()}r.MZERO=rt;function W(Y,ct){return Y==null,Y.equals(ct)}r.MEQUAL=W;function f(){e.moveTos(0),r.defs.esc_flag=!1,b=!1,r.defs.frame=r.TOS,r.defs.evaluatingAsFloats=!1,r.defs.evaluatingPolar=!1}r.reset_after_error=f,r.$={};var L=class{static One(){return r.defs.evaluatingAsFloats?L.oneAsDouble:L.one}static NegOne(){return r.defs.evaluatingAsFloats?L.negOneAsDouble:L.negOne}static Zero(){return r.defs.evaluatingAsFloats?L.zeroAsDouble:L.zero}static Pi(){return r.defs.evaluatingAsFloats?L.piAsDouble:A(r.PI)}};r.Constants=L,L.one=new d(n.default(1)),L.oneAsDouble=new s(1),L.negOne=new d(n.default(-1)),L.negOneAsDouble=new s(-1),L.zero=new d(n.default(0)),L.zeroAsDouble=new s(0),L.piAsDouble=new s(Math.PI);function V(Y,...ct){let yt=r.defs.expanding;r.defs.expanding=!1;try{return Y(...ct)}finally{r.defs.expanding=yt}}r.noexpand=V;function G(Y,...ct){let yt=r.defs.expanding;r.defs.expanding=!0;try{return Y(...ct)}finally{r.defs.expanding=yt}}r.doexpand=G;function st(Y,...ct){let yt=r.defs.evaluatingPolar;r.defs.evaluatingPolar=!0;try{return Y(...ct)}finally{r.defs.evaluatingPolar=yt}}r.evalPolar=st;function tt(Y,...ct){let yt=r.defs.evaluatingAsFloats;r.defs.evaluatingAsFloats=!0;try{return Y(...ct)}finally{r.defs.evaluatingAsFloats=yt}}r.evalFloats=tt}),zs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exec=r.parse=void 0;var t=zt(),n=Mt(),e=Nt(),E=St(),g=Ur(),T=xt(),y=de(),o=Kt();T.defs.inited||(T.defs.inited=!0,y.init());function l(i){typeof i=="string"?g.scan(i):typeof i=="number"?i%1==0?e.push_integer(i):e.push_double(i):i instanceof T.BaseAtom?n.push(i):(console.warn("unknown argument type",i),n.push(T.symbol(T.NIL)))}function d(i){let a;try{l(i),a=n.pop(),t.check_stack()}catch(p){throw T.reset_after_error(),p}return a}r.parse=d;function s(i,...a){let p,u=o.get_binding(o.usr_symbol(i));t.check_stack(),n.push(u);for(let b of Array.from(a))l(b);E.list(1+a.length);let _=n.pop();n.push(_);try{t.top_level_eval(),p=n.pop(),t.check_stack()}catch(b){throw T.reset_after_error(),b}return p}r.exec=s}),Zs=it(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=xt(),n=fr(),e=de(),E=Mt(),g=Kt(),T=zs(),y=wt(),o=Ht(),l=Ur(),d=Ve(),s=fe(),i=zt(),a={};a.version=t.version,a.isadd=t.isadd,a.ismultiply=t.ismultiply,a.ispower=t.ispower,a.isfactorial=t.isfactorial,a.car=t.car,a.cdr=t.cdr,a.caar=t.caar,a.cadr=t.cadr,a.cdar=t.cdar,a.cddr=t.cddr,a.caadr=t.caadr,a.caddr=t.caddr,a.cadar=t.cadar,a.cdadr=t.cdadr,a.cddar=t.cddar,a.cdddr=t.cdddr,a.caaddr=t.caaddr,a.cadadr=t.cadadr,a.caddar=t.caddar,a.cdaddr=t.cdaddr,a.cadddr=t.cadddr,a.cddddr=t.cddddr,a.caddddr=t.caddddr,a.cadaddr=t.cadaddr,a.cddaddr=t.cddaddr,a.caddadr=t.caddadr,a.cdddaddr=t.cdddaddr,a.caddaddr=t.caddaddr,a.symbol=t.symbol,a.iscons=t.iscons,a.isrational=t.isrational,a.isdouble=t.isdouble,a.isNumericAtom=t.isNumericAtom,a.isstr=t.isstr,a.istensor=t.istensor,a.issymbol=t.issymbol,a.iskeyword=t.iskeyword,a.CONS=t.CONS,a.NUM=t.NUM,a.DOUBLE=t.DOUBLE,a.STR=t.STR,a.TENSOR=t.TENSOR,a.SYM=t.SYM,a.approxRadicals=d.approxRadicals,a.approxRationalsOfLogs=d.approxRationalsOfLogs,a.approxAll=d.approxAll,a.testApprox=d.testApprox,a.make_hashed_itab=s.make_hashed_itab,a.isZeroAtomOrTensor=y.isZeroAtomOrTensor,a.isnegativenumber=y.isnegativenumber,a.isplusone=y.isplusone,a.isminusone=y.isminusone,a.isinteger=y.isinteger,a.isnonnegativeinteger=y.isnonnegativeinteger,a.isposint=y.isposint,a.isnegativeterm=y.isnegativeterm,a.isimaginarynumber=y.isimaginarynumber,a.iscomplexnumber=y.iscomplexnumber,a.iseveninteger=y.iseveninteger,a.isnegative=y.isnegative,a.issymbolic=y.issymbolic,a.isintegerfactor=y.isintegerfactor,a.isoneover=y.isoneover,a.isfraction=y.isfraction,a.isoneoversqrttwo=y.isoneoversqrttwo,a.isminusoneoversqrttwo=y.isminusoneoversqrttwo,a.isfloating=y.isfloating,a.isimaginaryunit=y.isimaginaryunit,a.isquarterturn=y.isquarterturn,a.isnpi=y.isnpi,a.equal=o.equal,a.length=o.length,a.scan=l.scan,a.Find=n.Find,a.dupl=E.dupl,a.swap=E.swap,a.restore=E.restore,a.save=E.save,a.push=E.push,a.pop=E.pop,a.get_binding=g.get_binding,a.set_binding=g.set_binding,a.usr_symbol=g.usr_symbol,a.collectUserSymbols=g.collectUserSymbols,a.init=e.init,a.exec=T.exec,a.parse=T.parse,a.run=i.run;var p=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(p).map(u=>a[u]=T.exec.bind(r,u)),r.default=a}),Hs=cr(Zs());globalThis.Algebrite=Hs.default})()});var On=hr((Li,An)=>{function En(ot,K,ut="second"){let dt=(()=>{let mt;switch(ut){case"minute":mt=6e4;break;case"hour":mt=36e5;break;case"day":mt=864e5;break;case"second":default:mt=1e3}return Math.round(mt/K)})();Object.defineProperty(En,ot,{get:function mt(){let Et=Date.now(),it=Et-(mt.last||0)>=dt;return it&&(mt.last=Et),it}})}An.exports=En});var Ne=hr((Si,Tn)=>{function Mn(ot="",K={}){if(ot instanceof Object){let ut=Array.isArray(ot)?[]:{};for(let dt in ot){let mt=Mn(ot[dt],K);try{ut[dt]=JSON.parse(mt)}catch{mt!==void 0&&mt!==""&&(ut[dt]=mt)}}return ut}return typeof ot!="string"?ot:ot.replace(/\{\{(.+?)\}\}/g,function(ut,dt){let mt=K[dt]||"";return mt instanceof Object?JSON.stringify(mt):mt})}Tn.exports=Mn});var In=hr((Ri,Nn)=>{var Ho=Ne(),Ie;typeof window>"u"?Ie=(Or(),gr(Ar)):Ie=(Or(),gr(Ar)).default;var pe=new Ie("processPayload.js");function Vo(ot,K){let ut=Ho(ot,K),dt=ut.headers?.["Content-Type"]||ut.headers?.["content-type"];pe.debug(`contentType: ${dt}`),pe.debug(`body: ${JSON.stringify(ut.body)}`);let mt;switch(dt){case"application/json":mt=JSON.stringify(ut.body);break;case"application/x-www-form-urlencoded":typeof ut.body=="string"?mt=ut.body:mt=Object.entries(ut.body).map(([Et,Rt])=>`${Et}=${Rt}`).join("&");break;case"multipart/form-data":pe.warn("multipart/form-data not implemented");break;default:mt=JSON.stringify(ut.body)}return pe.debug(`payload: ${mt}`),mt}Nn.exports=Vo});var be={};bn(be,{APIClient:()=>Jo});function re(ot){if(!new.target)return new re(...arguments);if(re.instance!==void 0)return re.instance;function K(dt,mt){try{let Et=new XMLHttpRequest,Rt=mt.timeout||dt.timeout||0;return Et.open(dt.method,Hr(dt.url,mt)),Object.entries(dt.headers||{}).forEach(([it,Wt])=>{Et.setRequestHeader(it,Hr(Wt,mt))}),Et.onload=function(){mt.success(Et.response)},Et.onerror=function(it){mt.failure(it)},Rt>0&&(Et.timeout=Rt,Et.ontimeout=function(it){yr.debug("timeout: ",Rt),mt.failure(it)}),dt.body!==void 0&&(Et.body=Hr(dt.body,mt)),Et}catch(Et){yr.error(Et),mt.failure(Et)}}let ut={get:function(dt,mt){yr.debug("get call"),K(dt,mt).send()},post:function(dt,mt){yr.debug("post call"),yr.debug(`entry: ${JSON.stringify(dt,null,2)}`);let Et=K(dt,mt),Rt=me(dt,mt);Et.send(Rt)},put:function(dt,mt){yr.debug("put call");let Et=K(dt,mt),Rt=me(dt,mt);Et.send(Rt)},delete:function(dt,mt){yr.debug("delete call"),K(dt,mt).send()},fetch:async function(dt,mt){yr.debug("fetch call");try{let Et=await fetch(Hr(dt.url,mt),{method:dt.fetchMethod,headers:Object.entries(dt.headers||{}).reduce((Rt,[it,Wt])=>(Rt[it]=Wt,Rt),{}),body:me(dt,mt)});mt.success(Et)}catch(Et){yr.error(Et),mt.failure(Et)}},custom:function(dt,mt){yr.debug("custom call");let Et=mt.timeout||dt.timeout||0,Rt=new XMLHttpRequest;Rt.open(dt.customMethod,Hr(dt.url,mt),Et>0),Object.entries(dt.headers||{}).forEach(([Wt,cr])=>{Rt.setRequestHeader(Wt,Hr(cr,mt))}),Rt.onload=function(){mt.success(Rt.response)},Rt.onerror=function(Wt){mt.failure(Wt)},Et>0&&(Rt.timeout=Et,Rt.ontimeout=function(Wt){yr.debug("timeout: ",Et),mt.failure(Wt)});let it=me(dt,mt);Rt.send(it)}};Object.keys(ot).forEach(dt=>{let mt=ot[dt];mt.rate&&Ln(dt,mt.rate,mt.period),Object.defineProperty(this,dt,{enumerable:!0,value:function(Et){return new Promise((Rt,it)=>{if(Et.success===void 0?(Et.success=Wt=>{Rt(Wt)},Et.failure=Wt=>{it(Wt)}):Rt("Using provided callback"),Ln[dt]===!1){let Wt=`Call to ${dt} throttled`;yr.debug(Wt),Et.failure(Wt);return}yr.debug(`Call to ${dt} not throttled`),ut[mt.method].call(this,mt,Et)})}})}),Object.defineProperty(re,"instance",{value:this})}var Wo,Ln,Hr,me,yr,Jo,ge=mn(()=>{({default:Wo}=(Or(),gr(Ar))),Ln=On(),Hr=Ne(),me=In(),yr=new Wo("APIClient.js");Jo=re});var Cn=hr((Ci,Rn)=>{var Le;typeof window>"u"?Le=(Or(),gr(Ar)):Le=(Or(),gr(Ar)).default;var Ko=new Le("getopt.js"),Sn=function(ot){Ko.warn(ot)};function Dt(ot,K){typeof Dt.place>"u"&&(Dt.place="",Dt.iplace=0);let ut;if(Dt.optreset>0||Dt.iplace===Dt.place.length){if(Dt.optreset=0,Dt.place=ot[Dt.optind],Dt.iplace=0,Dt.optind>=ot.length||Dt.place.charAt(Dt.iplace++)!=="-")return Dt.place="",Dt.iplace=0,"";if(Dt.optopt=Dt.place.charAt(Dt.iplace++),Dt.optopt==="-"&&Dt.iplace===Dt.place.length)return++Dt.optind,Dt.getopt.place="",Dt.getopt.iplace=0,"";if(Dt.optopt===0){if(Dt.place="",Dt.iplace=0,K.indexOf("-")===-1)return"";Dt.optopt="-"}}else Dt.optopt=Dt.place.charAt(Dt.iplace++);if(Dt.optopt===":"||(ut=K.indexOf(Dt.optopt))===-1)return Dt.iplace===Dt.place.length&&++Dt.optind,Dt.opterr&&K.charAt(0)!==":"&&Sn("illegal option -- "+Dt.optopt),"?";if(K.charAt(ut+1)!==":")Dt.optarg=null,Dt.iplace===Dt.place.length&&++Dt.optind;else{if(Dt.iplace<Dt.place.length)Dt.optarg=Dt.place.substr(Dt.iplace);else if(ot.length>++Dt.optind)Dt.optarg=ot[Dt.optind];else return Dt.place="",Dt.iplace=0,K.charAt(0)===":"?":":Dt.opterr?(Sn("option requires an argument -- "+Dt.optopt),":"):"?";Dt.place="",Dt.iplace=0,++Dt.optind}return Dt.optopt}Dt.opterr=1;Dt.optind=0;Dt.optopt="";Dt.optreset=0;Dt.optarg="";Rn.exports=Dt});var wn=hr((qi,qn)=>{var Mr=Cn();function vr(ot,K,ut){if(typeof K=="function")return function(){return K.apply(this,arguments)||vr.OK};let dt=this;dt.echo===void 0&&(dt.echo=ot.info);let mt=[],Et=/"([^"]*)"|'([^']*)'|\S+/g,Rt=async function(it){ot.info(`Executing: ${it}`);let Wt=it.match(Et).map(St=>St.replace(/^['"]|['"]$/g,"")),cr=Wt.shift(),dr=K[cr];if(dr===void 0){if(mt.includes(cr))try{let St=JSON.stringify(await ut(it));return ot.debug(`RPC Response: ${St}`),dt.echo(St),vr.OK}catch(St){return dt.echo(St),vr.ECMDERR}return dt.echo(`${cr}: no such command`),vr.ENOTFOUND}let{func:Cr,opts:Vr,usage:$r}=dr,Kt=Vr;if($r&&(Kt=Kt?`${Kt}h`:"h"),Kt!==void 0){ot.debug(`Parsing options: ${Kt} with ${Wt}`);let St={},pr;for(Mr.optreset=1,Mr.optind=0;(pr=Mr(Wt,Kt))!=="";)switch(ot.debug(`Opt: ${pr}, optarg: ${Mr.optarg}, optind: ${Mr.optind}`),pr){case"h":return dt.echo(`Usage: ${$r}`),vr.OK;case":":return dt.echo(`${Mr.optopt}: option needs a value`),vr.EBADARGS;case"?":return dt.echo(`${Mr.optopt}: no such option`),vr.EBADARGS;default:ot.debug(`Switch: ${pr}, optarg: ${Mr.optarg}`),St[pr]=Mr.optarg||!0}Cr.opts=St,ot.debug(`Switches: ${JSON.stringify(St)}`)}else Mr.optind=0;return ot.debug(`Terms: ${Wt}`),await Cr.apply(this,Wt.slice(Mr.optind))??vr.OK};return ut!==void 0&&queueMicrotask(async function(){let it=await ut("system.describe");ot.debug(`system.describe result: ${it}`),JSON.parse(it).procs.forEach(Wt=>mt.push(Wt)),K.help.rpcList=mt,ot.debug(`RPC List: ${mt}`),Object.defineProperties(Rt,{login:{value:async function(Wt,cr){ot.info(`Attempting to log in user ${Wt}`);try{let dr=await ut(`login ${Wt} ${cr}`);if(dr===!1)return dt.echo("Login failed"),vr.NOTOKEN;let Cr=ut;return Rt.exit??Object.defineProperty(Rt,"exit",{value:async function(){ot.info("Logging out"),ut=Cr,dt.authState=vr.NOTOKEN,dt.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}}),ut=new Proxy(ut,{apply:function(Vr,$r,Kt){return Vr(Kt[0],dr)}}),vr.OK}catch(dr){return ot.error(dr),dr}}}})}),Rt}var ee=0;Object.defineProperties(vr,{OK:{value:ee++},ENOTFOUND:{value:ee++},ECMDERR:{value:ee++},EBADARGS:{value:ee++},NOTOKEN:{value:ee++}});function Qo(ot,K){let ut=0;return function(dt,mt){try{ot.info(`Executing RPC: ${dt}`);let Et=dt.trim().split(/\s+/),Rt=Et.shift(),it=Et;mt&&(it={token:mt,params:it}),ot.debug(`Method: ${Rt}, params: ${it}`);try{return K.jsonrpc({id:ut++,method:Rt,params:it}).then(Wt=>{let cr=JSON.parse(Wt);if(ot.debug(`Response: ${JSON.stringify(cr)}`),cr.error)throw new Error(cr.error.message);return cr.result})}catch(Wt){return ot.error(Wt),Wt}}catch(Et){return ot.error(Et),Et}}}qn.exports={JSONRPCClient:Qo,Executor:vr}});var $n=hr((wi,Dn)=>{var Se;typeof window>"u"?Se=(Or(),gr(Ar)):Se=(Or(),gr(Ar)).default;var Re=new Se("BigIntMath.js");function ar(ot){if(ar[ot]!==void 0)return Re.debug(`returning ${ot}`),ar[ot];Re.debug(`creating ${ot}`);let K=BigInt(ot);return Object.defineProperty(ar,ot,{get:function(){return K}}),K}[0,1,2,3,8,20,128].forEach(ar);var ti=ar[2]**(ar[2]**ar[20]-ar[1]),Pn=ar;Object.defineProperties(Pn,{abs:{value:ot=>ot<ar[0]?-ot:ot},max:{value:(ot,...K)=>K.reduce((ut,dt)=>dt>ut?dt:ut,ot)},min:{value:(ot,...K)=>K.reduce((ut,dt)=>dt<ut?dt:ut,ot)},pow:{value:(ot,K,ut=ti)=>{let dt=ar[1];for(;K>ar[0];)K%ar[2]===ar[1]&&(dt=dt*ot%ut),ot=ot*ot%ut,K=K/ar[2];return dt}},random:{value:(ot,K)=>BigInt(Math.floor(Math.random()*Number(K-ot+ar[1])))+ot},random_bytes:{value:(ot,K)=>{ot instanceof BigInt||(ot=BigInt(ot)),K instanceof BigInt||(K=BigInt(K));let ut=K-ot,dt=Math.ceil(ut.toString(2).length/8),mt=(ar[1]<<ar(dt)*ar[8])-ar[1],Et=ar[0];for(let Rt=0;Rt<dt;++Rt){let it=Math.floor(Math.random()*256);Et=Et<<ar[8]|BigInt(it),Re.debug(`acc: ${Et}, generated byte ${it}`)}return Et=Et*ut/mt,Et+ot}}});Dn.exports=Pn});var jn=hr((Pi,Fn)=>{Number.THIRTY_TWO_BIT_MAX=2**31-1;function Un(ot,K){return Math.floor(Math.random()*(K-ot+1))+ot}function ri(ot,K){let ut,[dt,mt]=[0,1],[Et,Rt]=[1,0];for(;K;)ut=Math.floor(ot/K),[ot,K]=[K,ot-ut*K],[dt,mt]=[mt-ut*dt,dt],[Et,Rt]=[Rt-ut*Et,Et];let it;return ot<0?it=[-ot,-mt,Rt]:it=[ot,ot?mt:0,Rt],it}function Bn(ot,K){return ri(ot,K)[0]}function Ce(ot,K,ut){if(ut===1)return 0;let dt=1;for(ot=ot%ut;K>0;)K%2===1&&(dt=dt*ot%ut),K=K>>1,ot=ot*ot%ut;return dt}function qe(ot){return ot<=1?!1:ot<=3?!0:ot%2===0||ot%3===0?!1:ei(ot,20)}function ei(ot,K){if(ot<=1||ot%2===0)return!1;let ut=0,dt=ot-1;for(;dt%2===0;)ut++,dt/=2;for(let mt=0;mt<K;mt++){let Et=Un(2,ot-2),Rt=Ce(Et,dt,ot);if(!(Rt===1||Rt===ot-1)){for(let it=0;it<ut-1&&(Rt=Ce(Rt,2,ot),Rt!==ot-1);it++);if(Rt!==ot-1)return!1}}return!0}function ni(ot,K){let ut=[],dt=Math.sqrt(K);for(let Et=0;Et<=K;Et++)ut[Et]=!1;K>=2&&(ut[2]=!0),K>=3&&(ut[3]=!0),console.log("starting sieve of atkin");for(let Et=1;Et<=dt;Et++)for(let Rt=1;Rt<=dt;Rt++){let it=4*Et*Et+Rt*Rt;it<=K&&(it%12==1||it%12==5)&&(ut[it]=!ut[it]),it=3*Et*Et+Rt*Rt,it<=K&&it%12==7&&(ut[it]=!ut[it]),it=3*Et*Et-Rt*Rt,Et>=Rt&&it<=K&&it%12==11&&(ut[it]=!ut[it])}for(let Et=5;Et<=dt;Et++)if(ut[Et]){let Rt=Et*Et;for(let it=Rt;it<=K;it+=Rt)ut[it]=!1}let mt=[];for(let Et=Math.max(2,ot)-1;Et<=K;Et++)ut[Et]&&mt.push(Et);return mt}function Gn(ot){let K=Math.ceil(Math.sqrt(ot)),ut=ni(2,K),dt=ot;for(let mt of ut)if(ot%mt===0)for(dt=dt*(mt-1)/mt;ot%mt===0;)ot/=mt;return ot>1&&(dt=dt*(ot-1)/ot),dt}function kn(ot,K){if(Bn(ot,K)!==1)return!1;let ut=Gn(K),dt=new Set;for(let mt=0;mt<K;mt++)dt.add(Ce(ot,mt,K));return ut===dt.size}function si(ot,K){if(K>Number.THIRTY_TWO_BIT_MAX)throw new Error("max must be 32-bit integer");if(K&K-1!==0)throw new Error("max must be power of two");let ut=Gn(K);console.log("seed:",ot,"max:",K);let dt=ot|1;for(;dt<K;){for(;!qe(dt);)dt+=2;for(;!kn(dt,K);)dt+=2,console.log("candidate a:",dt)}if(!qe(dt)||!kn(dt,K))throw new Error("could not find suitable a value");return console.log("c:",c),[dt,c,m]}function we(ot,K,ut,dt,mt){return Object.defineProperty(we,ot,{value:function(){return mt=(K*mt+ut)%dt,mt}}),we[ot]}Fn.exports={gcd:Bn,generateLCGParams:si,isPrime:qe,lcg:we,range:Un}});var Hn=hr((Di,Zn)=>{var Yn=$n(),{generateLCGParams:oi,lcg:Pe,range:Xn}=jn();function zn(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}function se(ot,K,ut){Object.defineProperty(se,ot,{value:function(){let dt,mt;do dt=Math.random(),mt=Math.random();while(dt===0);let Et=Math.sqrt(-2*Math.log(dt))*Math.cos(2*Math.PI*mt);return parseFloat((K+ut*Et).toFixed(2))}})}function ne(){if(!new.target)return new ne(...arguments);if(ne.instance!==void 0)return ne.instance;Object.defineProperty(ne,"instance",{value:this}),se("random",50,15),Object.defineProperties(this,{biRandom:{value:function(ot,K){return K<Number.MAX_SAFE_INTEGER?Yn.random(ot,K):Yn.random_bytes(ot,K)}},integer:{value:zn},gaussian:{value:se},lcg:{value:Pe},range:{value:Xn}})}Zn.exports={integer:zn,gaussian:se,generateLCGParams:oi,lcg:Pe,normal:se.random,range:Xn,seeded:Pe.random,PRNG:ne()}});var Vn=hr((exports,module)=>{var{APIClient}=(ge(),gr(be)),Logger=(Or(),gr(Ar)).default,{gaussian,PRNG}=Hn(),client=new APIClient,logger=new Logger("commandRegistry.js"),registry=Object.freeze({anagram:{func:async function(ot){try{let K=await client.anagram({word:ot});this.echo(K)}catch(K){let ut=JSON.stringify(K);logger.error(ut),this.echo(ut)}},usage:"anagram [word]"},cas:{func:function(){this.startSubTerminal({name:"cas",greeting:"Algebrite Computer Algebra System",prompt:"cas>",registry:function(K){if(K==="exit"){this.echo("exiting"),this.exitSubTerminal();return}this.echo(Algebrite.run(K))}})}},clear:{func:function(){this.clear()}},date:{func:function ot(K,ut){logger.debug(`Date called with ${K}`);let dt=ot.opts.m,mt;isNaN(K)?(logger.debug("Date is not a number"),mt=new Date(K)):(logger.debug("Date is a number"),mt=new Date(Number(K))),isNaN(mt.getTime())&&(logger.debug("Date is invalid"),mt=Date()),dt?mt=mt.getTime():ut&&(mt=mt.toLocaleDateString("en-US",ut)),this.echo(mt)},opts:"m",usage:"date [-m] [date-like] [format]"},dm42:{func:function(){this.echo("Start DM42 editor")}},endec:{func:function ot(K,ut){let dt=ot.opts.d,mt=this.echo.bind(this);switch(K){case"base64":dt?(logger.debug(`Decoding: ${ut}`),mt(atob(ut))):mt(btoa(ut));break;case"binary":mt(dt?ut.split(" ").map(function(Et){return String.fromCharCode(parseInt(Et,2))}).join(""):ut.split("").map(function(Et){return Et.charCodeAt(0).toString(2)}).join(" "));break;case"hex":mt(dt?ut.split(" ").map(function(Et){return String.fromCharCode(parseInt(Et,16))}).join(""):ut.split("").map(function(Et){return Et.charCodeAt(0).toString(16)}).join(" "));break;case"rot13":dt?ut=ut.replace(/[a-zA-Z]/g,function(Et){mt(String.fromCharCode(Et.charCodeAt(0)+(Et.toLowerCase()<="m"?13:-13)))}):ut=ut.replace(/[a-zA-Z]/g,function(Et){mt(String.fromCharCode(Et.charCodeAt(0)+(Et.toLowerCase()>="n"?13:-13)))});break;case"url":mt(dt?decodeURI(ut):encodeURI(ut));break;default:mt("Unknown schema");break}},opts:"d",usage:"endec [-d] [base64|binary|hex|rot13|url] [text]"},exit:{func:function(){this.executor.exit?.()}},help:{func:function(ot){logger.debug(`Help called on ${ot}`);let K=Object.keys(registry).concat(registry.help.rpcList).sort();ot===void 0?this.echo(`Available commands:
${K.join(`
`)}`):K.includes(ot)?window.location.href=`https://letmegooglethat.com/?q=${ot}`:this.echo(`No help available for ${ot}`)},usage:"help [command]"},history:{func:function(){this.echo(this.commandHistory.join("<br />"))}},ip:{func:async function(ot){try{let K=await client.ipinfo({ip:ot});this.echo(K)}catch(K){let ut=JSON.stringify(K);logger.error(ut),this.echo(ut)}},usage:"ip [ip]"},js:{func:function(){this.startSubTerminal("js",function executor(input){if(input==="exit"){this.echo("exiting"),this.exitSubTerminal();return}try{this.echo(eval(input))}catch(ot){this.echo(ot)}})}},loglevel:{func:function(ot){ot&&Logger.setLogLevel(ot),this.echo(Logger.level)},usage:"loglevel [level]"},lookup:{func:function ot(K){let ut=ot.opts.t;if(ut)switch(ut){case"unicode":this.echo("Unicode table");break;case"ascii":{let Et=Math.floor(6.153846153846154),Rt=[],it=[];for(let Wt=32;Wt<127;Wt++){let cr=`ASCII ${Wt} = ${String.fromCharCode(Wt)}`;it.push(cr),it.length>=Et&&(Rt.push(it.join("	")),it=[])}it.length>0&&Rt.push(it.join("	")),this.echo(Rt.join("<br />"));break}case"html":this.echo("HTML entities");break;case"emoji":this.echo("Emoji table");break;default:this.echo(`Unknown schema ${ut}`);break}else if(K){let dt=/^&([a-z0-9]+|#[0-9]+|#x[0-9a-f]+);$/i,mt;if(dt.test(K)){let Et=document.createElement("textarea");Et.textContent=K,mt=Et.innerHTML}else mt=String.fromCodePoint(K);this.echo(mt)}},opts:"t:",usage:"lookup [-t schema]|[symbol]"},passgen:{func:async function(){try{let ot=await client.passgen({});this.echo(ot)}catch(ot){let K=JSON.stringify(ot);logger.error(K),this.echo(K)}}},prng:{func:async function(ot){switch(ot){case"nist":{try{let K=await client.nistprng({});this.echo(JSON.parse(K).pulse.localRandomValue)}catch(K){let ut=JSON.stringify(K);logger.error(ut),this.echo(ut)}break}case"integer":this.echo(PRNG.integer());break;case"normal":this.echo(gaussian.random());break;default:this.echo("Unknown PRNG");break}}},qotd:{func:async function(){try{let ot=await client.qotd({});this.echo(ot)}catch(ot){let K=JSON.stringify(ot);logger.error(K),this.echo(K)}}},time:{func:function ot(){if(ot.opts.m)this.echo(Date.now());else{let ut=function(mt){return mt<10?"0"+mt:mt};var K=ut;let dt=new Date;this.echo(`${ut(dt.getHours())}:${ut(dt.getMinutes())}:${ut(dt.getSeconds())}`)}},opts:"m",usage:"time [-m]"},weather:{func:async function(ot){try{let K=await client.weather({location:ot});this.echo(K)}catch(K){let ut=JSON.stringify(K);logger.error(ut),this.echo(ut)}},usage:"weather [location]"}});module.exports=registry});var Wn=hr(()=>{var{APIClient:ii}=(ge(),gr(be)),{JSONRPCClient:ai,Executor:Dr}=wn(),ye=(Or(),gr(Ar)).default,li=Vn(),nr=new ye("Terminal.js"),ui=100,ci=1e3,De=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.parentTerminal=null,this.commandHistory=[],this.historyIndex=-1;let K=localStorage.getItem("commandHistory");K&&(this.commandHistory=JSON.parse(K),nr.debug(`Loading command history (${this.commandHistory.length} items)`),this.historyIndex=this.commandHistory.length),this.inputHandler=this.inputHandler.bind(this),this.reset=this.reset.bind(this),this.addEventListener("terminal-reset",this.reset)}connectedCallback(){nr.debug("Terminal connected"),document.addEventListener("DOMContentLoaded",async()=>{nr.debug("DOMContentLoaded event fired"),this.executor??=(()=>{nr.debug("Creating executor");let K=new ye("Executor.js"),ut;if(this.rpcEnabled){nr.debug("RPC enabled");let dt=new ye("Executor.js (JSONRPCClient)");ut=ai(dt,new ii)}return Dr.bind(this)(K,li,ut)})(),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))})}disconnectedCallback(){nr.debug("Terminal disconnected"),this.inputLine.removeEventListener("keydown",this.inputHandler),this.removeEventListener("click",this.focusHandler)}reset(K){if(nr.debug(`Terminal reset (${this.parentTerminal?"sub-terminal":"main terminal"})`),nr.debug(`Auth state: ${this.authState}, RPC enabled: ${this.rpcEnabled}`),this.rpcEnabled&&this.authState!==Dr.OK)nr.debug("logging in"),this.loginModal();else{let ut=K.detail?.clear??!1;nr.debug(`reset ${ut?"and clear ":""}terminal`),this.uiModal(ut)}this.focusHandler=function(){this.inputLine.focus()}.bind(this),this.addEventListener("click",this.focusHandler),this.focusHandler()}applyStyles(){let K=this.querySelector("style").cloneNode(!0);this.shadowRoot.appendChild(K)}loginModal(){this.shadowRoot.innerHTML="",this.applyStyles();let K=this.querySelector("template#login").content.cloneNode(!0);this.shadowRoot.appendChild(K),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),this.echo("Please log in");let ut,dt,mt=async Et=>{if(Et.key==="Enter"){Et.preventDefault();let Rt=(this.inputLine.value??this.inputLine.textContent).trim();if(ut===void 0?ut=Rt:dt=Rt,ut&&dt)try{if(this.authState=await this.executor.login(ut,dt),nr.debug(`Login state: ${this.authState}`),this.authState===Dr.NOTOKEN){this.loginModal(),this.focusHandler();return}this.inputLine.removeEventListener("keydown",mt),this.removeEventListener("click",this.focusHandler),this.reset(new CustomEvent("terminal-reset",{detail:{clear:!0}}))}catch(it){this.echo(it),nr.error(it)}else{nr.debug(`awaiting password for ${ut}`);let it=document.createElement("input");it.type="password",it.classList.add("input-line"),this.inputLine.textContent=this.inputLine.value="",this.inputLine.removeEventListener("keydown",mt),this.removeEventListener("click",this.focusHandler),this.inputLine.replaceWith(it),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.prompt="password:",this.inputLine.addEventListener("keydown",mt),this.addEventListener("click",this.focusHandler),this.focusHandler()}}};this.inputLine.addEventListener("keydown",mt)}uiModal(K){let ut=this.shadowRoot.querySelector(".output")?.innerHTML;this.shadowRoot.innerHTML="",this.applyStyles();let dt=this.querySelector("template#ui").content.cloneNode(!0);this.shadowRoot.appendChild(dt),this.inputLine=this.shadowRoot.querySelector(".input-line"),this.output=this.shadowRoot.querySelector(".output"),K&&this.greeting?(nr.debug("clearing terminal"),this.echo(this.greeting)):this.output.innerHTML=ut??"",this.inputLine.addEventListener("keydown",this.inputHandler),this.inputLine.focus()}get greeting(){return this.getAttribute("greeting")}set greeting(K){K===void 0?this.removeAttribute("greeting"):this.setAttribute("greeting",K)}get prompt(){return this.shadowRoot.querySelector(".prompt").textContent}set prompt(K){let ut=this.shadowRoot.querySelector(".prompt");ut.innerHTML=`${K}&nbsp;`}get rpcEnabled(){return this.getAttribute("rpc")==="true"}inputHandler(K){switch(K.key){case"Enter":{K.preventDefault();let ut=this.inputLine.textContent.trim();this.inputLine.textContent="",this.echo(`${this.prompt}${ut}`),this.processCommand(ut);break}case"ArrowUp":nr.debug(`History index (back): ${this.historyIndex}`),this.historyIndex>0&&(this.historyIndex-=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]);break;case"ArrowDown":nr.debug(`History index (forward): ${this.historyIndex}`),this.historyIndex<this.commandHistory.length-1?(this.historyIndex+=1,this.inputLine.textContent=this.commandHistory[this.historyIndex]):(this.historyIndex=this.commandHistory.length,this.inputLine.textContent="");break}}async processCommand(K){try{let ut=await this.executor(K);switch(nr.debug(`Status: ${ut}`),ut){case Dr.OK:nr.debug(`${K} executed successfully`),K!==this.commandHistory[this.commandHistory.length-1]&&(this.commandHistory.push(K),this.commandHistory.length>ui&&this.commandHistory.shift(),localStorage.setItem("commandHistory",JSON.stringify(this.commandHistory)),this.historyIndex=this.commandHistory.length);break;case Dr.ENOTFOUND:nr.info(`${K} not found`);break;case Dr.ECMDERR:nr.error(`Error executing ${K}`);break;case Dr.EBADARGS:nr.warn(`${K} called with bad arguments`);break;default:nr.error(`Unknown status: ${ut} for ${K}`);break}}catch(ut){nr.error(ut),this.echo(ut)}}clear(){this.output.innerHTML=""}echo(K){for(K!=null&&K!==""&&(this.output.innerHTML+=`<div>${K}</div>`);this.output.children.length>ci;)this.output.removeChild(this.output.firstChild);this.inputLine.getBoundingClientRect().bottom>window.innerHeight&&this.inputLine.scrollIntoView({behavior:"smooth"})}startSubTerminal(K){nr.info(`Starting sub-terminal: ${K.name}`),this.removeEventListener("terminal-reset",this.reset);let ut=new ye(`Executor.js (${K.name})`),dt=document.createElement("ng-terminal");return dt.innerHTML=this.innerHTML,dt.greeting=K.greeting,dt.executor=Dr.bind(dt)(ut,K.registry),dt.parentTerminal=this,this.replaceWith(dt),dt.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!0}})),K.prompt!==void 0&&(dt.prompt=K.prompt),dt}exitSubTerminal(){this.parentTerminal?(nr.info("Exiting sub-terminal"),nr.debug(`Parent terminal: ${JSON.stringify(this.parentTerminal)}`),this.parentTerminal.addEventListener("terminal-reset",this.parentTerminal.reset),this.replaceWith(this.parentTerminal),this.parentTerminal.dispatchEvent(new CustomEvent("terminal-reset",{detail:{clear:!1}}))):nr.warn("No parent terminal found")}};customElements.define("ng-terminal",De)});var di=(Or(),gr(Ar)).default,fi=xn();_n();(ge(),gr(be)).APIClient(fi);Wn();di.setLogLevel("debug");})();
